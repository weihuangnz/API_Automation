<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="58de47f6-12b3-4ca5-b85c-9fdb784560c2" created="2.3.0" activeEnvironment="Default environment" name="OAG API" resourceRoot="${projectDir}" updated="2.4.0 2018-06-08T12:50:23Z" encryptionMode="Not encrypted" xmlns:con="http://eviware.com/soapui/config">
  <con:settings/>
  <con:interface xsi:type="con:RestService" id="a22a2a66-91ea-4a2e-a566-7777e1c469a1" wadlVersion="http://wadl.dev.java.net/2009/02" name="REST Service 1" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints/>
    <con:environmentSpec>
      <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="IAM Tokens" path="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" id="26823dbc-b7a3-42b2-9f8b-cef43ba5a98a">
      <con:settings/>
      <con:parameters/>
      <con:method name="RequestToken" id="fba658b0-b8e4-44c5-a400-3f925b3fda53" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:representation type="REQUEST">
          <con:mediaType>application/x-www-form-urlencoded</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json</con:mediaType>
          <con:status>400 500 401 403</con:status>
          <con:params/>
          <con:element xmlns:tok="https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens">tok:Fault</con:element>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>x-www-form-urlencoded</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html; charset=UTF-8</con:mediaType>
          <con:status>500</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:tok="https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens">tok:Response</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html</con:mediaType>
          <con:status>503 403</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>text/html</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html; charset=utf-8</con:mediaType>
          <con:status>502 407</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:request name="DEV" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
          <con:request>grant_type=client_credentials&amp;scope=SOV.Adviser.ValidateEmail</con:request>
          <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
          <con:credentials>
            <con:username>4101cbfced9049038f8a8f70e08afdbb</con:username>
            <con:password>2C449kwEGO</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:preemptive>true</con:preemptive>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Preemptive</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:parameterOrder/>
          <con:environmentSpec>
            <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
            <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
              <con:authProfile>Basic</con:authProfile>
              <con:username>4101cbfced9049038f8a8f70e08afdbb</con:username>
              <con:password>2C449kwEGO</con:password>
              <con:preemptive>true</con:preemptive>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:request name="FST" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
          <con:request>grant_type=client_credentials&amp;scope=SOV.Adviser.ValidateEmail</con:request>
          <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
          <con:credentials>
            <con:username>d38e418cf90e410ca4448a6d1a650710</con:username>
            <con:password>XbDmLnEFDk</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:preemptive>true</con:preemptive>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Preemptive</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:parameterOrder/>
          <con:environmentSpec>
            <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
            <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
              <con:authProfile>Basic</con:authProfile>
              <con:username>d38e418cf90e410ca4448a6d1a650710</con:username>
              <con:password>XbDmLnEFDk</con:password>
              <con:preemptive>true</con:preemptive>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:request name="QA" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
          <con:request>grant_type=client_credentials&amp;scope=SOV.Adviser.ValidateEmail</con:request>
          <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
          <con:credentials>
            <con:username>d8e3649f9e3d4ed1b8adb540e9f8c913</con:username>
            <con:password>XPJNTyxIwuACGO</con:password>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:preemptive>true</con:preemptive>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:authType>Preemptive</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:parameterOrder/>
          <con:environmentSpec>
            <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
            <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
              <con:authProfile>Basic</con:authProfile>
              <con:username>d8e3649f9e3d4ed1b8adb540e9f8c913</con:username>
              <con:password>XPJNTyxIwuACGO</con:password>
              <con:preemptive>true</con:preemptive>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="69113b50-26af-4c32-9a54-9d0f82e48e07" wadlVersion="http://wadl.dev.java.net/2009/02" name="REST Service API" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints>
      <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
      <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
      <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
      <con:endpoint>https://api.sovcloud.sovereign.co.nz</con:endpoint>
    </con:endpoints>
    <con:environmentSpec>
      <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="Endpoints" path="/quote" id="676fa4c2-8904-471d-8972-6eafb072203d">
      <con:settings/>
      <con:parameters/>
      <con:resource name="benefit" path="v2/products/benefit" id="756cc1aa-88db-4fa0-9a3f-320d5c931446">
        <con:settings/>
        <con:parameters/>
        <con:method name="Benefit Definition" id="f85567a2-de15-4071-9b33-23d4c3ee7669" method="POST">
          <con:settings/>
          <con:parameters/>
          <con:representation type="REQUEST">
            <con:mediaType>application/json</con:mediaType>
            <con:params/>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>text/html</con:mediaType>
            <con:status>403</con:status>
            <con:params/>
            <con:element>html</con:element>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>application/json</con:mediaType>
            <con:status>401 500</con:status>
            <con:params/>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType>application/json</con:mediaType>
            <con:status>200</con:status>
            <con:params/>
            <con:element xmlns:prod="https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products">prod:Response</con:element>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType>application/json; charset=utf-8</con:mediaType>
            <con:status>200</con:status>
            <con:params/>
            <con:element xmlns:prod="https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products">prod:Response</con:element>
          </con:representation>
          <con:request name="DEV" id="01083a8c-78a4-47e3-9aa8-3bfe776a2b7c" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": [
        {
          "PartyRoleDetails": {
            "LifeNumber": "1",
            "Party": {
              "FirstName": "John",
              "LastName": "Doe",
              "Age": "35",
              "BirthDate": "27/03/18",
              "SmokerStatus": "NS",
              "Gender": "M",
              "OccupationClass": "1",
              "EmploymentStatus": "Employed",
              "selfEmployedGT3Years": "false"
            }
          },
          "Products": {
            "Product": [
              {
                "ProductCode": "TCMP",
                "Channel": "SOVHUB",
                "ProductBenefits": {
                  "ProductBenefit": [
                    {
                      "BenefitName": "Life Cover",
                      "BenefitCode": "LC",
                      "BenefitType": "Life",
                      "BenefitDescription": "Life Cover"
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/products/benefit</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="FST" id="01083a8c-78a4-47e3-9aa8-3bfe776a2b7c" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${#Project#REST Service 1#IAM Tokens#FST#Response}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": [
        {
          "PartyRoleDetails": {
            "LifeNumber": "1",
            "Party": {
              "FirstName": "John",
              "LastName": "Doe",
              "Age": "35",
              "BirthDate": "27/03/18",
              "SmokerStatus": "NS",
              "Gender": "M",
              "OccupationClass": "1",
              "EmploymentStatus": "Employed",
              "selfEmployedGT3Years": "false"
            }
          },
          "Products": {
            "Product": [
              {
                "ProductCode": "TCMP",
                "Channel": "SOVHUB",
                "ProductBenefits": {
                  "ProductBenefit": [
                    {
                      "BenefitName": "Life Cover",
                      "BenefitCode": "LC",
                      "BenefitType": "Life",
                      "BenefitDescription": "Life Cover"
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/products/benefit</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="QA" id="01083a8c-78a4-47e3-9aa8-3bfe776a2b7c" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${#Project#REST Service 1#IAM Tokens#FST#Response}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": [
        {
          "PartyRoleDetails": {
            "LifeNumber": "1",
            "Party": {
              "FirstName": "John",
              "LastName": "Doe",
              "Age": "35",
              "BirthDate": "27/03/18",
              "SmokerStatus": "NS",
              "Gender": "M",
              "OccupationClass": "1",
              "EmploymentStatus": "Employed",
              "selfEmployedGT3Years": "false"
            }
          },
          "Products": {
            "Product": [
              {
                "ProductCode": "TCMP",
                "Channel": "SOVHUB",
                "ProductBenefits": {
                  "ProductBenefit": [
                    {
                      "BenefitName": "Life Cover",
                      "BenefitCode": "LC",
                      "BenefitType": "Life",
                      "BenefitDescription": "Life Cover"
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/products/benefit</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:environmentSpec>
            <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:method>
        <con:environmentSpec>
          <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:resource>
      <con:resource name="products" path="v2/products" id="33f559d1-a78d-4cfc-a6c6-fca77f4dfc08">
        <con:settings/>
        <con:parameters/>
        <con:method name="Products Benefits" id="1927d993-0ea6-4b84-bf3e-262c92ed1c46" method="POST">
          <con:settings/>
          <con:parameters/>
          <con:representation type="REQUEST">
            <con:mediaType>application/json</con:mediaType>
            <con:params/>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>text/html</con:mediaType>
            <con:status>403</con:status>
            <con:params/>
            <con:element>html</con:element>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>application/json</con:mediaType>
            <con:status>401 500 504 503</con:status>
            <con:params/>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType>application/json</con:mediaType>
            <con:status>200</con:status>
            <con:params/>
            <con:element xmlns:prod="https://ext-intoagd-api.sovereign.co.nz/quote/v1/products">prod:Response</con:element>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType xsi:nil="true"/>
            <con:status>0</con:status>
            <con:params/>
            <con:element>data</con:element>
          </con:representation>
          <con:request name="DEV" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12374",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John30",
            "LastName": "Doe30",
            "Age": "64",
            "BirthDate": "${=new java.text.SimpleDateFormat('dd/MM/YY').format(new Date())}",
            "SmokerStatus": "NS",
            "Gender": "M",
            "OccupationClass": "30",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="FST" id="afc69cc6-c929-4e1e-92b7-6cdb924c2a41" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John",
            "LastName": "DOE",
            "Age": "25",
            "BirthDate": "09/05/18",
            "SmokerStatus": "NS",
            "Gender": "M",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.fst.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="QA" id="ba314743-351c-418f-b882-3d222bae58f9" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request/>
            <con:originalUri>https://api.qa.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="PROD" id="d33b750f-31de-4f60-96f1-28d02a26360e" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request/>
            <con:originalUri>https://api.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="TEST" id="3bca363d-8388-4a88-9678-b2339be5a0b3" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://ext-intoagd-api.sovereign.co.nz:443</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PartyRolesInQuote": [
                {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John",
            "LastName": "Doe",
            "Age": "35",
            "BirthDate": "27/03/18",
            "SmokerStatus": "NS",
            "Gender": "M",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        }
      }
                  },
                   {"PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John",
            "LastName": "Doe",
            "Age": "35",
            "BirthDate": "27/03/18",
            "SmokerStatus": "NS",
            "Gender": "M",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        }
      }
                  }
    ]
  }
}</con:request>
            <con:originalUri>https://ext-intoagd-api.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:credentials>
              <con:username>WeiH</con:username>
              <con:password>Cloudinit1</con:password>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:preemptive>false</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
                <con:username>WeiH</con:username>
                <con:password>Cloudinit1</con:password>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:environmentSpec>
            <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:method>
        <con:environmentSpec>
          <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:resource>
      <con:resource name="premium" path="v2/calculate/premium" id="279d05a2-c723-40c1-8de5-32a5915b69ea">
        <con:settings/>
        <con:parameters/>
        <con:method name="Calculate Premium" id="2fb27ee0-b824-4746-b0c9-5b38d71aa3fb" method="POST">
          <con:settings/>
          <con:parameters/>
          <con:representation type="REQUEST">
            <con:mediaType>application/json</con:mediaType>
            <con:params/>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>text/html</con:mediaType>
            <con:status>403</con:status>
            <con:params/>
            <con:element>html</con:element>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType>application/json</con:mediaType>
            <con:status>200</con:status>
            <con:params/>
            <con:element xmlns:prem="https://api.dev.sovcloud.sovereign.co.nz/quote/v1/calculate/premium">prem:Response</con:element>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>application/json</con:mediaType>
            <con:status>401 504 503 500</con:status>
            <con:params/>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType xsi:nil="true"/>
            <con:status>0</con:status>
            <con:params/>
            <con:element>data</con:element>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>text/html; charset=utf-8</con:mediaType>
            <con:status>502</con:status>
            <con:params/>
            <con:element>html</con:element>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>application/soap+xml</con:mediaType>
            <con:status>500</con:status>
            <con:params/>
            <con:element xmlns:soap="http://www.w3.org/2003/05/soap-envelope">soap:Envelope</con:element>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>text/html; charset="utf-8"</con:mediaType>
            <con:status>500</con:status>
            <con:params/>
            <con:element>html</con:element>
          </con:representation>
          <con:representation type="REQUEST">
            <con:mediaType>application/x-www-form-urlencoded</con:mediaType>
            <con:params/>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType>application/json; charset=utf-8</con:mediaType>
            <con:status>200</con:status>
            <con:params/>
            <con:element xmlns:prod="https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products">prod:Response</con:element>
          </con:representation>
          <con:request name="DEV" id="7f6ea87f-9b56-486f-bba2-6b5792e1b16f" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PaymentFrequency": "Monthly",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John",
            "LastName": "DOE",
            "Age": "70",
            "BirthDate": "08/05/18",
            "SmokerStatus": "Yes",
            "Gender": "Female",
            "OccupationClass": "5",
            "EmploymentStatus": "Unemployed",
            "selfEmployedGT3Years": "false"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "PremiumOption": "To Age 80",
                "SumAssured": "812495",
                "ReviewTerm": "80",
                "Load": "200.0",
                "BenefitCode": "Life",
                "BenefitType": "Life",
                "LoadingPerMille": "3",
                "LoadingTerm": "4",
                "isIndexed": "Yes",
                "CommissionFactor": "0.7"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/calculate/premium</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="FST" id="ac62abef-ea60-4454-bf4e-db4316bf1332" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "7ef59ca5-47d8-43bd-896d-5022f847d45f",
          "ObjectId" : null,
          "LifeNumber" : 1,
          "PaymentFrequencyHeader" : "p/m",
          "Party" : {
            "selfEmployedGT3Years" : null,
            "EmploymentStatus" : "Employed",
            "OccupationClass" : "2",
            "Gender" : "Male",
            "SmokerStatus" : "No",
            "BirthDate" : null,
            "Age" : "33",
            "LastName" : "zafar",
            "FirstName" : null
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "CommissionFactor" : 1,
                "Id" : "464ddb78-d174-497e-9928-aca0770d8ddc",
                "ObjectId" : "",
                "isAvailable" : true,
                "BenefitDescription" : "Life Cover",
                "BenefitType" : "Life",
                "BenefitName" : "Life Cover",
                "LoadingPerMille" : "3",
                "LoadingTerm" : "33",
                "isIndexed" : "No",
                "Load" : "33",
                "PremiumOption" : "10 Year",
                "SumAssured" : "333333",
                "ReviewTerm" : "",
                "BenefitCode" : "Life"
              }, {
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "BenefitType" : "Life",
                "BenefitCode" : "FI",
                "BenefitName" : "Future Insurability Option"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.fst.sovcloud.sovereign.co.nz/quote/v1/calculate/premium</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="QA ext" id="4f5a4829-855e-485f-ba1f-67dd2e502af5" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://ext-intoagq-api.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PaymentFrequency": "Weekly",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John",
            "LastName": "DOE",
            "Age": "12",
            "BirthDate": "01/05/18",
            "SmokerStatus": "No",
            "Gender": "Male",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "true"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "PremiumOption": "10 Year",
                "SumAssured": "791269",
                "ReviewTerm": "10",
                "Load": "100.0",
                "BenefitCode": "LIFE",
                "BenefitType": "Life",
                "LoadingPerMille": "3",
                "LoadingTerm": "5",
                "isIndexed": "No",
                "CommissionFactor": "0.5"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.qa.sovcloud.sovereign.co.nz/quote/v1/calculate/premium</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="QA" id="4460680e-6dc3-4d95-af50-5ef350c77a08" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PaymentFrequency": "Monthly",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John",
            "LastName": "DOE",
            "Age": "10",
            "BirthDate": "08/05/18",
            "SmokerStatus": "No",
            "Gender": "Male",
            "OccupationClass": "4",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "PremiumOption": "Rate for Age",
                "SumAssured": "300781",
                "ReviewTerm": "1",
                "Load": "150.0",
                "BenefitCode": "Life",
                "BenefitType": "Life",
                "LoadingPerMille": "4",
                "LoadingTerm": "8",
                "isIndexed": "No",
                "CommissionFactor": "0.4"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://ext-intoagd-api.sovereign.co.nz/quote/v1/calculate/premium</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="QA 2" id="7f6ea87f-9b56-486f-bba2-6b5792e1b16f" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request/>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/calculate/premium</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="PROD" id="5acfe3f8-31e0-4c0b-b08c-f64324277526" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PaymentFrequency": "Monthly",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John",
            "LastName": "Doe",
            "Age": "35",
            "BirthDate": "27/03/18",
            "SmokerStatus": "false",
            "Gender": "Male",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "PremiumOption": "Rate for Age",
                "SumAssured": "300000",
                "ReviewTerm": "10",
                "Load": "1000",
                "BenefitCode": "LC",
                "BenefitType": "Life",
                "LoadingPerMille": "0.1",
                "LoadingTerm": "1",
                "isIndexed": "false",
                "CommissionFactor": "0.7"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.sovcloud.sovereign.co.nz/quote/v1/calculate/premium</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:environmentSpec>
            <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:method>
        <con:environmentSpec>
          <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:resource>
      <con:resource name="premium ext" path="1.0.0/QuickQuote" id="279d05a2-c723-40c1-8de5-32a5915b69ea">
        <con:settings/>
        <con:parameters/>
        <con:method name="Calculate Premium" id="2fb27ee0-b824-4746-b0c9-5b38d71aa3fb" method="POST">
          <con:settings/>
          <con:parameters/>
          <con:representation type="REQUEST">
            <con:mediaType>application/json</con:mediaType>
            <con:params/>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>text/html</con:mediaType>
            <con:status>403</con:status>
            <con:params/>
            <con:element>html</con:element>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType>application/json</con:mediaType>
            <con:status>200</con:status>
            <con:params/>
            <con:element xmlns:prem="https://api.dev.sovcloud.sovereign.co.nz/quote/v1/calculate/premium">prem:Response</con:element>
          </con:representation>
          <con:representation type="FAULT">
            <con:mediaType>application/json</con:mediaType>
            <con:status>401 504 503</con:status>
            <con:params/>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType xsi:nil="true"/>
            <con:status>0</con:status>
            <con:params/>
            <con:element>data</con:element>
          </con:representation>
          <con:request name="QA" id="4460680e-6dc3-4d95-af50-5ef350c77a08" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://ext-intoagq-api.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "12345",
    "PaymentFrequency": "Monthly",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "John",
            "LastName": "Doe",
            "Age": "35",
            "BirthDate": "27/03/18",
            "SmokerStatus": "false",
            "Gender": "Male",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "PremiumOption": "Rate for Age",
                "SumAssured": "300000",
                "ReviewTerm": "10",
                "Load": "1000",
                "BenefitCode": "LC",
                "BenefitType": "Life",
                "LoadingPerMille": "0.1",
                "LoadingTerm": "1",
                "isIndexed": "false",
                "CommissionFactor": "0.7"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://ext-intoagd-api.sovereign.co.nz/quote/v1/calculate/premium</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>authProfile</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>authProfile</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:environmentSpec>
            <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:method>
        <con:environmentSpec>
          <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:resource>
      <con:resource name="validation" path="v2/benefit/validation" id="8c09fb2a-d9eb-4723-ac1e-599dbddef78e">
        <con:settings/>
        <con:parameters/>
        <con:method name="Validation Rules" id="ef91cef4-f9b1-40d2-b4bd-111552ac8b9f" method="POST">
          <con:settings/>
          <con:parameters/>
          <con:representation type="FAULT">
            <con:mediaType>application/json</con:mediaType>
            <con:status>500</con:status>
            <con:params/>
            <con:element xmlns:prod="https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products">prod:Fault</con:element>
          </con:representation>
          <con:representation type="REQUEST">
            <con:mediaType>application/json</con:mediaType>
            <con:params/>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType>application/json</con:mediaType>
            <con:status>200</con:status>
            <con:params/>
            <con:element xmlns:prod="https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products">prod:Response</con:element>
          </con:representation>
          <con:representation type="RESPONSE">
            <con:mediaType xsi:nil="true"/>
            <con:status>0</con:status>
            <con:params/>
            <con:element>data</con:element>
          </con:representation>
          <con:request name="DEV" id="6b5f86f8-3cfe-48b3-b512-4d15e8e1f7d2" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request/>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="FST" id="425c1fc5-cacf-47e6-b7c6-5e99f9283e3e" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request/>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:request name="QA" id="9b39bcaa-29c6-4221-bd43-d713231505c7" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request/>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:request>
          <con:environmentSpec>
            <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:method>
        <con:environmentSpec>
          <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:resource>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="2aaa1e50-cb86-43dc-8c75-f1407ae328c8" wadlVersion="http://wadl.dev.java.net/2009/02" name="REST Service 2" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints/>
    <con:resource name="/utilities/v1/occupationclass/occupation" path="/utilities/v1/occupationclass/occupation" id="d5c1ff85-a5db-468c-b452-e151366c22a8">
      <con:settings/>
      <con:parameters/>
      <con:method name="POST" id="cfec8c0f-7290-4602-ae31-06b969a1d5c8" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:request name="POST Request" id="28603f51-8e85-4b42-ad51-3c5436346755" mediaType="application/json">
          <con:settings/>
          <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="52f0ae77-94fa-4463-bab9-534573e0ee96" wadlVersion="http://wadl.dev.java.net/2009/02" name="REST Service 3" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints/>
    <con:resource name="/utilities/v1/occupationclass/occupation" path="/utilities/v1/occupationclass/occupation" id="29d4f671-7b86-4d3d-8a13-cc108031f9a7">
      <con:settings/>
      <con:parameters/>
      <con:method name="GET" id="e2d309ef-ffdb-4680-ad03-865405b6fdd6" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:request name="GET Request" id="e51ce212-8b1b-4f3e-aea3-3af1dcf8e175" mediaType="application/json">
          <con:settings/>
          <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="d2c7fa55-3fd2-4fb3-91a9-0d991f32b5ee" wadlVersion="http://wadl.dev.java.net/2009/02" name="REST Service 4" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints/>
    <con:resource name="/utilities/v1/occupationclass/occupation" path="/utilities/v1/occupationclass/occupation" id="11d483ec-8a2b-423f-954b-db75838967bb">
      <con:settings/>
      <con:parameters/>
      <con:method name="GET" id="b498b03e-5c40-4a9b-b83a-2add33a9db18" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:representation type="FAULT">
          <con:mediaType>application/json</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
        </con:representation>
        <con:request name="GET Request" id="f6b35663-0ace-454c-bdf3-c7f1fda49ce8" mediaType="application/json">
          <con:settings/>
          <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="4a10a3f5-f766-4626-ab26-4a215aa18af1" wadlVersion="http://wadl.dev.java.net/2009/02" name="REST Service 5" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints/>
    <con:resource name="/utilities/v1/occupationclass" path="/utilities/v1/occupationclass" id="52717a12-ad43-4367-b470-9c3909c67f24">
      <con:settings/>
      <con:parameters/>
      <con:method name="GET" id="ad1f613c-703a-4600-9cf9-44d50b777465" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:representation type="FAULT">
          <con:mediaType>application/soap+xml</con:mediaType>
          <con:status>500</con:status>
          <con:params/>
          <con:element xmlns:soap="http://www.w3.org/2003/05/soap-envelope">soap:Envelope</con:element>
        </con:representation>
        <con:request name="GET Request" id="861a8a1d-d9d0-407f-990d-f1edd1862733" mediaType="application/json">
          <con:settings/>
          <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:testSuite id="3a4a478a-5658-4e9b-a8ef-5e74d20ac1df" name="Calculate Premium">
    <con:settings>
      <con:setting id="IncludeOverview">true</con:setting>
      <con:setting id="IncludeResults">true</con:setting>
      <con:setting id="FlowLayout">false</con:setting>
      <con:setting id="ErrorDetails">true</con:setting>
      <con:setting id="IncludeCoverage">true</con:setting>
    </con:settings>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="838d6f14-1e1e-4d92-a19a-ececd88fbc9c" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Health(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="bd1d69dc-514a-42c2-a95d-222f76a33227">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="a7d5b8dd-6634-4905-83b6-d6827f6357e8">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="faed87c8-bf36-4de3-9144-010faa72c4bb">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="cef7ec50-4132-42eb-92ab-cce78e12d00a">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="a1c3a452-e473-41d1-b22b-05def2f9add0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="a889f7d1-76b6-47f3-bd40-db1cf588c973">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/Health.xlsx</file>
              <worksheet/>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>PH - Loading</con:property>
          <con:property>PH - Excess</con:property>
          <con:property>PH - Specialist cover</con:property>
          <con:property>PH - Specialist Excess</con:property>
          <con:property>Health Premium Waiver</con:property>
          <con:property>PWH - Wait</con:property>
          <con:property>PWH - Loading</con:property>
          <con:property>PWH - Term</con:property>
          <con:property>Plus-Loading</con:property>
          <con:property>Health Base</con:property>
          <con:property>Health Plus</con:property>
          <con:property>Health Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="c498a5b1-08a8-4d35-9ea1-2b16ac885579">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Health/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="151ad78c-9c8c-4c0f-90e5-20596f58a79f">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Premium">
              <con:configuration>
                <scriptText><![CDATA[float _api_health = 0.0
float _api_health_plus = 0.0
float _api_health_waiver = 0.0
float _sheet_health = 0.0
float _sheet_health_waiver = 0.0
float _diff_health = 0.0
float _diff_health_plus = 0.0
float _diff_health_waiver = 0.0
int _wop_index=2

_api_health = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
_sheet_health = context.expand( '${#TestCase#SHEET_HEALTH}' ) as float
_diff_health = Math.abs(_api_health - _sheet_health).round(2)

if ( context.expand( '${When i read users\' information#PH - Specialist cover}' ) == 'Y' ) 
{
	_api_health_plus = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
	_sheet_health_plus = context.expand( '${#TestCase#SHEET_HEALTH_PLUS}' ) as float
	_diff_health_plus = Math.abs(_api_health_plus - _sheet_health_plus).round(2)
}
if ( context.expand( '${When i read users\' information#PH - Specialist cover}' ) == 'N' && context.expand( '${When i read users\' information#Health Premium Waiver}' ) == 'Y') 
{
	_wop_index=1
}
if ( context.expand( '${When i read users\' information#Health Premium Waiver}' ) == 'Y' )
{
	_api_health_waiver = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+_wop_index+'][\'BenefitPremium\']}' ) as float
	_sheet_health_waiver = context.expand( '${#TestCase#SHEET_HEALTH_WAIVER}' ) as float
	_diff_health_waiver = Math.abs(_api_health_waiver - _sheet_health_waiver).round(2)
}

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01
assert _diff_health <= tolerance && _diff_health_plus <= tolerance && _diff_health_waiver <= tolerance
//try to catch unexpected error message, which should be null or empty string
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="7c214f1d-f95d-4f79-8376-e2457c7aac5e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Health/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="88e3874f-290b-4e15-9147-37ed10c315c8">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.Health.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed GT3</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['selfEmployedGT3Years']}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Excess</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['ExcessFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Specialist cover</con:name>
              <con:value>${When i read users' information#PH - Specialist cover}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Specialist Excess</con:name>
              <con:value>${When i read users' information#PH - Specialist Excess}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Premium Waiver</con:name>
              <con:value>${When i read users' information#Health Premium Waiver}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Wait</con:name>
              <con:value>${When i read users' information#PWH - Wait}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Loading</con:name>
              <con:value>${#TestCase#PWH_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Term</con:name>
              <con:value>${#TestCase#PWH_TERM}</con:value>
            </con:property>
            <con:property>
              <con:name>Plus-Loading</con:name>
              <con:value>${#TestCase#PLUS_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Base</con:name>
              <con:value>${#TestCase#SHEET_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Plus</con:name>
              <con:value>${#TestCase#SHEET_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health Plus</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Plus Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Waiver</con:name>
              <con:value>${#TestCase#SHEET_HEALTH_WAIVER}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH_WAIVER}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${When i read users' information#Pol Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Toatl</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="3ca9ce8d-a4f8-4a6a-a488-a672b472d9d6">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="19afac6f-ded6-4f3a-b86b-aa80bc092615">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="9655ec80-6c04-4516-9cd1-310247ccf280">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzUxNzc4Niwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM1MjEzODYsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJhMzVlOTM3NC03ODQxLTQ3YmMtYjY4Mi0xMGNhY2UxMDhkOGQiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.C6MZAvI8B3CSPTbKmLLWpOQfwbNCZpZJZqJVrjOblnvCyPhuYz27TH7rpuMD0S_CMXmA2gD1i3qA7YE7cEE2exO9nHUEXS9ADnG0S6puryui3k_OE3lPBpuzBXqMNNmZBD6RzK92VzO7iPk_UzDpM0g2UuWlWiwRI83uE69I87M</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>06/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Weekly</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>HAS_WAIVER_POLICY_FEE</con:name>
          <con:value>true</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOY_STATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>PH_LOAD</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>PWH_LOAD</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>PWH_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>PLUS_LOAD</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH</con:name>
          <con:value>4.63</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH_PLUS</con:name>
          <con:value>1.93</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH_WAIVER</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>6.56</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "PrvtHlthPolicyFee" : "${#TestCase#HAS_WAIVER_POLICY_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years": "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOY_STATUS}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ 
              {
                "ExcessFactor" : "${When i read users' information#PH - Excess}",
                "Load" : "${#TestCase#PH_LOAD}",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "BenefitCategory" : "Health",
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}",
                "selfEmployedGT3Years": "${#TestCase#SEGT3}"
              }, 
              {
                "CompositeCode" : "PrvtHlth_HlthPls",
                "BenefitCode" : "HlthPls",
                "BenefitDescription" : "Health Plus",
                "BenefitName" : "Health Plus",
                "Load" : "${#TestCase#PLUS_LOAD}",
                "ExcessFactor" : "${When i read users' information#PH - Specialist Excess}",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Hlth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "HlthPls",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}",
                "selfEmployedGT3Years": "${#TestCase#SEGT3}"
              }]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH_WAIVER</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>API_HEALTH_PLUS</con:name>
          <con:value>1.93</con:value>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>START_ROW</con:name>
          <con:value>270</con:value>
        </con:property>
        <con:property>
          <con:name>END_ROW</con:name>
          <con:value>319</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1c3a452-e473-41d1-b22b-05def2f9add0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="db3e1743-0624-4cad-9dfe-12dec52b767e" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Health(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="9d394b15-3941-485d-a510-9a3c2135efce">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="cd15774b-6ebb-44cf-875a-c4c06e5bb291">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="1a530132-9cd3-47fd-bb30-7280f034fa51">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="238bc245-74e4-4fe9-8b82-49eac5be7771">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="0a8b68ce-ab67-4da2-8e35-261d9fa20785">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="0e601975-a9ce-49f0-b27d-79f4531161a2">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/Health.xlsx</file>
              <worksheet/>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>PH - Loading</con:property>
          <con:property>PH - Excess</con:property>
          <con:property>PH - Specialist cover</con:property>
          <con:property>PH - Specialist Excess</con:property>
          <con:property>Health Premium Waiver</con:property>
          <con:property>PWH - Wait</con:property>
          <con:property>PWH - Loading</con:property>
          <con:property>PWH - Term</con:property>
          <con:property>Plus-Loading</con:property>
          <con:property>Health Base</con:property>
          <con:property>Health Plus</con:property>
          <con:property>Health Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="57702a37-a400-4499-8f75-b9842bc233a1">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Health/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="1e26d8ae-8f01-4b2f-b697-0ac09a78dfc2">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Premium">
              <con:configuration>
                <scriptText><![CDATA[float _api_health = 0.0
float _api_health_plus = 0.0
float _api_health_waiver = 0.0
float _sheet_health = 0.0
float _sheet_health_waiver = 0.0
float _diff_health = 0.0
float _diff_health_plus = 0.0
float _diff_health_waiver = 0.0
int _wop_index=2

_api_health = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
_sheet_health = context.expand( '${#TestCase#SHEET_HEALTH}' ) as float
_diff_health = Math.abs(_api_health - _sheet_health).round(2)

if ( context.expand( '${When i read users\' information#PH - Specialist cover}' ) == 'Y' ) 
{
	_api_health_plus = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
	_sheet_health_plus = context.expand( '${#TestCase#SHEET_HEALTH_PLUS}' ) as float
	_diff_health_plus = Math.abs(_api_health_plus - _sheet_health_plus).round(2)
}
if ( context.expand( '${When i read users\' information#PH - Specialist cover}' ) == 'N' && context.expand( '${When i read users\' information#Health Premium Waiver}' ) == 'Y') 
{
	_wop_index=1
}
if ( context.expand( '${When i read users\' information#Health Premium Waiver}' ) == 'Y' )
{
	_api_health_waiver = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+_wop_index+'][\'BenefitPremium\']}' ) as float
	_sheet_health_waiver = context.expand( '${#TestCase#SHEET_HEALTH_WAIVER}' ) as float
	_diff_health_waiver = Math.abs(_api_health_waiver - _sheet_health_waiver).round(2)
}

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01
assert _diff_health <= tolerance && _diff_health_plus <= tolerance && _diff_health_waiver <= tolerance
//try to catch unexpected error message, which should be null or empty string
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="c5b1f577-9b75-4ade-8eb1-1b24a7a2b213">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Health/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="ad35e28f-f263-4ca8-b824-457f02566007">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.Health.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed GT3</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['selfEmployedGT3Years']}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Excess</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['ExcessFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Specialist cover</con:name>
              <con:value>${When i read users' information#PH - Specialist cover}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Specialist Excess</con:name>
              <con:value>${When i read users' information#PH - Specialist Excess}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Premium Waiver</con:name>
              <con:value>${When i read users' information#Health Premium Waiver}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Wait</con:name>
              <con:value>${When i read users' information#PWH - Wait}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Loading</con:name>
              <con:value>${#TestCase#PWH_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Term</con:name>
              <con:value>${#TestCase#PWH_TERM}</con:value>
            </con:property>
            <con:property>
              <con:name>Plus-Loading</con:name>
              <con:value>${#TestCase#PLUS_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Base</con:name>
              <con:value>${#TestCase#SHEET_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Plus</con:name>
              <con:value>${#TestCase#SHEET_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health Plus</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Plus Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Waiver</con:name>
              <con:value>${#TestCase#SHEET_HEALTH_WAIVER}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH_WAIVER}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${When i read users' information#Pol Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Toatl</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unepxected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="f783b945-5cd6-46f0-8e29-27311e9343d1">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="e1ad69a5-20c1-46d7-80cf-8ec41063ca52">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="00c9b7ba-8f9c-4fe8-97fa-96502be7b10a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMzNTE3ODM0LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMzUyMTQzNCwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6IjY0MGNkMDNkLTI5MmYtNDIwZS04NDliLTViNGM0YzhhYWZjMiIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.hRgaQ_qe3GdTNEvOI2xnnyqkEnQIW20jIuZN-1L4ZzTwjFXAMnkrjTrWtZJ1xXMgbcBA7sFXNuLfi0WVdXf4k8F9iSK5p2e410MnNmQoVd1SIMC44ny0iE3LpnnTl4Q8vVp0Go9jKgJck7fCCdLDwleTo_H4cqCilgS6iyPvGMc</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>06/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>HAS_WAIVER_POLICY_FEE</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOY_STATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>PH_LOAD</con:name>
          <con:value>150</con:value>
        </con:property>
        <con:property>
          <con:name>PWH_LOAD</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>PWH_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>PLUS_LOAD</con:name>
          <con:value>150</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH</con:name>
          <con:value>447.24</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH_WAIVER</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>73.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>521.04</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "PrvtHlthPolicyFee" : "${#TestCase#HAS_WAIVER_POLICY_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years": "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOY_STATUS}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ 
              {
                "ExcessFactor" : "${When i read users' information#PH - Excess}",
                "Load" : "${#TestCase#PH_LOAD}",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "BenefitCategory" : "Health",
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}",
                "selfEmployedGT3Years": "${#TestCase#SEGT3}"
              }]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH_WAIVER</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>API_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0a8b68ce-ab67-4da2-8e35-261d9fa20785</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="7185e4ba-1396-4191-944e-7005e5cf3d53" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="S&amp;T(DEV)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="618105bc-c31a-4a0c-b512-4316b2ebf25d">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="ff337e2d-ad6f-410a-b50a-043306bb4a48">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="87b726a5-a353-4374-88b9-b6acd86b3d91">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="f16715a2-ca1f-40b2-bad1-8b9eec1c03cd">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="9b57902f-73f0-4757-9cf0-9d2390334bbc">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="3d6600d5-f8dd-4a3a-b6e2-ba263e78f86f">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/S&amp;T(exChild).xlsx</file>
              <worksheet/>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>LIFE</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="7e7d3308-7977-48ca-b709-9b251793ef04">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/S&amp;T/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="713cb1bd-53ae-402c-8e10-ddc296b149d3">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCode" : "Life",
                "ReviewTerm" : "",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "Load" : "${#TestCase#LOAD}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "",
                "Load" : "${#TestCase#LOAD_ST}",
                "PremiumOption" : "",
                "ExcessFactor" : "${#TestCase#EXCESS_FACTOR}",
                "ChildCover" : "${#TestCase#CHILD_COVER}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, S&amp;T and S&amp;T_Child">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as float
def _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as float
//change it when it comes out!!
def _api_st_child = "0.00" as float
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as float

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _diff_life = Math.abs(_api_life - _sheet_life) as float
def _diff_st = Math.abs(_api_st - _sheet_st) as float
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as float
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

_diff_life = _diff_life.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_pf=_diff_pf.round(2)

assert _diff_life <= tolerance && _diff_st <= tolerance && _diff_st_child <= 0.01 && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="6a04f031-2107-4fc7-851a-afe8bb3d3541">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/S&amp;T/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="17e28434-10ec-4140-a992-d0ce19448be6">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.S&amp;T.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${#TestCase#SEGT3}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>Excess Factor</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Life</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error S&amp;T</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="e6c3cb09-1a02-44ba-82e3-e0929cfc70e3">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="347d2902-d099-4e4d-97c4-a27875657083">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="b7e272fa-4191-401e-a4f4-e6053b10163b">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMTQyODY5MSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzE0MzIyOTEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiJmNWQwNWU3Yi02NDAzLTQxOTQtYjRmMy01ZjIxZDIzMjljNTgiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.IQe6Catk2BGiOdgGzKD7Qi0H6AO-H2Z92ZPH1qO0eALcWn1NBb_7BqqaKHf-K6uaQY5M-VpaMi5XNysSciIHoz4rO6Fwy7bHWSN0BaVPuLWO1l0gDlQzhiSAnDIQMFP8JW6S_eC-u8TDRiIirmLuv43jB86PrzI9Hth5r_i0TvY</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>13/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Fortnightly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.01</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>334.63</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>2.84</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>376.96</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>39.49</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>300</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9b57902f-73f0-4757-9cf0-9d2390334bbc</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="c0932112-8ab9-4d78-b2d5-2d2172dea9a0" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="S&amp;T(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="a081dfd1-51f5-49b5-a2c7-a1758ba929b5">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="5e470eda-1faf-4787-8fa5-fbeec2827d4c">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="cb47b10c-e3d3-405d-9812-999b4d487a46">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="fb7b4506-1e23-41d6-bd35-a5c6c30e46d3">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="f513cdcf-0ccf-4347-bf1c-4940a2ebf309">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="f851d727-ad96-440a-92f1-03d1d7e2df95">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/S&amp;T(exChild).xlsx</file>
              <worksheet/>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>LIFE</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="a6f7d24a-0dde-4176-84ec-f53f65193d2d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/S&amp;T/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="62336a8b-1c1c-4260-b140-f981eaca1e43">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCode" : "Life",
                "ReviewTerm" : "",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "Load" : "${#TestCase#LOAD}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "",
                "Load" : "${#TestCase#LOAD_ST}",
                "PremiumOption" : "",
                "ExcessFactor" : "${#TestCase#EXCESS_FACTOR}",
                "ChildCover" : "${#TestCase#CHILD_COVER}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, S&amp;T and S&amp;T_Child">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as float
def _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as float
//change it when it comes out!!
def _api_st_child = "0.00" as float
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as float

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _diff_life = Math.abs(_api_life - _sheet_life) as float
def _diff_st = Math.abs(_api_st - _sheet_st) as float
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as float
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

_diff_life = _diff_life.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_pf=_diff_pf.round(2)

assert _diff_life <= tolerance && _diff_st <= tolerance && _diff_st_child <= 0.01 && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="1a17e2bd-8718-42a6-976c-9cf2600ed101">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/S&amp;T/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="7a926ab2-b433-44c9-87f1-8b545af31207">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.S&amp;T.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${#TestCase#SEGT3}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>Excess Factor</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Life</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error S&amp;T</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="b3500001-34cd-4d77-abf7-b2b8c13c09c0">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="7d6f61bd-6a27-474b-b5e9-f79cf891d84d">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="ebf423b7-d9f2-4023-aa1e-3b7b4170be89">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjkyMTkwMywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI5MjU1MDMsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJmMWNmYjgyYi02ZDliLTQ0NmYtOWM3OS00MjY1ZDUzOTAxYTYiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.jxxh6Wa4OYMCtCzyOJ8azYuNkqveXXRvc53rjwe8e3mrH-bb_AyugDX8F9q-sB3_y2lOGtmYNSfq8VQWx9NxvjZ70CRuh-mHt57n5JMt3PSAIxkq8FCy2TqlCLZKGstqHiE2oRsVLVgGXkQDgXQhQ2GtSacVaWnFXy5Z1IXFmoE</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>30/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>200.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>20</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>241.89</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>296.85</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>48.81</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>200.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>300</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f513cdcf-0ccf-4347-bf1c-4940a2ebf309</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="b9e1cda5-3e14-4517-8fc0-c3fd8ed61fde" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="S&amp;T(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="32bf9b2f-31d6-45bd-9591-e90e3eeb4686">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="ff38855f-f2f5-455f-8cd1-150aa42c6d64">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="859d0cfa-2ef0-44ce-b794-206d9ca1239f">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="8c136202-d9c9-4409-9f43-42d84d06b1c3">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="02568281-1218-41ca-8b76-2ba129ee3d85">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="36584794-fade-4d13-a39f-e9f5a9e72dbf">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/S&amp;T(exChild).xlsx</file>
              <worksheet/>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>LIFE</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="4a24699d-f5f3-4a32-98cc-1a0262f787b6">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/S&amp;T/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="0b84f135-2651-4ba3-b5dc-224b6de9739c">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCode" : "Life",
                "ReviewTerm" : "",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "Load" : "${#TestCase#LOAD}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "",
                "Load" : "${#TestCase#LOAD_ST}",
                "PremiumOption" : "",
                "ExcessFactor" : "${#TestCase#EXCESS_FACTOR}",
                "ChildCover" : "${#TestCase#CHILD_COVER}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, S&amp;T and S&amp;T_Child">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as float
def _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as float
//change it when it comes out!!
def _api_st_child = "0.00" as float
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as float

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _diff_life = Math.abs(_api_life - _sheet_life) as float
def _diff_st = Math.abs(_api_st - _sheet_st) as float
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as float
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

_diff_life = _diff_life.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_pf=_diff_pf.round(2)

assert _diff_life <= tolerance && _diff_st <= tolerance && _diff_st_child <= 0.01 && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="5699a8da-6d7a-4075-8309-d27a962340d7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/S&amp;T/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="aa1f2291-348a-4ced-aae4-177f5bf15d3e">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.S&amp;T.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${#TestCase#SEGT3}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>Excess Factor</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Life</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error S&amp;T</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="4bcacf44-a652-4fc9-926b-f4f28b598c0b">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="94ffb443-58e1-4dc3-832f-1d206227dd58">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="2020d151-a995-435a-8ff1-03fad5e560c4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTI5NDY0MjIwLCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUyOTQ2NzgyMCwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImU4Nzg1YjZkLWIwZGMtNGFkZS1iMmUxLTgxZTcwMTNmODk2OCIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.T9u3y-CHW31uZzk3gGvorsFBYU5bXSGv2VWsPFkvjaC327NU8MMuTQX0k4Lqm40FqNGgfxmpM8RoFFh8kEsjKXcIaq8yT9mpqzrycLX4o_LD8BNgE_uUBMW35aYYd-AwU66Yl03skAMWUPBpSZ_9Uc7auMbPkscSuCryJOuDHuQ</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>20/06/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Female</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Indexed</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>INVALID</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>100</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>1369.33</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>1691.35</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>322.02</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02568281-1218-41ca-8b76-2ba129ee3d85</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="e39bc4b7-fa8f-4d44-8f1b-5f3c65ac32f1" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="FI(DEV)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="cefe51cb-12ce-4c3a-8472-37c62d746c52">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="8d2375ea-0600-4eb6-a50b-d65d9e61dbaf">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="ad75bd3a-bba3-4809-bb8d-466549366c5a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="6b95e7fd-0069-4fb2-8cf0-9f517d9426ea">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="b116f3b5-4737-415f-a0b3-f2f58a107449">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="37360bca-aee7-45fe-a676-148a7a6b9acd">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/FI.xlsx</file>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life</con:property>
          <con:property>FI</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="96c8c134-ede4-4273-9ba2-496794be213d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/FI/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="279c880f-59cf-452a-8de6-df881530f70b">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" :"${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "",
          "LifeNumber" : 1,   
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYEDSTATUS}",
            "Salary" : null,
            "OccupationClass" : "${When i read users' information#Occupation Class}",
             "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "BirthDate" : null,
            "Age" : "${When i read users' information#Age}"
         
          },
          "LifeId" : ""
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "isIndexed" :  "${#TestCase#LIFEINDEX}",
                "PremiumOption" :"${#TestCase#PRE_OPT}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "ReviewTerm" : "${#TestCase#REVIEW_TERM}",  
                "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Life Cover",
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitName" : "Life Cover",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "ReviewTerm" : "${#TestCase#REVIEW_TERM}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "isIndexed" :"${#TestCase#LIFEINDEX}",
                "Load" : "${#TestCase#LOAD}",
                "BenefitId" : "",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                    "BenefitCode" : "Life"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Future Insurability",
                "BenefitCode" : "FI",
                "BenefitName" : "Future Insurability"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="2bd54c3a-ffe1-4353-ba9c-b76891061b6c" name="Checking Life &amp; FI">
              <con:configuration>
                <scriptText>def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as float
def _api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as float
def _diff_life = Math.abs(_api_life - _sheet_life) as float
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as float
float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

_diff_life = _diff_life.round(2)
_diff_fi = _diff_fi.round(2)

assert _diff_life &lt;= tolerance &amp;&amp; _diff_fi &lt;= tolerance</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="6112f6e6-cfdf-46dc-9695-282b7241d62e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/FI/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="3185a3c9-468e-4bcb-84db-d2b513e637f4">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.FI.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${#TestCase#SEGT3}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Life</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error FI</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="dbf494b2-c0b9-4292-9fae-5075686466d3">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="0d63b8f8-7ea7-4248-b356-717f6bbdb9ae">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="5a49bf16-4df3-448e-bb02-87196957af13">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMDg1MjI2MSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzA4NTU4NjEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiI1YTkyZmMwMS02ZDIwLTRiMjYtOGMyNi1mMzdlZWRjM2I2MjEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.XxYjrK3Xr_BU8rxFggTGuGAeLCu65xZQTltbpsn-lV0PaJ1yaBgO1Qwc4_F_zFMemIRUIdgZNm8sEw2XqkuU6B86lj3QKfUohEV0c2niKZgDDKS00v_dy37nUJU-QNQ4PQymvdJ99JLSvTDA5UViEGC6a_6nxmNtnZjE79WPbds</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>06/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>150.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>INVALID</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>30</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>200.62</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>12.14</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>218.91</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b116f3b5-4737-415f-a0b3-f2f58a107449</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="048e3a8c-b75e-49f9-a8be-0151ef5e672c" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="FI(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="f672a493-6177-4970-9196-11ca8bcf2ff4">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="02d27bfa-c231-4ef9-88ef-85d97eea5389">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="e58b3b7e-098d-4a08-a711-ff3b3d349f2d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="18f2ce35-e32a-4cb6-aa33-771790b3102b">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="b640d001-816a-4231-b438-91af52a670a0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="2639d619-cdd6-47fb-925a-8dfc006059d4">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/FI.xlsx</file>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life</con:property>
          <con:property>FI</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="a54a8d93-4e12-4a57-bf5f-70e6326893d4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/FI/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="9ae9586d-5418-49dd-a321-ad70fbe8f095">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" :"${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "",
          "LifeNumber" : 1,   
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYEDSTATUS}",
            "Salary" : null,
            "OccupationClass" : "${When i read users' information#Occupation Class}",
             "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "BirthDate" : null,
            "Age" : "${When i read users' information#Age}"
         
          },
          "LifeId" : ""
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "isIndexed" :  "${#TestCase#LIFEINDEX}",
                "PremiumOption" :"${#TestCase#PRE_OPT}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "ReviewTerm" : "${#TestCase#REVIEW_TERM}",  
                "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Life Cover",
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitName" : "Life Cover",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "ReviewTerm" : "${#TestCase#REVIEW_TERM}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "isIndexed" :"${#TestCase#LIFEINDEX}",
                "Load" : "${#TestCase#LOAD}",
                "BenefitId" : "",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                    "BenefitCode" : "Life"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Future Insurability",
                "BenefitCode" : "FI",
                "BenefitName" : "Future Insurability"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="2bd54c3a-ffe1-4353-ba9c-b76891061b6c" name="Checking Life &amp; FI">
              <con:configuration>
                <scriptText>def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as float
def _api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as float
def _diff_life = Math.abs(_api_life - _sheet_life) as float
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as float
float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

_diff_life = _diff_life.round(2)
_diff_fi = _diff_fi.round(2)

assert _diff_life &lt;= tolerance &amp;&amp; _diff_fi &lt;= tolerance</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="fa3adfc3-f273-496f-8c3a-c3c2c5fa7162">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/FI/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="0a442153-8fdd-4a64-8058-521706264431">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.FI.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${#TestCase#SEGT3}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Life</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error FI</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="c1dcee2e-818d-48f7-8aa8-44d595b5203a">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="b257a791-a495-4719-9727-9bc8a493ec03">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="90cd2dd2-662c-409d-87a6-34c290ced209">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzE3MjUzMiwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzMxNzYxMzIsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJiMDdjYmZjYi05YjY1LTQ0NjMtOGMyOC02NDM5MzA3Nzk2M2IiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.W4gHWKp6_X2v_a8XofLm1TA8evruaWgN3xD9ZZJOw7S4aAgoy1sNGBUtHcFNtgPen0kCSiCIVCRQi1XzhwNkOgqW0INegGQhitTAHUWBXIrT06748yAwvqOtlAJJrhM7wei9T-RQIMdRzO6k3a2D6dkzlg9BBkS4s62VcywmC78</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>02/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Weekly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>26.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>0.9</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>1.42</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>29.12</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b640d001-816a-4231-b438-91af52a670a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="4861feb9-23f2-4907-9a37-37ccc99dcb1a" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="FI(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="66f0b9bd-c242-4b94-83e7-e5260ee717af">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="19c22b5f-b588-45b7-be7b-3f1c169892c5">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="a84e4a31-fe13-4a85-8765-213186db66e7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="18b5eb30-f78a-4d50-a431-bcefc314fbe5">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="917aaefc-e555-4a9f-969b-57a39a370740">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="da57d302-6c7b-498f-be11-7fa891f1a4bc">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/FI.xlsx</file>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life</con:property>
          <con:property>FI</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="d88fd46e-ac2e-452f-8f99-f35cc146e68a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/FI/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="40bbc204-5f59-479e-a4fd-cbd1211629a2">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" :"${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "",
          "LifeNumber" : 1,   
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYEDSTATUS}",
            "Salary" : null,
            "OccupationClass" : "${When i read users' information#Occupation Class}",
             "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "BirthDate" : null,
            "Age" : "${When i read users' information#Age}"
         
          },
          "LifeId" : ""
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "isIndexed" :  "${#TestCase#LIFEINDEX}",
                "PremiumOption" :"${#TestCase#PRE_OPT}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "ReviewTerm" : "${#TestCase#REVIEW_TERM}",  
                "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Life Cover",
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitName" : "Life Cover",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "ReviewTerm" : "${#TestCase#REVIEW_TERM}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "isIndexed" :"${#TestCase#LIFEINDEX}",
                "Load" : "${#TestCase#LOAD}",
                "BenefitId" : "",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                    "BenefitCode" : "Life"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Future Insurability",
                "BenefitCode" : "FI",
                "BenefitName" : "Future Insurability"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="2bd54c3a-ffe1-4353-ba9c-b76891061b6c" name="Checking Life &amp; FI">
              <con:configuration>
                <scriptText>def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as float
def _api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as float
def _diff_life = Math.abs(_api_life - _sheet_life) as float
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as float
float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

_diff_life = _diff_life.round(2)
_diff_fi = _diff_fi.round(2)

assert _diff_life &lt;= tolerance &amp;&amp; _diff_fi &lt;= tolerance</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="e58b7b94-fa5e-4f7c-92d3-a58cdd420bc9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/FI/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="261a87e9-5df8-4393-9465-754a9360c111">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.FI.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${#TestCase#SEGT3}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Life</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error FI</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="560d86d1-5db7-46a0-b6f7-b7f77d8c12b4">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="bf90df36-4672-4ce2-a26c-30c7d544d7b6">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="44184347-1ade-489f-a86f-e598182c01b4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMxMjcyNjQ2LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMTI3NjI0Niwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6Ijk1YjUyZWQ0LWE0ZmYtNDk2NS04MDQ3LWUyYzQzYzVhZDAzNSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.XzBRVfleOnV31cEn9y-uj4OVnC1n1CnufsOz_E8evyVZUIu-hYuco3-idM4jSgoPeqphWsTZHAkvQtZFYxn0WGbpCGyGshQRxb71iZgmlUN0VuBG4-ZFVEXgyLtMCn3lNqhMaoub9TFCiLSQQOuHK5Ku86jUUJV8aUQv8ZzPpTU</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>11/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>150.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>INVALID</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>30</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>268.12</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>10.52</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>284.79</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>917aaefc-e555-4a9f-969b-57a39a370740</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="fdb83349-76a4-4e1d-88a5-3cea4decc088" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(DEV)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="e4b31bbd-e26d-4a6f-9046-5e5528ddb75f">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="1d371cfd-d662-44d0-9652-a381a08a049c">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="867bead8-57fd-4b7c-906b-f32e628a20b7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="343d6f50-d327-4220-8ae1-bff2ca27d65d">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="b95c643c-1436-4627-b72d-a34099c60ad0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="d6de0904-7fee-49a0-9d98-4b14269bf8ac">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/LIFE.xlsx</file>
              <worksheet>LIFE</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>LIFE</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="01c7e6f0-12eb-421d-ae15-e8a580a97d83">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Life/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="590f3b8d-4d18-4cf0-bb30-b39ad4afc3b0">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "${#TestCase#QUOTENUMBER}",
    "PaymentFrequency": "${#TestCase#FREQUENCY}",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "${#TestCase#FIRSTNAME}",
            "LastName": "${#TestCase#LASTNAME}",
            "Age": "${When i read users' information#Age}",
            "BirthDate": "${#TestCase#THEDATE}",
            "SmokerStatus": "${#TestCase#SMOKER}",
            "Gender": "${#TestCase#GENDER}",
            "OccupationClass": "${When i read users' information#Occupation Class}",
            "EmploymentStatus": "${#TestCase#EMPLOYEDSTATUS}",
            "selfEmployedGT3Years": "${#TestCase#SEGT3}"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "isMain": true,
                "PremiumOption": "${#TestCase#PRE_OPT}",
                "SumAssured": "${When i read users' information#Life Cover}",
                "ReviewTerm": "${#TestCase#REVIEW_TERM}",
                "Load": "${#TestCase#LOAD}",
                "BenefitCode": "Life",
                "BenefitType": "Life",
                "LoadingPerMille": "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm": "${When i read users' information#Life - Loading term}",
                "isIndexed": "${#TestCase#LIFEINDEX}",
                "CommissionFactor": "${#TestCase#SHEET_COMMISSION}"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="d63155ff-4268-42ad-8781-98d760512465" name="Checking Response">
              <con:configuration>
                <scriptText>def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as float
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as float
def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as float
def _diff = Math.abs(_api_total-_sheet_total) as float
_diff = _diff.round(2)

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff &lt;= tolerance

//try to catch unexpected error message, which should be null
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="c413c8ac-f5f0-44ac-a83a-0a1b2647f74c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Life/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="3f22c020-4404-4834-9b7c-498f1207428e">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.Life.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['selfEmployedGT3Years']}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error</con:name>
              <con:value>${#TestCase#DIFF}</con:value>
            </con:property>
            <con:property>
              <con:name>Sheet PF</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Sheet Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="d702923c-bfc6-4702-8583-3f9f0776bf15">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="And i summarise the result" id="b4ebd067-7669-482b-8fe3-5284b4dad64a">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i highlight the faild cases" id="724ba6a4-add3-4511-a2f3-59f048613cd7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzE3Mjc1Mywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzMxNzYzNTMsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiI3MWU3MGQ5OC05YjFlLTRkZDMtOGFhZC03ZjAxNGE5ZTlhMmEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.H1HtIf4oefb6zEfi5EtVFGjDwyqhMkrJT8cqM8rtLMWWglGintSy7EzGzQg0akJjaU-FBZJJ0ZmVXFrUbVHpKtMvLfAZIpWK7qXMSk2CHpWKipspnXcwukyZdS1HhZWJRm-uDaVQjD5urcX4dFd_S0Y4QD_J7TGhqy9TM3ybgWA</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>02/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>200.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">100.12</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>30</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>100.6</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>106.75</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3f22c020-4404-4834-9b7c-498f1207428e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b95c643c-1436-4627-b72d-a34099c60ad0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="0ddd40e2-f81f-4144-bccb-cfc8fe2b0e5b" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="3feab68e-2097-46fe-a040-3b50ee7b800b">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="30490b0b-23b4-4e74-a756-271a2217e8af">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="20517738-0550-4450-b984-8fcb08734da4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="63bda702-11ae-4cc7-bccd-da8269e2bbe2">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="092b59cd-de94-4997-9dfc-824d86f8db0b">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="0cc577af-8a78-4136-99fa-eee57ba603f3">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/LIFE.xlsx</file>
              <worksheet>LIFE</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>LIFE</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="f73c134c-7a5c-4c9b-977d-da1e3956af25">
        <con:settings/>
        <con:config>
          <script>/*String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Life/And_i_refine_the_data.groovy"
evaluate(new File(file))*/
/********************************************************
Desc:   format API input payload read from the spreadsheet.
Date:   15/04/2018
Author: Wei Huang
********************************************************/

//convert value: NS == No, S == Yes
def smoker = context.expand( '${When i read users\' information#Smoker}' ) as String
//testRunner.testCase.setPropertyValue("SMOKER", (smoker == 'NS') ?  "No" : "Yes")
testRunner.testCase.setPropertyValue("SMOKER", smoker.toString() )
//convert value: 3+years == true, rest == false
def selfEmployed = context.expand( '${When i read users\' information#Self Employed}' ) as String
testRunner.testCase.setPropertyValue("SEGT3", (selfEmployed == '3+ years') ? "true" : "false")
//convert value: M == Monthly, W == Weekly, F == Fortnightly, Y == Annual
def premiumFrequency = context.expand( '${When i read users\' information#Premium Frequency}' ) as String
def pF = ""
switch(premiumFrequency)
{
	case "W":
		pF = "Weekly";
		break;
	case "M":
		pF = "Monthly";
		break;
	case "F":
		pF = "Fortnightly";
		break;
	case "Y":
		pF = "Yearly";
		break;
}
testRunner.testCase.setPropertyValue("FREQUENCY", pF)
//convert value: according to Occupational classes, only 5 is Unemployed
def employedStatus = context.expand( '${When i read users\' information#Occupation Class}' ) as Integer
testRunner.testCase.setPropertyValue("EMPLOYEDSTATUS", (employedStatus == 5) ? "Unemployed" : "Employed")
//convert value: M == Male, F == Female
def gender = context.expand( '${When i read users\' information#Sex}' ) as String
//testRunner.testCase.setPropertyValue("GENDER", (gender == 'M') ? "Male" : "Female")
testRunner.testCase.setPropertyValue("GENDER", gender.toString() )
//convert value: M == Male, F == Female
//testRunner.testCase.setPropertyValue("LIFEINDEX", (context.expand( '${When i read users\' information#Life - Indexing}' ) == 'Y') ? "Indexed" : //"Level")
testRunner.testCase.setPropertyValue("LIFEINDEX", (context.expand( '${When i read users\' information#Life - Indexing}' ) == 'Y') ? "I" : "L")
//convert value: 1 means 100
def lifeLoading = context.expand( '${When i read users\' information#Life - Loading}' ) as Double
testRunner.testCase.setPropertyValue("LOAD", (lifeLoading * 100).toString() )
//convert Premium Opt
//convert Review Term
String _opt = ""
String _term = ""
def lifePremiumOptions = context.expand( '${When i read users\' information#Life - Premium Options}' ) as String
switch(lifePremiumOptions)
{
	case ~/.*Term1-RFA.*/:
		//_opt = "Rate for Age"
		_opt = "R"
		_term = "10"
		break
	case~/.*Term10-.*/:
		//_opt = "10 Year"
		_opt = "10"
		_term = "10"
		break
	case~/.*Term65-.*/:
		//_opt = "To Age 65"
		_opt = "65"
		_term = "65"
		break
	case~/.*Term80-.*/:
		//_opt = "To Age 80"
		_opt = "80"
		_term = "80"
		break
	default:
		_opt = "No Matched Options"
		_term = "No Matched Term"
}
testRunner.testCase.setPropertyValue("PRE_OPT", _opt )
testRunner.testCase.setPropertyValue("REVIEW_TERM", _term )

//Round decimals from the excel (e.g. some excel cells show 0.3 and turn into 0.3000000004 when read sometimes)
def commissionAdjustment = context.expand( '${When i read users\' information#Commission Adjustment}' ) as float
testRunner.testCase.setPropertyValue("SHEET_COMMISSION", (Math.round(commissionAdjustment * 100)).toString())
def life = context.expand( '${When i read users\' information#Life}' ) as float
testRunner.testCase.setPropertyValue("SHEET_LIFE", (life.round(2)).toString())
def polfee = context.expand( '${When i read users\' information#Pol Fee}' ) as float
testRunner.testCase.setPropertyValue("SHEET_PF", (polfee.round(2)).toString())
def total = context.expand( '${When i read users\' information#Total}' ) as float
testRunner.testCase.setPropertyValue("SHEET_TOTAL", (total.round(2)).toString())</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="ff95330c-fdf0-445f-a028-1cf5628f0f34">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "${#TestCase#QUOTENUMBER}",
    "PaymentFrequency": "${#TestCase#FREQUENCY}",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "${#TestCase#FIRSTNAME}",
            "LastName": "${#TestCase#LASTNAME}",
            "Age": "${When i read users' information#Age}",
            "BirthDate": "${#TestCase#THEDATE}",
            "SmokerStatus": "${#TestCase#SMOKER}",
            "Gender": "${#TestCase#GENDER}",
            "OccupationClass": "${When i read users' information#Occupation Class}",
            "EmploymentStatus": "${#TestCase#EMPLOYEDSTATUS}",
            "selfEmployedGT3Years": "${#TestCase#SEGT3}"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "isMain": true,
                "PremiumOption": "${#TestCase#PRE_OPT}",
                "SumAssured": "${When i read users' information#Life Cover}",
                "ReviewTerm": "${#TestCase#REVIEW_TERM}",
                "Load": "${#TestCase#LOAD}",
                "BenefitCode": "Life",
                "BenefitType": "Life",
                "LoadingPerMille": "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm": "${When i read users' information#Life - Loading term}",
                "isIndexed": "${#TestCase#LIFEINDEX}",
                "CommissionFactor": "${#TestCase#SHEET_COMMISSION}"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="d63155ff-4268-42ad-8781-98d760512465" name="Checking Response">
              <con:configuration>
                <scriptText>def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as float
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as float
def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as float
def _diff = Math.abs(_api_total-_sheet_total) as float
_diff = _diff.round(2)

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff &lt;= tolerance

//try to catch unexpected error message, which should be null
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="1d443c06-ff42-47d7-8866-2535b71c0387">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Life/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="3cd54176-ed8a-47fd-a357-691f93c3790a">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.Life.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['selfEmployedGT3Years']}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error</con:name>
              <con:value>${#TestCase#DIFF}</con:value>
            </con:property>
            <con:property>
              <con:name>Sheet PF</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Sheet Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="0c5203dc-0e17-488b-9e48-16023554559e">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="And i summarise the result" id="a616e23d-40a5-4c7f-9675-b4d8de3ec5a1">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i highlight the faild cases" id="ea8ebee9-3b85-43af-bc82-d45d1f2822ed">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzE3ODI4OCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzMxODE4ODgsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiIzM2MzZDU4Zi0yMzcyLTQ0YjctOTM1MC1jMDQwYjQ1YmViZDMiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.fgj-zh8qeF3uMxsCb4GAsGePY6M8Bk57g_hmBhH9Q0CCbc4Xi4tPteRjyHQXvNqHKTUItYoTLNzpr0uPj4TyRvzZjFFgg9qx1umf0LeoBcnln1JffUSxiBXEtCsgS4s7BCTln9lIpkIVr-MZBLIlNGqzlCElszBroPoazXNt7zY</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>02/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value>12345</con:value>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value>John</con:value>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value>DOE</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>258.04</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>264.19</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>START_ROW</con:name>
          <con:value>601</con:value>
        </con:property>
        <con:property>
          <con:name>END_ROW</con:name>
          <con:value>650</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>092b59cd-de94-4997-9dfc-824d86f8db0b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="af862219-a503-46b3-9e23-eb1efe241170" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="65e9b877-17e7-4055-b159-2ab4b5b25e37">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="bba18cf5-493e-46fb-8280-97669e89d5f0">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="f11f1727-b1de-4056-b068-33486bc482ab">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="42869690-122e-4b2e-85b6-584b968b2c75">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="fa00ad70-f6b7-46ef-b87c-b41d127a6b74">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="bf706b95-55c4-41c9-9373-663e28d08f90">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/LIFE.xlsx</file>
              <worksheet>LIFE</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>LIFE</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="01774db6-1348-4a45-a00b-fa78cddbfee6">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Life/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="e9c64780-329a-4016-a5d5-5f15cc3425d5">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "${#TestCase#QUOTENUMBER}",
    "PaymentFrequency": "${#TestCase#FREQUENCY}",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "${#TestCase#FIRSTNAME}",
            "LastName": "${#TestCase#LASTNAME}",
            "Age": "${When i read users' information#Age}",
            "BirthDate": "${#TestCase#THEDATE}",
            "SmokerStatus": "${#TestCase#SMOKER}",
            "Gender": "${#TestCase#GENDER}",
            "OccupationClass": "${When i read users' information#Occupation Class}",
            "EmploymentStatus": "${#TestCase#EMPLOYEDSTATUS}",
            "selfEmployedGT3Years": "${#TestCase#SEGT3}"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "isMain": true,
                "PremiumOption": "${#TestCase#PRE_OPT}",
                "SumAssured": "${When i read users' information#Life Cover}",
                "ReviewTerm": "${#TestCase#REVIEW_TERM}",
                "Load": "${#TestCase#LOAD}",
                "BenefitCode": "Life",
                "BenefitType": "Life",
                "LoadingPerMille": "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm": "${When i read users' information#Life - Loading term}",
                "isIndexed": "${#TestCase#LIFEINDEX}",
                "CommissionFactor": "${#TestCase#SHEET_COMMISSION}"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="d63155ff-4268-42ad-8781-98d760512465" name="Checking Response">
              <con:configuration>
                <scriptText>def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as float
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as float
def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as float
def _diff = Math.abs(_api_total-_sheet_total) as float
_diff = _diff.round(2)

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff &lt;= tolerance

//try to catch unexpected error message, which should be null
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="25596d7a-61e9-4fcc-bd9f-9060a72ad207">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Life/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="7f13e0c5-0e0f-4384-a8b0-a9b77fd58d30">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.Life.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self EmployedGT3</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['selfEmployedGT3Years']}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error</con:name>
              <con:value>${#TestCase#DIFF}</con:value>
            </con:property>
            <con:property>
              <con:name>Sheet PF</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Sheet Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="db05c4e8-15a9-4bfa-80e5-b72709578d9a">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="And i summarise the result" id="2312d183-71a5-4b13-9bb3-23908c822db9">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i highlight the faild cases" id="63a85e82-6c49-4776-a16b-23f71aa06212">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMzMTcyODc1LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMzE3NjQ3NSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6IjEzMTk0N2Q4LTdmNzYtNDdmZi1hYTZkLTdhZDMwZDViNjdiOSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.KbD3ukfdooqUqZWO0YE8pJAnCnBFL3N0_wzzBFSzjb0nOAjJ-SL_6ODFsPwJrDhN5be5P988aYDYzXBTu2U1u95EomGZV6T5FGSrKkbrNEv8OlGFJt0WAGb7Qxo02EeX1ZWQ7_lXN85ROBiZlqsACfBy4h_kCPdoP1YKtBfH4vQ</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>02/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value>12345</con:value>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value>John</con:value>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value>DOE</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>90</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>200.88</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>207.03</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7f13e0c5-0e0f-4384-a8b0-a9b77fd58d30</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>fa00ad70-f6b7-46ef-b87c-b41d127a6b74</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="c8c61069-9333-46be-a6de-a24c6dceed06" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="WoP_10Year(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="073731c9-f12f-44e4-b5dc-f29cb6f5079d">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="94e16e45-27c6-4a54-a97a-f52a638f1e2b">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="e37bf3f6-3ee7-43c1-a07f-ff9d9ddbe840">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="5fe18238-e96a-4bbf-8936-94c3e537e2c0">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="135b918c-e761-418a-9cba-a19c2fddc202">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="573d8a59-83c3-4d28-a3c7-1431e751438c">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>Data/WoP TCMP.xlsx</file>
              <worksheet>10 Year</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life - Business Safeguard Sum Assured</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>LIFE</con:property>
          <con:property>FI</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="8ea5d70d-3b22-49cc-92d9-224dfca2076a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i construct the payload" id="89307ffe-646b-4bc8-9b16-6e5fd9153e18">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_construct_payload.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="5f3228bc-43c4-4d42-b70f-c4be10e239d2">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, WoP">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as float

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def fiPremiumIndex=context.expand( '${#TestCase#FIPREMIUMINDEX}' ) as String
def stPremiumIndex=context.expand( '${#TestCase#STPREMIUMINDEX}' ) as String
def wopPremiumIndex=context.expand( '${#TestCase#WOPPREMIUMINDEX}' ) as String

def fiIndex,stIndex,wopIndex
if(fiPremiumIndex?.trim())
{
 fiIndex=Integer.parseInt(fiPremiumIndex)
}
if(stPremiumIndex?.trim())
{
 stIndex=Integer.parseInt(stPremiumIndex)
}
if(wopPremiumIndex?.trim())
{
 wopIndex=Integer.parseInt(wopPremiumIndex)
}

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+wopIndex+'][\'BenefitPremium\']}' ) as float
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as float
//change it when it comes out!!
def _api_st_child = "0.00" as float
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as float

//Change FI expected value based on the FI option in the data sheet
def _api_fi = "0.00" as float
def _fi_option=context.expand( '${#TestCase#FI}' ) as String

if(_fi_option=='Yes')
{
	_api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+fiIndex+'][\'BenefitPremium\']}' ) as float
}
else
{
	_api_fi = "0.00" as float
}
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as float
//Change S&T expected value based on the S&T option in the data sheet
def _api_st = "0.00" as float
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as float
def _st_option=context.expand( '${#TestCase#S&T}' ) as String
if(_st_option=='Yes')
{
 _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+stIndex+'][\'BenefitPremium\']}' ) as float
}
else
{
	_api_st = "0.00" as float
}

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as float
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as float

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as float
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as float


def _diff_life = Math.abs(_api_life - _sheet_life) as float

def _diff_st = Math.abs(_api_st - _sheet_st) as float
def _diff_wop = Math.abs(_api_wop - _sheet_wop) as float
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as float
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as float
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as float
def _diff_total = Math.abs(_api_total - _sheet_total) as float


_diff_life = _diff_life.round(2)
_diff_wop = _diff_wop.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_fi=_diff_fi.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

if(_frequency=='Yearly')
{
assert _diff_life <= 0.12 && _diff_st <= 0.12 && _diff_st_child <= 0.12 && _diff_wop <= 0.12 && _diff_fi <= 0.12 && _diff_pf <= 0.01
}
else
{
assert _diff_life <= 0.01 && _diff_st <= 0.01 && _diff_st_child <= 0.01 && _diff_wop <= 0.01 && _diff_fi <= 0.01 && _diff_pf <= 0.01
}]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="13862916-c760-422d-8b60-e762b0c48e21">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="76ce2f47-f7f0-411b-8e87-485c3d91df54">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.WoP.TCMP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${#TestCase#WAITINGPERIOD}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>Family</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Future Insurability or Business Safeguard</con:name>
              <con:value>${#TestCase#FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Business Safeguard Sum Assured</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>TCM - S&amp;T</con:name>
              <con:value>${#TestCase#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Child specialist cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Excess discount</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#LOAD_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>65</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${#TestCase#API_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Error</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${#TestCase#API_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Error</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T 
Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${#TestCase#API_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="fce9397a-c5ad-4214-869e-bd93e86adb49">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="71ed89b0-bb4b-4537-bddf-bcf52ce4305e">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="f4deabf7-61af-4343-a8a9-70b98bb21877">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMDE1Mzk2Mywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzAxNTc1NjMsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJjNTUyNDU4Ni02OTljLTRkOGYtYjgwYi05MjI2MTU4NjczNWEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.Yfh2lGjDqEfnzCjtbNKw2zfem1O9FkrDOchJITgQgbdetpACwhgaW8CXn38HzbSVpDCUIFUsS9WSeOcYWyAn91HZIiETDgCJ9xdhQLMNw3EQfD2i5FMpKfW6L-OCO8m93fon_ChjWi3b8FOzsXFuJumWDPBz5vDKYgQsU59rxFo</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>28/06/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Fortnightly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>10 Year</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>80</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>15.61</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>2.84</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>22.29</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value>150.0</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>1.97</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>1.87</con:value>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value>FI</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value>10 Year</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value>3+ years</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",   
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,         
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",  
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",          
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",          
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "ReviewTerm" : "",
                "CompositeCode" : "TCMP_Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,                
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "BenefitType" : "Life",
                "BenefitCode" : "FI",
                "BenefitName" : "Future Insurability Option",
                "isMain": false
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#LOAD_WOP}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitName" : "Waiver of Premium",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          }]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value>2</con:value>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value>6.72</con:value>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value>2</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>135b918c-e761-418a-9cba-a19c2fddc202</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="73ccd8c5-6922-4c0a-a86f-29ea2d23d5ed" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="WoP_RFA(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="0a31bcf4-55ee-4064-b674-6b98822fc9b0">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="a9ed4c6c-f581-4f86-a1bd-023180d3b4a9">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="246a7526-2c86-429f-a94f-906340e8edbf">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="2ccf1ef7-f127-4cc1-9424-0d4959623390">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="21c06c7b-321f-4059-b7cb-900e69631b86">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="3aff564c-f0f6-43fb-aa7d-6933d8a70bdd">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>Data/WoP TCMP.xlsx</file>
              <worksheet>Rate For Age</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life - Business Safeguard Sum Assured</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>LIFE</con:property>
          <con:property>FI</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="c49f81a8-c08a-4503-97ee-9cc3b3009c90">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i construct the payload" id="646f88ae-59d3-44a0-bdb9-e5de0a039aa2">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_construct_payload.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="8a6b9139-cc2e-4436-b9a5-252ed017b96b">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, WoP, FI, S&amp;T and S&amp;T_Child">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def fiPremiumIndex=context.expand( '${#TestCase#FIPREMIUMINDEX}' ) as String
def stPremiumIndex=context.expand( '${#TestCase#STPREMIUMINDEX}' ) as String
def wopPremiumIndex=context.expand( '${#TestCase#WOPPREMIUMINDEX}' ) as String

def fiIndex,stIndex,wopIndex
if(fiPremiumIndex?.trim())
{
 fiIndex=Integer.parseInt(fiPremiumIndex)
}
if(stPremiumIndex?.trim())
{
 stIndex=Integer.parseInt(stPremiumIndex)
}
if(wopPremiumIndex?.trim())
{
 wopIndex=Integer.parseInt(wopPremiumIndex)
}

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+wopIndex+'][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double
//change it when it comes out!!
def _api_st_child = "0.00" as double
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as double

//Change FI expected value based on the FI option in the data sheet
def _api_fi = "0.00" as double
def _fi_option=context.expand( '${#TestCase#FI}' ) as String

if(_fi_option=='Yes')
{
	_api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+fiIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_fi = "0.00" as double
}
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as double
//Change S&T expected value based on the S&T option in the data sheet
def _api_st = "0.00" as double
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as double
def _st_option=context.expand( '${#TestCase#S&T}' ) as String
if(_st_option=='Yes')
{
 _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+stIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_st = "0.00" as double
}

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double


def _diff_life = Math.abs(_api_life - _sheet_life) as double

def _diff_st = Math.abs(_api_st - _sheet_st) as double
def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as double
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_life = _diff_life.round(2)
_diff_wop = _diff_wop.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_fi=_diff_fi.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

if(_frequency=='Yearly')
{
assert _diff_life <= 0.12 && _diff_st <= 0.12 && _diff_st_child <= 0.12 && _diff_wop <= 0.12 && _diff_fi <= 0.12 && _diff_pf <= 0.01
}
else
{
assert _diff_life <= 0.01 && _diff_st <= 0.01 && _diff_st_child <= 0.01 && _diff_wop <= 0.01 && _diff_fi <= 0.01 && _diff_pf <= 0.01
}]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="b76ad3fe-4bd3-4617-8fb2-e4e3d84d3420">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="26bb922e-32cf-4bb0-bd14-d0e81b2dfe76">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.WoP.TCMP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${#TestCase#WAITINGPERIOD}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>Family</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Future Insurability or Business Safeguard</con:name>
              <con:value>${#TestCase#FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Business Safeguard Sum Assured</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>TCM - S&amp;T</con:name>
              <con:value>${#TestCase#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Child specialist cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Excess discount</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#LOAD_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>65</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${#TestCase#API_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Error</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${#TestCase#API_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Error</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T 
Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${#TestCase#API_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="376039cd-7cd3-4c30-a22e-fd65070fef06">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="edfc03c4-27be-41e4-9cea-1059cd903e98">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="77bb3e3b-7a4c-419e-8358-783d1430aaa8">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjMxNjAwMiwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzIzMTk2MDIsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJhMDU5NzI5Yi00M2Y2LTRiNDgtOGRjZC0xMzFlM2QzNGM4MGQiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.D59JKxQZBObZKqUG-1qj_8sVa9s8SszWIbH99mTriHtohzae6qpNWuGjmxMoI8frYgq4G-c7itTarNg5rZymRcJxN43fh5W4tM9uWZNfTzEYOALvJtbj5apwQW60IG7JixBiIANSA7A_SS2oxo3NOADLu4h15wZQgE_pSyczvlk</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>23/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>40</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>108.56</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>163.58</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>41.17</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value>200.0</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>13.85</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value>SpecTest</con:value>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value>530.28</con:value>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value>10 Year</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value>&lt; 3 years</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",   
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,         
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",  
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",          
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",          
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "ReviewTerm" : "",
                "CompositeCode" : "TCMP_Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,                
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "",
                "Load" : "${#TestCase#LOAD_ST}",
                "PremiumOption" : "",
                "ExcessFactor" : "${#TestCase#EXCESS_FACTOR}",
                "ChildCover" : "${#TestCase#CHILD_COVER}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#LOAD_WOP}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitName" : "Waiver of Premium",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          }]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">1</con:value>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value>2</con:value>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value>664.68</con:value>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value>2</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>646f88ae-59d3-44a0-bdb9-e5de0a039aa2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>21c06c7b-321f-4059-b7cb-900e69631b86</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="ed22b408-370a-4e12-9262-427c85370f95" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="WoP_ToAgeX(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="5146aa29-4c99-484f-9025-9669f2ec62a2">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="21466401-3d8b-4f30-a439-c82e58b54715">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="7c7de221-631a-463c-8026-034b3fe8a5f1">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="0af278d0-50e3-4a6a-956a-8b9957fae2a0">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="24bd479c-d245-4fc9-ab45-c936bf1833ec">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="360db904-e913-4662-8304-0ae619b6c12a">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>Data/WoP TCMP.xlsx</file>
              <worksheet>To Age X</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life - Business Safeguard Sum Assured</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>LIFE</con:property>
          <con:property>FI</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="1734ebfb-ff63-4286-8585-df08a79eac6c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i construct the payload" id="ab9203ae-b1a2-4124-b087-c8fa7d3cb128">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_construct_payload.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="123c7573-005e-451d-a3c4-0a37d88586c3">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, WoP">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def fiPremiumIndex=context.expand( '${#TestCase#FIPREMIUMINDEX}' ) as String
def stPremiumIndex=context.expand( '${#TestCase#STPREMIUMINDEX}' ) as String
def wopPremiumIndex=context.expand( '${#TestCase#WOPPREMIUMINDEX}' ) as String

def fiIndex,stIndex,wopIndex
if(fiPremiumIndex?.trim())
{
 fiIndex=Integer.parseInt(fiPremiumIndex)
}
if(stPremiumIndex?.trim())
{
 stIndex=Integer.parseInt(stPremiumIndex)
}
if(wopPremiumIndex?.trim())
{
 wopIndex=Integer.parseInt(wopPremiumIndex)
}

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+wopIndex+'][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double
//change it when it comes out!!
def _api_st_child = "0.00" as double
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as double

//Change FI expected value based on the FI option in the data sheet
def _api_fi = "0.00" as double
def _fi_option=context.expand( '${#TestCase#FI}' ) as String

if(_fi_option=='Yes')
{
	_api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+fiIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_fi = "0.00" as double
}
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as double
//Change S&T expected value based on the S&T option in the data sheet
def _api_st = "0.00" as double
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as double
def _st_option=context.expand( '${#TestCase#S&T}' ) as String
if(_st_option=='Yes')
{
 _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+stIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_st = "0.00" as double
}

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double


def _diff_life = Math.abs(_api_life - _sheet_life) as double

def _diff_st = Math.abs(_api_st - _sheet_st) as double
def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as double
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_life = _diff_life.round(2)
_diff_wop = _diff_wop.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_fi=_diff_fi.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

if(_frequency=='Yearly')
{
assert _diff_life <= 0.12 && _diff_st <= 0.12 && _diff_st_child <= 0.12 && _diff_wop <= 0.12 && _diff_fi <= 0.12 && _diff_pf <= 0.01
}
else
{
assert _diff_life <= 0.01 && _diff_st <= 0.01 && _diff_st_child <= 0.01 && _diff_wop <= 0.01 && _diff_fi <= 0.01 && _diff_pf <= 0.01
}]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="1ef913d0-1f89-4e1a-8ad1-49a985b80d0c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="cf649422-8b52-41d9-a64b-b13a4291ff6d">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.WoP.TCMP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${#TestCase#WAITINGPERIOD}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>Family</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Future Insurability or Business Safeguard</con:name>
              <con:value>${#TestCase#FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Business Safeguard Sum Assured</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>TCM - S&amp;T</con:name>
              <con:value>${#TestCase#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Child specialist cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Excess discount</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#LOAD_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>65</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${#TestCase#API_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Error</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${#TestCase#API_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Error</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T 
Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${#TestCase#API_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="59360497-b0fd-478f-80ba-584ceca5152e">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="9fca5809-293b-4f0c-ab68-a1f84a79b549">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="74d9251d-f7de-493d-bcc5-904a3e42e3f9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjkyMTYwMCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI5MjUyMDAsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJlMjJkYzdlNC05MTUxLTQwZTgtODdhMi1iZmZlZTMzMmQxNmUiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.D0LCjvRGdLLEDbOE1ptdnzjOyK0lolSZKzVJlnEZypfFcGLq7lad-3gHbDYfA2HIKwHPOb4sRQwXbMqnxsN2K5f4Ay42aPVdvMwFhyLGOkgndsIxOlocw-VGpaaercB5HvFJtc8rZKlQ0Kb5LliMsYM-J_HLAdctMv7-0QROyXQ</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>30/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Indexed</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>200.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.12</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>To Age 80</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>80</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>76328.76</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>73.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>81419.4</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>5016.84</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value>SpecTest</con:value>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.12</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value>10 Year</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value>3</con:value>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value>52</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",   
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,         
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",  
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",          
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",          
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "ReviewTerm" : "",
                "CompositeCode" : "TCMP_Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,                
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "",
                "Load" : "${#TestCase#LOAD_ST}",
                "PremiumOption" : "",
                "ExcessFactor" : "${#TestCase#EXCESS_FACTOR}",
                "ChildCover" : "${#TestCase#CHILD_COVER}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#LOAD_WOP}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitName" : "Waiver of Premium",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          }]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">1</con:value>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value>2</con:value>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value>5016.84</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8d612b9e-bab1-4c0f-8197-231773bcd40b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ab9203ae-b1a2-4124-b087-c8fa7d3cb128</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>24bd479c-d245-4fc9-ab45-c936bf1833ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="0f2053a8-57c9-4516-a4b1-363585a85bcf" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="WoP_10Year(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="60477200-dfe3-4904-9633-70aff02d650f">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="a18c59c6-eddd-48a6-a6a8-531e3974c7ac">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="9a88e60f-a81e-4c34-be81-36c5754536ea">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="65af1899-8bbe-4723-9ed5-567a1a5039a0">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="28e4e077-334f-4fca-85a1-215c7e4439b7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="ace88a0c-011e-4a5f-a491-71feaa519b19">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>Data/WoP TCMP.xlsx</file>
              <worksheet>10 Year</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life - Business Safeguard Sum Assured</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>LIFE</con:property>
          <con:property>FI</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="8e05e247-f671-4ccb-9b94-17eadb6f734a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i construct the payload" id="eb26188b-bb58-4bc5-af96-aa470bef969e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_construct_payload.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="7cb5688d-582a-4c9c-8fa0-3b20e99fcd35">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, WoP">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def fiPremiumIndex=context.expand( '${#TestCase#FIPREMIUMINDEX}' ) as String
def stPremiumIndex=context.expand( '${#TestCase#STPREMIUMINDEX}' ) as String
def wopPremiumIndex=context.expand( '${#TestCase#WOPPREMIUMINDEX}' ) as String

def fiIndex,stIndex,wopIndex
if(fiPremiumIndex?.trim())
{
 fiIndex=Integer.parseInt(fiPremiumIndex)
}
if(stPremiumIndex?.trim())
{
 stIndex=Integer.parseInt(stPremiumIndex)
}
if(wopPremiumIndex?.trim())
{
 wopIndex=Integer.parseInt(wopPremiumIndex)
}

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+wopIndex+'][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double
//change it when it comes out!!
def _api_st_child = "0.00" as double
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as double

//Change FI expected value based on the FI option in the data sheet
def _api_fi = "0.00" as double
def _fi_option=context.expand( '${#TestCase#FI}' ) as String

if(_fi_option=='Yes')
{
	_api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+fiIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_fi = "0.00" as double
}
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as double
//Change S&T expected value based on the S&T option in the data sheet
def _api_st = "0.00" as double
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as double
def _st_option=context.expand( '${#TestCase#S&T}' ) as String
if(_st_option=='Yes')
{
 _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+stIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_st = "0.00" as double
}

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double


def _diff_life = Math.abs(_api_life - _sheet_life) as double

def _diff_st = Math.abs(_api_st - _sheet_st) as double
def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as double
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_life = _diff_life.round(2)
_diff_wop = _diff_wop.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_fi=_diff_fi.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

if(_frequency=='Yearly')
{
assert _diff_life <= 0.12 && _diff_st <= 0.12 && _diff_st_child <= 0.12 && _diff_wop <= 0.12 && _diff_fi <= 0.12 && _diff_pf <= 0.01
}
else
{
assert _diff_life <= 0.01 && _diff_st <= 0.01 && _diff_st_child <= 0.01 && _diff_wop <= 0.01 && _diff_fi <= 0.01 && _diff_pf <= 0.01
}]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="1299ac85-d761-468c-88b7-d7f3a1eb4bca">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="fae6e2e0-b500-4c7a-bb5a-ba3f5db15f73">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.WoP.TCMP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${#TestCase#WAITINGPERIOD}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>Family</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Future Insurability or Business Safeguard</con:name>
              <con:value>${#TestCase#FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Business Safeguard Sum Assured</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>TCM - S&amp;T</con:name>
              <con:value>${#TestCase#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Child specialist cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Excess discount</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#LOAD_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>65</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${#TestCase#API_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Error</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${#TestCase#API_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Error</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T 
Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${#TestCase#API_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="0d98d936-465e-4a4e-9b28-bc439bdc3d2d">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="9cc483c7-2028-4c4d-989e-066d1f7f8b1a">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="2b50a3eb-8678-47f2-9ac1-01cbf27ec1d0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUyOTYxOTY5Niwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1Mjk2MjMyOTYsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJjNGU1MTBhMC02NGViLTRhOTEtYWUwOC1lYzc2MzdjMGE3OWIiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.Q0RdcNkFpZTpmhLydc9fzKQeTHf60E330m-zZt5OtLWTwtisV8U0nhqLjVu-D08vKDggXLelrZK3qiqF0CBSCPFjq-F9UoxaGhgCPZ5tI7uBIH_K4tc7KzMKV-aEwF62ofCQ_VnXqS_6k-ViN63zGwIQEAY9wjNbVbr74ObaV1c</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>22/06/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Female</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Indexed</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>10 Year</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>30</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>1543.56</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>73.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>1703.88</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>86.52</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>3.84</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>3.84</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value>10 Year</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value>&lt; 3 years</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>eb26188b-bb58-4bc5-af96-aa470bef969e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>28e4e077-334f-4fca-85a1-215c7e4439b7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="0aa0c5b1-6040-4772-af56-c248fca003ae" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="WoP_RFA(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="424e172f-d8b8-463f-b656-cfb875c829ff">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="eddb39ff-c79c-4b09-9ba7-f9b3838207c5">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="0db358d9-eeb0-4218-af47-cd0bf6b4bb69">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="4600bc87-9a10-4c28-b2a0-05e66ac5a593">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="4ce20a5a-3b48-4ac5-8277-515ec908ad3d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="e25b8755-d21f-4941-b268-8c6893ddffdb">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>Data/WoP TCMP.xlsx</file>
              <worksheet>Rate For Age</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life - Business Safeguard Sum Assured</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>LIFE</con:property>
          <con:property>FI</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="c44e4f8a-8cd7-4f28-aedf-c57ac236256e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i construct the payload" id="a94d9356-a670-44ef-a940-43e5988da933">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_construct_payload.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="881f54e5-dc39-46c4-bdd6-709ee2802bdd">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, WoP, FI, S&amp;T and S&amp;T_Child">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def fiPremiumIndex=context.expand( '${#TestCase#FIPREMIUMINDEX}' ) as String
def stPremiumIndex=context.expand( '${#TestCase#STPREMIUMINDEX}' ) as String
def wopPremiumIndex=context.expand( '${#TestCase#WOPPREMIUMINDEX}' ) as String

def fiIndex,stIndex,wopIndex
if(fiPremiumIndex?.trim())
{
 fiIndex=Integer.parseInt(fiPremiumIndex)
}
if(stPremiumIndex?.trim())
{
 stIndex=Integer.parseInt(stPremiumIndex)
}
if(wopPremiumIndex?.trim())
{
 wopIndex=Integer.parseInt(wopPremiumIndex)
}

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+wopIndex+'][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double
//change it when it comes out!!
def _api_st_child = "0.00" as double
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as double

//Change FI expected value based on the FI option in the data sheet
def _api_fi = "0.00" as double
def _fi_option=context.expand( '${#TestCase#FI}' ) as String

if(_fi_option=='Yes')
{
	_api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+fiIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_fi = "0.00" as double
}
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as double
//Change S&T expected value based on the S&T option in the data sheet
def _api_st = "0.00" as double
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as double
def _st_option=context.expand( '${#TestCase#S&T}' ) as String
if(_st_option=='Yes')
{
 _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+stIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_st = "0.00" as double
}

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double


def _diff_life = Math.abs(_api_life - _sheet_life) as double

def _diff_st = Math.abs(_api_st - _sheet_st) as double
def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as double
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_life = _diff_life.round(2)
_diff_wop = _diff_wop.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_fi=_diff_fi.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

if(_frequency=='Yearly')
{
assert _diff_life <= 0.12 && _diff_st <= 0.12 && _diff_st_child <= 0.12 && _diff_wop <= 0.12 && _diff_fi <= 0.12 && _diff_pf <= 0.01
}
else
{
assert _diff_life <= 0.01 && _diff_st <= 0.01 && _diff_st_child <= 0.01 && _diff_wop <= 0.01 && _diff_fi <= 0.01 && _diff_pf <= 0.01
}]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="05516d25-989a-4735-8a7e-63b4df002719">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="d6377160-4dfc-4b0f-958a-fa07c34079ba">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.WoP.TCMP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${#TestCase#WAITINGPERIOD}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>Family</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Future Insurability or Business Safeguard</con:name>
              <con:value>${#TestCase#FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Business Safeguard Sum Assured</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>TCM - S&amp;T</con:name>
              <con:value>${#TestCase#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Child specialist cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Excess discount</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#LOAD_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>65</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${#TestCase#API_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Error</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${#TestCase#API_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Error</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T 
Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${#TestCase#API_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="9d0f140d-2b64-4f5e-8d95-fd48a33460df">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="fd71f522-6bd4-4cf2-8c30-bd5ec1cb4abd">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="e3db7b99-1067-4938-a63f-1ae40c7530ea">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyMzE2MTMyLCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjMxOTczMiwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImI0NTcyNThiLWFkOTktNGUyNi1iMDZkLTc3YzdiMjgxYWQ1NCIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.gycC1pqOs4fwSZfbap6ZUjsLJwa76X4H4HplRc-vyzbYb74h8X_N5xH0WHWDr_-MbJzQwbgI_rWzDixClyzEyPmbqvdBP-WedsOF-gHqiY6woAIQp6UvAEad9qOzBr53hfDGIa4I8zWuTmRQnt_n5MnU8ESmqmWfN3U8j2nILdg</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>23/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>200.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>30</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>186.34</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>213.43</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>15.2</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>300</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>11.89</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value>SpecTest</con:value>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value>10 Year</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value>2</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",   
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,         
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",  
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",          
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",          
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "ReviewTerm" : "",
                "CompositeCode" : "TCMP_Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,                
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "",
                "Load" : "${#TestCase#LOAD_ST}",
                "PremiumOption" : "",
                "ExcessFactor" : "${#TestCase#EXCESS_FACTOR}",
                "ChildCover" : "${#TestCase#CHILD_COVER}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#LOAD_WOP}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitName" : "Waiver of Premium",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          }]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">1</con:value>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value>2</con:value>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value>18.84</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a94d9356-a670-44ef-a940-43e5988da933</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4ce20a5a-3b48-4ac5-8277-515ec908ad3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="1c102582-86e2-490c-9b05-a40d44ed3628" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="WoP_ToAgeX(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="edf5ce4b-9d83-443d-8b76-4b5a2f0164da">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="0bffd07f-56eb-48fb-bd94-cf833f4911d0">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="57194935-059e-4949-b8a2-d8659019096a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="a93173c6-1bb6-4778-a975-1c5c65517970">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="debb3a38-9434-41a5-8634-0970dfa3dbdc">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="d1346edd-d0ee-43dd-8260-4cb744cadb73">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>Data/WoP TCMP.xlsx</file>
              <worksheet>To Age X</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life - Business Safeguard Sum Assured</con:property>
          <con:property>TCM - S&amp;T</con:property>
          <con:property>TCM Health - Loading</con:property>
          <con:property>TCM Health - Child specialist cover</con:property>
          <con:property>TCM Health - Excess discount</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>LIFE</con:property>
          <con:property>FI</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>S&amp;T Child</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="f9be8fbe-35ea-4c40-b222-2a3de21e4608">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i construct the payload" id="e9f5411b-c912-40fc-bff8-04df11927bed">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_construct_payload.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="0f4a5549-4e8c-411b-861c-816578393921">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Life, WoP">
              <con:configuration>
                <scriptText><![CDATA[def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def fiPremiumIndex=context.expand( '${#TestCase#FIPREMIUMINDEX}' ) as String
def stPremiumIndex=context.expand( '${#TestCase#STPREMIUMINDEX}' ) as String
def wopPremiumIndex=context.expand( '${#TestCase#WOPPREMIUMINDEX}' ) as String

def fiIndex,stIndex,wopIndex
if(fiPremiumIndex?.trim())
{
 fiIndex=Integer.parseInt(fiPremiumIndex)
}
if(stPremiumIndex?.trim())
{
 stIndex=Integer.parseInt(stPremiumIndex)
}
if(wopPremiumIndex?.trim())
{
 wopIndex=Integer.parseInt(wopPremiumIndex)
}

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+wopIndex+'][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double
//change it when it comes out!!
def _api_st_child = "0.00" as double
def _sheet_st_child = context.expand( '${#TestCase#SHEET_ST_CHILD}' ) as double

//Change FI expected value based on the FI option in the data sheet
def _api_fi = "0.00" as double
def _fi_option=context.expand( '${#TestCase#FI}' ) as String

if(_fi_option=='Yes')
{
	_api_fi = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+fiIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_fi = "0.00" as double
}
def _sheet_fi = context.expand( '${#TestCase#SHEET_FI}' ) as double
//Change S&T expected value based on the S&T option in the data sheet
def _api_st = "0.00" as double
def _sheet_st = context.expand( '${#TestCase#SHEET_ST}' ) as double
def _st_option=context.expand( '${#TestCase#S&T}' ) as String
if(_st_option=='Yes')
{
 _api_st = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+stIndex+'][\'BenefitPremium\']}' ) as double
}
else
{
	_api_st = "0.00" as double
}

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double


def _diff_life = Math.abs(_api_life - _sheet_life) as double

def _diff_st = Math.abs(_api_st - _sheet_st) as double
def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_st_child = Math.abs(_api_st_child - _sheet_st_child) as double
def _diff_fi = Math.abs(_api_fi - _sheet_fi) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_life = _diff_life.round(2)
_diff_wop = _diff_wop.round(2)
_diff_st = _diff_st.round(2)
_diff_st_child = _diff_st_child.round(2)
_diff_fi=_diff_fi.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

if(_frequency=='Yearly')
{
assert _diff_life <= 0.12 && _diff_st <= 0.12 && _diff_st_child <= 0.12 && _diff_wop <= 0.12 && _diff_fi <= 0.12 && _diff_pf <= 0.01
}
else
{
assert _diff_life <= 0.01 && _diff_st <= 0.01 && _diff_st_child <= 0.01 && _diff_wop <= 0.01 && _diff_fi <= 0.01 && _diff_pf <= 0.01
}]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="06f93e6c-766f-4f52-a134-f6ec1fe1eccf">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/WoP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="39e6c78a-dba2-42e0-b3bd-e5cffbf1a3e8">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.WoP.TCMP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][3]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>Family</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Future Insurability or Business Safeguard</con:name>
              <con:value>${#TestCase#FI}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Business Safeguard Sum Assured</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>TCM - S&amp;T</con:name>
              <con:value>${#TestCase#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Loading</con:name>
              <con:value>${#TestCase#LOAD_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Child specialist cover</con:name>
              <con:value>${#TestCase#CHILD_COVER}</con:value>
            </con:property>
            <con:property>
              <con:name>TCM Health - Excess discount</con:name>
              <con:value>${#TestCase#EXCESS_FACTOR}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#LOAD_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>65</con:value>
            </con:property>
            <con:property>
              <con:name>Life</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API Life</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>FI</con:name>
              <con:value>${#TestCase#SHEET_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>API FI</con:name>
              <con:value>${#TestCase#API_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Error</con:name>
              <con:value>${#TestCase#DIFF_FI}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${#TestCase#SHEET_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T</con:name>
              <con:value>${#TestCase#API_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Error</con:name>
              <con:value>${#TestCase#DIFF_ST}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T 
Child</con:name>
              <con:value>${#TestCase#SHEET_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>API S&amp;T Child</con:name>
              <con:value>N/A</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T Child Error</con:name>
              <con:value>${#TestCase#DIFF_ST_CHILD}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${#TestCase#API_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="a1868029-09cb-4274-95dd-ab311963a959">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="36615de9-1794-491e-be32-a86d2e4061f0">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="abd23a57-f852-4bf4-a0e7-87945819825c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMwMjE1NTY0LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMDIxOTE2NCwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImE1NTVjMjRjLTQyOTEtNGNmZi1hZjgzLTAyOTIwNGI3N2FmMSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.hevbv6YlEvYIr4VKYQQe6Tgg1hqGyfPOYpoJGNCIWwXWRbFQxuWzwU_TePlEFUVYG-R5BOW8yEI4nJOrcZqZiZBZahxdKDSsxnjLjM4vACi3o29OL1T91FaQ-Q4A9Cis7Q-aX4W3Tf_KzbxmAotDUYR5zpeXqO7Y-fjBhkhvtew</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>29/06/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>INVALID</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>To Age 65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>80</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>846.6</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>1019.04</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value>true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>172.44</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>6.84</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>6.84</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value>10 Year</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value>2</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",   
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,         
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",  
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",          
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",          
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "LoadingTerm" : "${When i read users' information#Life - Loading term}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "SumAssured" : "${When i read users' information#Life Cover}",
                "ReviewTerm" : "",
                "CompositeCode" : "TCMP_Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,                
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Life",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#LOAD_WOP}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitName" : "Waiver of Premium",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          }]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value>1</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8d612b9e-bab1-4c0f-8197-231773bcd40b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9f5411b-c912-40fc-bff8-04df11927bed</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>debb3a38-9434-41a5-8634-0970dfa3dbdc</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="5f92acef-db13-485c-a437-3491d05ba6a9" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="HealthWaiver(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="9ffac9b4-6e33-4f53-98d5-fa6eaa98a76f">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="de7b7814-1cab-4251-972d-6df52db35df7">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="d043a831-3d37-4ac4-a48a-1f22bca2a6c3">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="11bed858-def9-4e51-bfb1-e040646480ce">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="c0fd1196-a901-4084-b5f6-b91bbf685a1e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="3f472693-925c-476f-b4c3-f7d3d1cb53f9">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/Health.xlsx</file>
              <worksheet>Health</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>PH - Loading</con:property>
          <con:property>PH - Excess</con:property>
          <con:property>PH - Specialist cover</con:property>
          <con:property>PH - Specialist Excess</con:property>
          <con:property>Health Premium Waiver</con:property>
          <con:property>PWH - Wait</con:property>
          <con:property>PWH - Loading</con:property>
          <con:property>PWH - Term</con:property>
          <con:property>Plus-Loading</con:property>
          <con:property>Health Base</con:property>
          <con:property>Health Plus</con:property>
          <con:property>Health Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="439a3f75-369d-4f14-982d-b507449d6637">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Health/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="979c936c-add5-41d6-9876-bab23c817542">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Premium">
              <con:configuration>
                <scriptText><![CDATA[float _api_health = 0.0
float _api_health_plus = 0.0
float _api_health_waiver = 0.0
float _sheet_health = 0.0
float _sheet_health_waiver = 0.0
float _diff_health = 0.0
float _diff_health_plus = 0.0
float _diff_health_waiver = 0.0
int _wop_index=2

_api_health = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
_sheet_health = context.expand( '${#TestCase#SHEET_HEALTH}' ) as float
_diff_health = Math.abs(_api_health - _sheet_health).round(2)

if ( context.expand( '${When i read users\' information#PH - Specialist cover}' ) == 'Y' ) 
{
	_api_health_plus = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
	_sheet_health_plus = context.expand( '${#TestCase#SHEET_HEALTH_PLUS}' ) as float
	_diff_health_plus = Math.abs(_api_health_plus - _sheet_health_plus).round(2)
}
if ( context.expand( '${When i read users\' information#PH - Specialist cover}' ) == 'N' && context.expand( '${When i read users\' information#Health Premium Waiver}' ) == 'Y') 
{
	_wop_index=1
}
if ( context.expand( '${When i read users\' information#Health Premium Waiver}' ) == 'Y' )
{
	_api_health_waiver = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+_wop_index+'][\'BenefitPremium\']}' ) as float
	_sheet_health_waiver = context.expand( '${#TestCase#SHEET_HEALTH_WAIVER}' ) as float
	_diff_health_waiver = Math.abs(_api_health_waiver - _sheet_health_waiver).round(2)
}

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as float
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as float

def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
_diff_pf=_diff_pf.round(2)

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01
assert _diff_health <= tolerance && _diff_health_plus <= tolerance && _diff_health_waiver <= tolerance && _diff_pf <=0.01
//try to catch unexpected error message, which should be null or empty string
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="91378e1a-b31d-451c-8ec9-22bf15231d0a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Health/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="80b8de35-a915-409f-b9a9-2a37c4992f6c">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.Health.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed GT3</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['selfEmployedGT3Years']}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Excess</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['ExcessFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Specialist cover</con:name>
              <con:value>${When i read users' information#PH - Specialist cover}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Specialist Excess</con:name>
              <con:value>${When i read users' information#PH - Specialist Excess}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Premium Waiver</con:name>
              <con:value>${When i read users' information#Health Premium Waiver}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Wait</con:name>
              <con:value>${When i read users' information#PWH - Wait}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Loading</con:name>
              <con:value>${#TestCase#PWH_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Term</con:name>
              <con:value>${#TestCase#PWH_TERM}</con:value>
            </con:property>
            <con:property>
              <con:name>Plus-Loading</con:name>
              <con:value>${#TestCase#PLUS_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Base</con:name>
              <con:value>${#TestCase#SHEET_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Plus</con:name>
              <con:value>${#TestCase#SHEET_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health Plus</con:name>
              <con:value>${#TestCase#API_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Plus Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Waiver</con:name>
              <con:value>${#TestCase#SHEET_HEALTH_WAIVER}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health Waiver</con:name>
              <con:value>${#TestCase#API_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH_WAIVER}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${When i read users' information#Pol Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Toatl</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="ba4ac3bc-1a06-4d41-b8a6-045b5bd57bd9">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="b9e99929-76a5-4d4a-9f2f-0d2aa97b6312">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}.Summary-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="1204802f-f5a2-4e84-85a0-c4060b445314">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzUxODU5Nywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM1MjIxOTcsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI2Mzc1N2M2Ny05YmJhLTRjZjgtOTk3ZS04ZTYyMGEzZDc0YjUiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.hRTHxD-M4xJdTzYUUZzRM5kMQInl4J18Xws0K4-JB2102Da2GaHNsFtgVqPEP8kSb859xii1hGrL8f97JCFfSdMMVd6QjZxCOK2JqUkUxu6r_SL1PRE69AY3xLxL9e6xRXgtChFDA571efrtWK5tvTVko5Zu2M1USb8LBNuQGB0</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>06/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>100</con:value>
        </con:property>
        <con:property>
          <con:name>HAS_WAIVER_POLICY_FEE</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOY_STATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>PH_LOAD</con:name>
          <con:value>100</con:value>
        </con:property>
        <con:property>
          <con:name>PWH_LOAD</con:name>
          <con:value>30</con:value>
        </con:property>
        <con:property>
          <con:name>PWH_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>PLUS_LOAD</con:name>
          <con:value>100</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH</con:name>
          <con:value>128.44</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH_PLUS</con:name>
          <con:value>53.59</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH_WAIVER</con:name>
          <con:value>3.99</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>192.17</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "PrvtHlthPolicyFee" : "${#TestCase#HAS_WAIVER_POLICY_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years": "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOY_STATUS}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ 
              {
                "ExcessFactor" : "${When i read users' information#PH - Excess}",
                "Load" : "${#TestCase#PH_LOAD}",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "BenefitCategory" : "Health",
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}",
                "selfEmployedGT3Years": "${#TestCase#SEGT3}"
              }, 
              {
                "CompositeCode" : "PrvtHlth_HlthPls",
                "BenefitCode" : "HlthPls",
                "BenefitDescription" : "Health Plus",
                "BenefitName" : "Health Plus",
                "Load" : "${#TestCase#PLUS_LOAD}",
                "ExcessFactor" : "${When i read users' information#PH - Specialist Excess}",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Hlth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "HlthPls",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}",
                "selfEmployedGT3Years": "${#TestCase#SEGT3}"
              },
              {
                "BenefitDescription" : "Health Waiver of Premium",
                "BenefitName" : "Health Waiver of Premium",
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "isMain" : false,
                "PaymentPeriod" : "",
                "isIndexed" : "",
                "Load" : "${#TestCase#PWH_LOAD}",
                "WaitingPeriod" : "${When i read users' information#PWH - Wait}",
                "SumAssured" : "",
                "BenefitTerm" : "${#TestCase#PWH_TERM}",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ 
			   {
                    "BenefitCode" : "Hlth"
                  }]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}",
                "selfEmployedGT3Years": "${#TestCase#SEGT3}"
              }]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH_WAIVER</con:name>
          <con:value>0.01</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value>3.0</con:value>
        </con:property>
        <con:property>
          <con:name>API_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c0fd1196-a901-4084-b5f6-b91bbf685a1e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="f90f7faf-63b9-449b-a1f1-993b640004d8" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="HealthWaiver(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="21808a36-503f-46ae-8361-b7f21ca8647b">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="ecc64aa8-d95f-45b6-a90d-f5d99a48f067">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="63aaa105-4ecc-4a4e-8466-7181b7ba348e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="f71b3383-bec8-44c6-a1eb-aeda0a5c2b4b">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="92cdaa0d-68f5-40e7-afaf-e0ba441d27c2">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="ba168659-06ed-4505-b9f4-7378af95e5f3">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/Health.xlsx</file>
              <worksheet>Health</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>PH - Loading</con:property>
          <con:property>PH - Excess</con:property>
          <con:property>PH - Specialist cover</con:property>
          <con:property>PH - Specialist Excess</con:property>
          <con:property>Health Premium Waiver</con:property>
          <con:property>PWH - Wait</con:property>
          <con:property>PWH - Loading</con:property>
          <con:property>PWH - Term</con:property>
          <con:property>Plus-Loading</con:property>
          <con:property>Health Base</con:property>
          <con:property>Health Plus</con:property>
          <con:property>Health Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="05406424-c8f3-4710-b9a8-f367e31652bd">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Health/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="010dd2b1-a99e-475e-80bf-b0ba1b842cd8">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking Premium">
              <con:configuration>
                <scriptText><![CDATA[float _api_health = 0.0
float _api_health_plus = 0.0
float _api_health_waiver = 0.0
float _sheet_health = 0.0
float _sheet_health_waiver = 0.0
float _diff_health = 0.0
float _diff_health_plus = 0.0
float _diff_health_waiver = 0.0
int _wop_index=2

_api_health = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as float
_sheet_health = context.expand( '${#TestCase#SHEET_HEALTH}' ) as float
_diff_health = Math.abs(_api_health - _sheet_health).round(2)

if ( context.expand( '${When i read users\' information#PH - Specialist cover}' ) == 'Y' ) 
{
	_api_health_plus = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as float
	_sheet_health_plus = context.expand( '${#TestCase#SHEET_HEALTH_PLUS}' ) as float
	_diff_health_plus = Math.abs(_api_health_plus - _sheet_health_plus).round(2)
}
if ( context.expand( '${When i read users\' information#PH - Specialist cover}' ) == 'N' && context.expand( '${When i read users\' information#Health Premium Waiver}' ) == 'Y') 
{
	_wop_index=1
}
if ( context.expand( '${When i read users\' information#Health Premium Waiver}' ) == 'Y' )
{
	_api_health_waiver = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\']['+_wop_index+'][\'BenefitPremium\']}' ) as float
	_sheet_health_waiver = context.expand( '${#TestCase#SHEET_HEALTH_WAIVER}' ) as float
	_diff_health_waiver = Math.abs(_api_health_waiver - _sheet_health_waiver).round(2)
}

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as float
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as float

def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
_diff_pf=_diff_pf.round(2)

float tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01
assert _diff_health <= tolerance && _diff_health_plus <= tolerance && _diff_health_waiver <= tolerance && _diff_pf <=0.01
//try to catch unexpected error message, which should be null or empty string
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="a7162fee-0046-4c35-92bb-5d5605e8a9c7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/Health/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="2f827207-d834-4b97-8aa8-2e214004fdde">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Pricing.Health.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed GT3</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['selfEmployedGT3Years']}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Excess</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['ExcessFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Specialist cover</con:name>
              <con:value>${When i read users' information#PH - Specialist cover}</con:value>
            </con:property>
            <con:property>
              <con:name>PH - Specialist Excess</con:name>
              <con:value>${When i read users' information#PH - Specialist Excess}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Premium Waiver</con:name>
              <con:value>${When i read users' information#Health Premium Waiver}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Wait</con:name>
              <con:value>${When i read users' information#PWH - Wait}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Loading</con:name>
              <con:value>${#TestCase#PWH_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>PWH - Term</con:name>
              <con:value>${#TestCase#PWH_TERM}</con:value>
            </con:property>
            <con:property>
              <con:name>Plus-Loading</con:name>
              <con:value>${#TestCase#PLUS_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Base</con:name>
              <con:value>${#TestCase#SHEET_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Plus</con:name>
              <con:value>${#TestCase#SHEET_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health Plus</con:name>
              <con:value>${#TestCase#API_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Plus Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH_PLUS}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Waiver</con:name>
              <con:value>${#TestCase#SHEET_HEALTH_WAIVER}</con:value>
            </con:property>
            <con:property>
              <con:name>API Health Waiver</con:name>
              <con:value>${#TestCase#API_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Health Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_HEALTH_WAIVER}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${When i read users' information#Pol Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Toatl</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="5f1a32fe-599b-4737-8fef-6fc3b1bdc125">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="9d6a01ca-fa4d-431e-9658-004bc2d1e3cd">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}.Summary-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="d7232d91-0b7a-45b5-a8a3-5c71b6ef2594">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMzNTE3OTU5LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMzUyMTU1OSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6IjkyNzc2YjQ4LTNhNjMtNGQxMy1hNGI1LWQyZTI1Y2QzZDdjOCIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.eQomr4cbd-SozArrmeLm8mlaHd-MT_bXQ0zulBuFNuwPnfNTb06UXt5FpfVnGPozm9nRSO_HYGd2tRvK6JfIYA_lzJZg4pCEyhy82EbETrP0AwBzYi8ogj4A7K-dz7RdfqERE2bTH_igsK3RGMubKlz466v6od0gm2GCkR9SIow</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>06/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Weekly</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>20</con:value>
        </con:property>
        <con:property>
          <con:name>HAS_WAIVER_POLICY_FEE</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOY_STATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>PH_LOAD</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>PWH_LOAD</con:name>
          <con:value>90</con:value>
        </con:property>
        <con:property>
          <con:name>PWH_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>PLUS_LOAD</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH</con:name>
          <con:value>11.56</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_HEALTH_WAIVER</con:name>
          <con:value>0.28</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>1.42</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>13.26</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "PrvtHlthPolicyFee" : "${#TestCase#HAS_WAIVER_POLICY_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years": "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOY_STATUS}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ 
              {
                "ExcessFactor" : "${When i read users' information#PH - Excess}",
                "Load" : "${#TestCase#PH_LOAD}",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "BenefitCategory" : "Health",
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}",
                "selfEmployedGT3Years": "${#TestCase#SEGT3}"
              },
              {
                "BenefitDescription" : "Health Waiver of Premium",
                "BenefitName" : "Health Waiver of Premium",
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "isMain" : false,
                "PaymentPeriod" : "",
                "isIndexed" : "",
                "Load" : "${#TestCase#PWH_LOAD}",
                "WaitingPeriod" : "${When i read users' information#PWH - Wait}",
                "SumAssured" : "",
                "BenefitTerm" : "${#TestCase#PWH_TERM}",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ 
			   {
                    "BenefitCode" : "Hlth"
                  }]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}",
                "selfEmployedGT3Years": "${#TestCase#SEGT3}"
              }]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_HEALTH_WAIVER</con:name>
          <con:value>0.68</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>API_HEALTH_PLUS</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>92cdaa0d-68f5-40e7-afaf-e0ba441d27c2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="253e05e4-e63e-4268-9280-04ecb449980a" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="SCLA(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="9f32ef45-9c92-4847-8c43-1cf0cdb08813">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="a8954fd1-6396-4620-875c-25ad60e50886">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="15e6da01-28e5-46ba-8ef0-b4b5d1c7fd90">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="871abe95-fb8e-436d-bf21-dfc3ab329137">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="ce0ebc90-028f-41d3-b2e8-b079acbe7578">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="3aace53d-d728-44c3-9f6e-bf2013b45e02">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/SCLA.xlsx</file>
              <worksheet>SCLA</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>LAB - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Living Assurance - SA</con:property>
          <con:property>LAB - SA Index</con:property>
          <con:property>LAB - Loading</con:property>
          <con:property>LAB - Per Mille Loading $</con:property>
          <con:property>LAB - Per Mille Loading term</con:property>
          <con:property>LAB - Buyback Discount</con:property>
          <con:property>SLAB</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="c6a972d0-2f04-4bab-81e8-d18c29333a10">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/SCLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="1578d795-5293-4e40-a2f5-0473817840f7">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {         
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",            
            "OccupationClass" : "${When i read users' information#Occupation Class}",               
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",          
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "LoadingPerMille" : "${When i read users' information#LAB - Per Mille Loading $}",
                "LoadingTerm" : "${When i read users' information#LAB - Per Mille Loading term}",
                "Load" : "${#TestCase#LOAD}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "LivingBuybackDiscount" : "${#TestCase#BUYBACK_DISCOUNT}",               
                "MaxInstancesOfBenefit" : "3",
                "LinkType" : "S",
                "isAvailable" : true,
                "SortOrder" : "5",
                "isMain" : true,
                "BenefitDescription" : "Living Assurance",
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitName" : "Living Assurance",
                "SumAssured" : "${When i read users' information#Living Assurance - SA}",
                "isIndexed" : "${#TestCase#SCLAINDEX}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking SCLA" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText>def _api_scla = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_scla = context.expand( '${#TestCase#SHEET_SCLA}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_scla = Math.abs(_api_scla - _sheet_scla) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_scla = _diff_scla.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_scla &lt;= tolerance &amp;&amp; _diff_pf &lt;= 0.01
//try to catch unexpected error message, which should be null
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="b333516d-16c5-4c1a-ba2c-0c6f5915d7a1">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/SCLA/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="9aab9f92-aae1-4541-8ecb-ca336ba923de">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.SCLA.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Living Assurance - SA</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - SA Index</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading $</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Buyback Discount</con:name>
              <con:value>${#TestCase#BUYBACK_DISCOUNT}</con:value>
            </con:property>
            <con:property>
              <con:name>SLAB</con:name>
              <con:value>${#TestCase#SHEET_SCLA}</con:value>
            </con:property>
            <con:property>
              <con:name>API SLAB</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>SLAB Error</con:name>
              <con:value>${#TestCase#DIFF_SCLA}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>UnexpectedError</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="bfed4bdc-9d0e-4ba0-b5c2-9feaa36cf2a9">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="0c0d70f4-9549-4c08-945f-ee0575bd27bb">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="568134dd-1535-4d3e-a287-96a6da47144a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzE3NjU5NSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzMxODAxOTUsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJlYjQzNmVjOC0xNDJiLTRjOWEtYjlkNi03ODAyNzRhOTg2ZmQiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.MsGrCu9Xa4i3WHjdrMMzp5t6sotVB_4CAlPLy5h29Z40PSDGuQLLpMegtHVsd2jPNlla0H0UUrB6jBU219QtovrVjANv4qZONivw50KdSYZiKuvfLpF6vNM903t1-_b2GFRMa22zs64l9aIa3q82gP3iViYvVO4de5Wu350keUA</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>02/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Weekly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>61.28</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>54.43</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>539825</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>27.03</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SLAB</con:name>
          <con:value>470.28</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SCLA</con:name>
          <con:value>61.28</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SCLA</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e44e1505-5a5b-48b9-a76f-efb2a39dcd3a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ce0ebc90-028f-41d3-b2e8-b079acbe7578</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="d2f59067-088f-4579-9d85-e0165cfd7810" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="SCLA(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="3c9ad416-f216-414c-910f-4124567db506">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="e39bb6d1-b27f-4da5-8bc8-5069939c5dce">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="6a3e1ec9-f86e-4690-bf18-9255e4d271d1">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="06b216b3-c5e7-40dd-a7b6-ff1594239274">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="728eb8d7-5bc2-4cd9-afcd-36c69c1f66cc">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="8f20912a-dab9-4950-8d22-11abd3eccbea">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/SCLA.xlsx</file>
              <worksheet>SCLA</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>LAB - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Living Assurance - SA</con:property>
          <con:property>LAB - SA Index</con:property>
          <con:property>LAB - Loading</con:property>
          <con:property>LAB - Per Mille Loading $</con:property>
          <con:property>LAB - Per Mille Loading term</con:property>
          <con:property>LAB - Buyback Discount</con:property>
          <con:property>SLAB</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="e3480406-810f-4ab5-9b06-ce0dd710201c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/SCLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="6363ef4c-d8d9-4d16-bcf2-37dd99f98f21">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {         
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",            
            "OccupationClass" : "${When i read users' information#Occupation Class}",               
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",          
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "LoadingPerMille" : "${When i read users' information#LAB - Per Mille Loading $}",
                "LoadingTerm" : "${When i read users' information#LAB - Per Mille Loading term}",
                "Load" : "${#TestCase#LOAD}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "LivingBuybackDiscount" : "${#TestCase#BUYBACK_DISCOUNT}",               
                "MaxInstancesOfBenefit" : "3",
                "LinkType" : "S",
                "isAvailable" : true,
                "SortOrder" : "5",
                "isMain" : true,
                "BenefitDescription" : "Living Assurance",
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitName" : "Living Assurance",
                "SumAssured" : "${When i read users' information#Living Assurance - SA}",
                "isIndexed" : "${#TestCase#SCLAINDEX}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking SCLA" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText>def _api_scla = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_scla = context.expand( '${#TestCase#SHEET_SCLA}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_scla = Math.abs(_api_scla - _sheet_scla) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_scla = _diff_scla.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_scla &lt;= tolerance &amp;&amp; _diff_pf &lt;= 0.01
//try to catch unexpected error message, which should be null
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="1151eb42-d223-4017-a2d2-fa19e7c1f8b9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/SCLA/And_i_compare_results.groovy"
evaluate(new File(file))

def response = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="f370db17-79a9-4035-a572-4bc39fc83697">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.SCLA.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Living Assurance - SA</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - SA Index</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading $</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Buyback Discount</con:name>
              <con:value>${#TestCase#BUYBACK_DISCOUNT}</con:value>
            </con:property>
            <con:property>
              <con:name>SLAB</con:name>
              <con:value>${#TestCase#SHEET_SCLA}</con:value>
            </con:property>
            <con:property>
              <con:name>API SLAB</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>SLAB Error</con:name>
              <con:value>${#TestCase#DIFF_SCLA}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="7d3fc48b-349a-491d-9f60-b7fb5254f60c">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="3befbd7b-f8fc-4c32-b729-3d80b0a07afe">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="530030ff-bcc0-4a6a-93b3-ec5be6316a22">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMzMTc3NTI4LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMzE4MTEyOCwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6IjQ0NzE2MzI4LTY3MGMtNDk2ZS04MTliLWM1ZWY3YzRkNTdiMSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.KRjZsRCslnAmHu8ceJpr14oSMWRfgeXaPexq8COOaOVzgyur34uIO4kg_exftQ7l_Ed4wHmEUgnvuZ1OW1VPFErdSFtOLp8Dmw66BCy3E-zt98dvbxWTQQ4izRw81lUTvQVWC2fDfDYGD8GiBugXAwalhccBjjQPLR4CnnNSNY0</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>02/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Weekly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>61.28</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>54.43</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>539825</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>27.03</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SLAB</con:name>
          <con:value>470.28</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SCLA</con:name>
          <con:value>61.28</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SCLA</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e44e1505-5a5b-48b9-a76f-efb2a39dcd3a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>728eb8d7-5bc2-4cd9-afcd-36c69c1f66cc</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="22cfb886-354d-42a1-a71b-d72c65339cf3" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="IncomeProtection(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="2f451396-61b4-4143-9eec-d7711186551b">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="4fe50683-1cfd-4e77-a430-05035bfc341b">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="60daa870-bc45-4827-95c0-8d8285658967">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="01388373-4e79-4977-9046-79a87af8c179">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="2492b4ea-bca4-4314-a0b0-6fc3fc614d7b">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="62327b07-6031-4a6d-a52e-ce0a9f24e72a">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>Data/Income Protection.xlsx</file>
              <worksheet>IP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>DI - Waiting Period</con:property>
          <con:property>DI - Benefit Payment Period</con:property>
          <con:property>DI - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Disability Income Benefit (annual)</con:property>
          <con:property>DI - Indexed</con:property>
          <con:property>DI - Loading</con:property>
          <con:property>DI - Farmers benefit</con:property>
          <con:property>DI - Cover Type (Agreed Value, Indemnity etc)</con:property>
          <con:property>DI - Premier Option</con:property>
          <con:property>DI - Child Care benefit - No. children</con:property>
          <con:property>DI - youngest child's age</con:property>
          <con:property>DI - Mental Health Limitation</con:property>
          <con:property>DI - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>DI</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i check the token status" id="91563b46-e5cb-4b0b-8ee5-607f34779218">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And i check the token status.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="2b5b578d-3d35-4f5b-831f-bd350b525aa2">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="a189e5b4-2d8f-4ab2-ac07-ed15fbb03f93">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",           
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",         
            "Age" : "${When i read users' information#Age}"            
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "A",
                "Load" : "${#TestCase#LOAD}",
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "WaitingPeriod" : "${When i read users' information#DI - Waiting Period}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "BenefitType" : "${#TestCase#BENEFIT_TYPE}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "isIndexed" : "${#TestCase#DIINDEX}",
                "BenefitTerm" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "PremierOption" : "${#TestCase#PREMIER_OPTION}",
                "ReviewTerm" : "",                
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#WOP_LOAD}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",               
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking DI, WoP">
              <con:configuration>
                <scriptText><![CDATA[def _api_di = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_di = context.expand( '${#TestCase#SHEET_DI}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_di = Math.abs(_api_di - _sheet_di) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_di = _diff_di.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

if(_frequency=='Yearly')
{
assert _diff_di <= 0.12 && _diff_wop <= 0.12  && _diff_pf <= 0.01
}
else
{
assert _diff_di <= 0.01 && _diff_wop <= 0.01 && _diff_pf <= 0.01
}]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="4eb93a61-0c99-4088-b3f5-22eb85dfe1ea">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="09a4c8b7-ac58-43a7-a44a-afadcbfe38df">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="ae9d1d2e-9eef-4e63-8f15-7ccb3322f2ee">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.IP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Disability Income Benefit (annual)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Indexed</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Farmers benefit</con:name>
              <con:value>No</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Cover Type (Agreed Value, Indemnity etc)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitType']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premier Option</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Child Care benefit - No. children</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - youngest child's age</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI</con:name>
              <con:value>${#TestCase#SHEET_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>API DI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI Error</con:name>
              <con:value>${#TestCase#DIFF_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="01686808-9a8c-4ed2-a2aa-9422fad604a0">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i check the token status</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="311001c3-1830-401d-9d1b-5196ea7f9819">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="a39c37e2-3e4d-41ab-89d6-56d0060ecda5">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzE3Njk4MSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzMxODA1ODEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI2NmQzMTg0Ny1jMTY1LTQ0MmMtYWUwNC1hYTI0ZDIyZGE4ZTEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.aTxh6Tl58x-e98h4w18IrUchNvntn6qMYNMOXXzzTVQbB2qyQeOSKY41bOsjOcPIRL8CwWcWiHXfWdxp1Jn99EyweyvYg8jJCMypCUnZZKo5DGlz3bolUw4GSPBq0wNAadUye5v0QszZSZu_u4KFIQx-9fEhAdGDzYKLawz1c-I</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>02/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Weekly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>1.42</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>56.64</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>5.3</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>1Y</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>LOE</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>150.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>49.92</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>77524</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2492b4ea-bca4-4314-a0b0-6fc3fc614d7b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="c1175961-a5ec-4458-8a5c-9a4e7efcccd3" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="IncomeProtection(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="d963bb3d-97d4-40b1-bdfd-337f759d4aca">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="177dd69f-b645-481b-823b-5951cb48314c">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="7386b31c-eb55-49b6-9a62-046185f70ff4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="8393aaa2-317e-467c-a49b-c432780b34b8">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="bdf63d5a-8609-40f5-b17e-17ab0853ba06">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="db698249-0ff8-4283-9c4d-2758f8f5ab77">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>Data/Income Protection.xlsx</file>
              <worksheet>IP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>DI - Waiting Period</con:property>
          <con:property>DI - Benefit Payment Period</con:property>
          <con:property>DI - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Disability Income Benefit (annual)</con:property>
          <con:property>DI - Indexed</con:property>
          <con:property>DI - Loading</con:property>
          <con:property>DI - Farmers benefit</con:property>
          <con:property>DI - Cover Type (Agreed Value, Indemnity etc)</con:property>
          <con:property>DI - Premier Option</con:property>
          <con:property>DI - Child Care benefit - No. children</con:property>
          <con:property>DI - youngest child's age</con:property>
          <con:property>DI - Mental Health Limitation</con:property>
          <con:property>DI - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>DI</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i check the token status" id="36e746de-ab4f-4d82-a223-d5ebd96d6e97">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And i check the token status.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="ab911125-a4f4-4eed-a493-d65e2117b485">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="19bce944-c01e-471a-9405-0927b656f2be">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",           
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",         
            "Age" : "${When i read users' information#Age}"            
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "A",
                "Load" : "${#TestCase#LOAD}",
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "WaitingPeriod" : "${When i read users' information#DI - Waiting Period}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "BenefitType" : "${#TestCase#BENEFIT_TYPE}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "isIndexed" : "${#TestCase#DIINDEX}",
                "BenefitTerm" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "PremierOption" : "${#TestCase#PREMIER_OPTION}",
                "ReviewTerm" : "",                
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#WOP_LOAD}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",               
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="b8c547fc-7f3f-462c-9a3d-dda5e3f5e53a" name="Checking DI, WoP">
              <con:configuration>
                <scriptText><![CDATA[def _api_di = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_di = context.expand( '${#TestCase#SHEET_DI}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_di = Math.abs(_api_di - _sheet_di) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_di = _diff_di.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

if(_frequency=='Yearly')
{
assert _diff_di <= 0.12 && _diff_wop <= 0.12  && _diff_pf <= 0.01
}
else
{
assert _diff_di <= 0.01 && _diff_wop <= 0.01 && _diff_pf <= 0.01
}]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="45929c0e-9bb8-4215-a71d-7cfae613874b">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="74d36ee9-c611-4dde-82f2-d470e2f2eb46">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="ac902c51-ce60-4854-9125-f894d2a19e7c">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.IP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Disability Income Benefit (annual)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Indexed</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Farmers benefit</con:name>
              <con:value>No</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Cover Type (Agreed Value, Indemnity etc)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitType']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premier Option</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Child Care benefit - No. children</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - youngest child's age</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI</con:name>
              <con:value>${#TestCase#SHEET_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>API DI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI Error</con:name>
              <con:value>${#TestCase#DIFF_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="698c68de-d05c-48e1-b382-0ac30d8f4729">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i check the token status</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="de3c7e83-9a04-48ef-82ea-85a4f1610959">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="77eff671-8975-4380-b7c0-0b441ce595b0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyMzE1OTEyLCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjMxOTUxMiwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImE4MzFmNmRjLWY1ZTUtNGMzNy05ZDQ5LTQwYTUwYjZiNGM0MSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.XZi6ugycGmG49YhNh1kYVg04zmjBEETVakpF-kyWQR0RkjxGiKaGhupK_rUS9bv4SoT_Va7WxZXPnLTGhpLZqtyd6QXT7lLAPTfQXN6UABKnPbvSvPxkzotIDEW7cQO9lXnDouVpUcEZXgRS2s8--vq-bg-HgkQaqOS4k0ezexs</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>23/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>200.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>80</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>235.33</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>15.27</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>1Y</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>AV</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>213.91</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>34861</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bdf63d5a-8609-40f5-b17e-17ab0853ba06</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="2617370a-7641-4f26-b8bd-1844d73df76a" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="IP_Age70(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="f13eba0a-306e-4697-8ec4-673cbc882c3e">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="c101bc2d-4728-401b-badf-571cb77a4012">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="ba35925e-c435-48ca-b84d-d35da8b3dab5">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="69d4d3e1-0ce9-46b3-8adc-a938a2302956">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="cf915c83-90ba-4644-a414-f34db7253a49">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="c8abe447-9624-4286-bb75-ba4844203052">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/IP_ToAge70.xlsx</file>
              <worksheet>ToAge70</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>Sex</con:property>
          <con:property>DI - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Disability Income Benefit (annual)</con:property>
          <con:property>DI - Benefit Payment Period</con:property>
          <con:property>DI - Indexed</con:property>
          <con:property>DI - Loading</con:property>
          <con:property>DI - Farmers benefit</con:property>
          <con:property>DI - Cover Type (Agreed Value, Indemnity etc)</con:property>
          <con:property>DI - Premier Option</con:property>
          <con:property>DI - Waiting Period</con:property>
          <con:property>DI - Child Care benefit - No. children</con:property>
          <con:property>DI - youngest child's age</con:property>
          <con:property>DI - Mental Health Limitation</con:property>
          <con:property>RED - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>DI</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="806e1564-7835-48e8-8b93-960101e76611">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="5e824086-3b68-41c0-a92d-40e1f32322c4">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",           
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",         
            "Age" : "${When i read users' information#Age}"            
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "A",
                "Load" : "${#TestCase#LOAD}",
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "WaitingPeriod" : "${When i read users' information#DI - Waiting Period}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "BenefitType" : "${#TestCase#BENEFIT_TYPE}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "isIndexed" : "${#TestCase#DIINDEX}",
                "BenefitTerm" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "PremierOption" : "${#TestCase#PREMIER_OPTION}",
                "ReviewTerm" : "",                
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#WOP_LOAD}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",               
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking WoP" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_di = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_di = context.expand( '${#TestCase#SHEET_DI}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_di = Math.abs(_api_di - _sheet_di) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_di = _diff_di.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_di <= tolerance && _diff_wop <= tolerance  && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="934d6fae-45b3-43f6-ac7f-0fa9241b2ee1">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="c4f8337f-567c-4bf7-8d2a-061410c5d5cb">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="0d7e80e4-cb10-47a6-a31c-f524a2735b9b">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.IP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Disability Income Benefit (annual)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Indexed</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Farmers benefit</con:name>
              <con:value>No</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Cover Type (Agreed Value, Indemnity etc)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitType']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premier Option</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Child Care benefit - No. children</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - youngest child's age</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>RED - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI</con:name>
              <con:value>${#TestCase#SHEET_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>API DI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI Error</con:name>
              <con:value>${#TestCase#DIFF_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="5f62ee31-08e1-431c-a588-0e335b3efa91">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="eadcfa26-25cb-4c7b-b7bb-c6360ad3e6ec">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="c895f3c0-18cf-4100-8065-9cff616eef6d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMTcwMDk5OCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzE3MDQ1OTgsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJjNDRiNjA2MC1kMzVjLTQ3OTgtYjQ4NS0wZTExNzIyNTJjZDEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.J-TpO7n-jH7KSSGFdt3B7nVKlis7dC9eCTHklXYWO-M8Ta3Q5LJv_4kqIBTos_lyeDB-bN_vsqeo7ZRBA8v4dZHHtm36iTYXHJzlw8f0sFFA8zCD-5X2bvtJHTlPEqR5i3JnmmRB_hNw_xoa7lqAwrp480Rri-BAvvcFEt5NSnw</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>16/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>80</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>73.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>972.24</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>68.52</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">3+ years</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>AV</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>150.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>829.92</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>67645</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3d128f1f-8a71-47d2-be12-17ca50729a46</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>cf915c83-90ba-4644-a414-f34db7253a49</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="d7489150-6730-4c34-b941-35f64543c36d" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="IP_Age70(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="e7fdeee7-4d00-46dd-8c30-c7ff30d438ab">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="14970893-5e0c-4e20-8996-c27a9ac60b76">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="513d4eb9-c576-483d-8f73-70b545e600b1">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="06b92ac1-8afd-4662-b110-d453f91bfe78">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="d8bfe3e2-ae4e-489b-b67a-91aab82446ad">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="623c723d-074d-4e26-a233-39216127ee49">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/IP_ToAge70.xlsx</file>
              <worksheet>ToAge70</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>Sex</con:property>
          <con:property>DI - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Disability Income Benefit (annual)</con:property>
          <con:property>DI - Benefit Payment Period</con:property>
          <con:property>DI - Indexed</con:property>
          <con:property>DI - Loading</con:property>
          <con:property>DI - Farmers benefit</con:property>
          <con:property>DI - Cover Type (Agreed Value, Indemnity etc)</con:property>
          <con:property>DI - Premier Option</con:property>
          <con:property>DI - Waiting Period</con:property>
          <con:property>DI - Child Care benefit - No. children</con:property>
          <con:property>DI - youngest child's age</con:property>
          <con:property>DI - Mental Health Limitation</con:property>
          <con:property>RED - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>DI</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="e6e59abf-7ae9-4587-bc50-6f5aa711cb52">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="a2c3a64a-ecae-4c99-b8c5-3a81c3a86a38">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",           
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",         
            "Age" : "${When i read users' information#Age}"            
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "A",
                "Load" : "${#TestCase#LOAD}",
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "WaitingPeriod" : "${When i read users' information#DI - Waiting Period}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "BenefitType" : "${#TestCase#BENEFIT_TYPE}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "isIndexed" : "${#TestCase#DIINDEX}",
                "BenefitTerm" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "PremierOption" : "${#TestCase#PREMIER_OPTION}",
                "ReviewTerm" : "",                
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#WOP_LOAD}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",               
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking WoP" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_di = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_di = context.expand( '${#TestCase#SHEET_DI}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_di = Math.abs(_api_di - _sheet_di) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_di = _diff_di.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_di <= tolerance && _diff_wop <= tolerance  && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="e04d61fc-7e2c-4f4c-9dcd-0a8521c2b450">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="800df86f-b26b-47fc-81fb-e1ebf78dd9a4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="49461522-b368-4a7c-a6dc-3bd692195a54">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.IP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Disability Income Benefit (annual)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Indexed</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Farmers benefit</con:name>
              <con:value>No</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Cover Type (Agreed Value, Indemnity etc)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitType']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premier Option</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Child Care benefit - No. children</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - youngest child's age</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>RED - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI</con:name>
              <con:value>${#TestCase#SHEET_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>API DI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI Error</con:name>
              <con:value>${#TestCase#DIFF_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="465662fc-9b4f-488e-81b9-ba120c21a34e">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="ede3175f-5c3a-49e9-9e37-5db93e8d14d5">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="7cf92296-b7e5-453e-807c-eecb5046426f">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMTQ0NDU0MSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzE0NDgxNDEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiIzMWExN2E2NS0zYjYzLTQ3ZGYtOGQ4ZS0zOGZiNjhiZTQ1YjkiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.NDPpmx_ZSWGkQtJjhHYr1Owy6NTLNOogMyFB50Fd_Hl66feZziWi2rmuiCIYaDC61hBtQ9OwD5OFoIiiJKWgn_T4WqPDxnxbjOuWnacnzXX5hGsYpeXqVh2M4vHGypXCp4_8nIVPXdYGXmXAWWN2W8XMf6dhYFOjdpt9A4FeJTU</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>13/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>56.44</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>54.43</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>55428</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d8bfe3e2-ae4e-489b-b67a-91aab82446ad</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="9eeec3de-4fac-42c8-bcd5-a2034afa1768" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="IP_Monthly(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="ac355d20-7857-475e-8a9a-37841e2d013b">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="446f0ccc-c0a7-48f7-bdd5-fd643ec5348b">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="48bd8823-e877-4a7e-907d-043917f605cf">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="38599c95-c078-463f-beae-dea705fda440">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="229933d8-80f9-455b-a9ed-a2b92483ba3d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="2dae1d30-958a-451e-937a-47ee8d80c10c">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/IP_Monthly.xlsx</file>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>DI - Waiting Period</con:property>
          <con:property>DI - Benefit Payment Period</con:property>
          <con:property>DI - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Disability Income Benefit (monthly)</con:property>
          <con:property>DI - Indexed</con:property>
          <con:property>DI - Loading</con:property>
          <con:property>DI - Farmers benefit</con:property>
          <con:property>DI - Cover Type (Agreed Value, Indemnity etc)</con:property>
          <con:property>DI - Premier Option</con:property>
          <con:property>DI - Child Care benefit - No. children</con:property>
          <con:property>DI - youngest child's age</con:property>
          <con:property>DI - Mental Health Limitation</con:property>
          <con:property>RED - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>DI</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="943b8016-91ce-43ab-92b1-5d1334a9f1ee">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_refine_the_data_Monthly.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="bb17a3b4-c9c9-4c20-97d4-eadb75a363f7">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",           
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",         
            "Age" : "${When i read users' information#Age}"            
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "M",
                "Load" : "${#TestCase#LOAD}",
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "WaitingPeriod" : "${When i read users' information#DI - Waiting Period}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "BenefitType" : "${#TestCase#BENEFIT_TYPE}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "isIndexed" : "${#TestCase#DIINDEX}",
                "BenefitTerm" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "PremierOption" : "${#TestCase#PREMIER_OPTION}",
                "ReviewTerm" : "",                
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#WOP_LOAD}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",               
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking WoP" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_di = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_di = context.expand( '${#TestCase#SHEET_DI}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_di = Math.abs(_api_di - _sheet_di) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_di = _diff_di.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_di <= tolerance && _diff_wop <= tolerance  && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="a9d04a69-77e0-44e2-aba3-cb33e086e9b2">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="b887447d-551c-4910-834c-524a181714ef">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="6b194baa-3a6d-4698-a46c-921bd34db3b1">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.IP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Disability Income Benefit</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Indexed</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Farmers benefit</con:name>
              <con:value>No</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Cover Type (Agreed Value, Indemnity etc)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitType']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premier Option</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Child Care benefit - No. children</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - youngest child's age</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>RED - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI</con:name>
              <con:value>${#TestCase#SHEET_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>API DI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI Error</con:name>
              <con:value>${#TestCase#DIFF_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="8a38a8e5-c0f1-48a7-8ea5-33c2a178d7ac">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="bc0f7952-e7e4-4b37-b5d1-5d3cbfed7dd3">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="93e26e2d-6f74-4aad-86dc-5aa367c95df9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjY0NzkxNSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI2NTE1MTUsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI2ZjM3YmE5OC1lOWNhLTQxY2YtOTFlOC1iNTMwMmZkMjBkZTciLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.lL02Hyhxfe3GIqkFt_DYKFoFioBHf5jVbRZhc-1M5kZwhjlVccgqi6gxCze5Za1-TNtCluQd94InZVrtU-jHpGPilXC2q4HzIt67VI_daOCWzJb9EPRvq5bnAuZ_PW7ENo4TEiaZCEzdFdsOa0AA4epM6CQqhh69daJpe3BZL4g</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>150.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>90</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>73.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>5242.8</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>1029.72</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">3+ years</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>1Y</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>AV</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>4139.28</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>3558</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>229933d8-80f9-455b-a9ed-a2b92483ba3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="67df5234-822b-445b-ae51-814c7313b2c3" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="IP_Monthly(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="b899411f-da7e-4881-8765-7099050bb05f">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="aab11008-331f-45f5-b195-058f7eb8549f">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="bf1d0c38-bdb0-44f6-a395-978af468c573">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="a8754d36-8f7a-413d-a201-9f3c42dac891">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="c184abce-8d05-4fd5-bd30-cc7a9c8f0dfd">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="a5f7134f-3843-416e-9c39-6371757944a1">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/IP_Monthly.xlsx</file>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>DI - Waiting Period</con:property>
          <con:property>DI - Benefit Payment Period</con:property>
          <con:property>DI - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Disability Income Benefit (monthly)</con:property>
          <con:property>DI - Indexed</con:property>
          <con:property>DI - Loading</con:property>
          <con:property>DI - Farmers benefit</con:property>
          <con:property>DI - Cover Type (Agreed Value, Indemnity etc)</con:property>
          <con:property>DI - Premier Option</con:property>
          <con:property>DI - Child Care benefit - No. children</con:property>
          <con:property>DI - youngest child's age</con:property>
          <con:property>DI - Mental Health Limitation</con:property>
          <con:property>RED - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>DI</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="071f4071-d7ca-48c2-b089-5e1cb8316601">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_refine_the_data_Monthly.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="7e7cb6f6-5876-4621-841f-70a2efe5cd5c">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",           
            "OccupationClass" : "${When i read users' information#Occupation Class}",            
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",         
            "Age" : "${When i read users' information#Age}"            
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "M",
                "Load" : "${#TestCase#LOAD}",
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "WaitingPeriod" : "${When i read users' information#DI - Waiting Period}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "BenefitType" : "${#TestCase#BENEFIT_TYPE}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "isIndexed" : "${#TestCase#DIINDEX}",
                "BenefitTerm" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "PremierOption" : "${#TestCase#PREMIER_OPTION}",
                "ReviewTerm" : "",                
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#WOP_LOAD}",
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",               
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking WoP" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_di = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_di = context.expand( '${#TestCase#SHEET_DI}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_di = Math.abs(_api_di - _sheet_di) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_di = _diff_di.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_di <= tolerance && _diff_wop <= tolerance  && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="32561973-15cb-424f-9ff4-1ded264aa62e">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="d3270585-4ae8-417b-a729-4771cbeb2f4f">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/IP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="3e3a323b-685c-4076-8dd7-30b5c6eec157">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.IP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Disability Income Benefit</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Indexed</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Farmers benefit</con:name>
              <con:value>No</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Cover Type (Agreed Value, Indemnity etc)</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitType']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Premier Option</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Child Care benefit - No. children</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - youngest child's age</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>DI - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>RED - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI</con:name>
              <con:value>${#TestCase#SHEET_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>API DI</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>DI Error</con:name>
              <con:value>${#TestCase#DIFF_DI}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="62c445af-2241-4441-9c75-48e711f1f286">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="8f17ae7c-5459-4802-9ece-a50a58ed5554">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="8c55dbd2-0340-413d-9ffc-0de93e0bbbff">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjU2MjY4NCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI1NjYyODQsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJmY2JhMTU2Ni03NTVkLTQ0MGQtOTMzOC04YWMzMWVlMzYxMjQiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.MD7RMLCLOUj7m74hYBLqT9ledIaXM6dR0zHgJVQhv6-xlBEBGomzqHWPl0XTUlGmQ-SUQQUtkINKIjqSL6mF7fp1nER2tTycR3Jb7IXGwXlKPFfjpdqEldZUL24ib4ZhfL9aCgEl62uj-9017r86x42HJCU_siyoGMrZC-eL1Mk</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>26/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Unemployed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>F</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>170.19</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>10.52</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>153.52</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>1864</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3008717-6ea5-4867-81b5-e1c5e0196e34</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c184abce-8d05-4fd5-bd30-cc7a9c8f0dfd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="d14f8c56-467b-4da4-9568-d3c30d5511f9" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="MIP_Mortgage(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="14d6618e-bca7-4480-ad73-c346cd47c581">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="704805bb-c6fb-4fde-a10a-72521f262d93">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="f44fb805-d415-4b9e-8cdb-12554f38e06a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="6722773a-11ce-482e-9c01-ad7bc2b7576f">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="055613e3-dba9-4f2b-a5d0-64926e8dfe97">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="db5da6ed-b5fd-449e-82c4-888cc5d6780e">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/MIP_Mortgage.xlsx</file>
              <worksheet>MIP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>MR - Cover type</con:property>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>MR - Benefit Payment Period</con:property>
          <con:property>MR - Waiting Period</con:property>
          <con:property>MR - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Sum Assured Frequency</con:property>
          <con:property>Mortgage and Income Protection</con:property>
          <con:property>MR - Indexed</con:property>
          <con:property>MR - Loading</con:property>
          <con:property>MR - Mental Health Limitation</con:property>
          <con:property>RED - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>MIP</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i check the token status" id="7e7d5282-f301-4ee6-9bb3-cac97b766cb2">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And i check the token status.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="8280979f-02e3-41b8-8752-8de5096fd8ab">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="54f99ec1-6a63-433f-9fe6-7f758ddb46aa">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",            
            "OccupationClass" : "${When i read users' information#Occupation Class}",             
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",             
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "WaitingPeriod" : "${When i read users' information#MR - Waiting Period}",
                "SumAssuredFrequency" : "${#TestCase#SUM_ASSURED_FREQUENCY}",
                "SortOrder" : 8,
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "MaxInstancesOfBenefit" : "1",
                "Load" : "${#TestCase#LOAD}",
                "isMain" : true,
                "isAvailable" : true,               
                "BenefitName" : "Mortgage and Income Protection",
                "BenefitDescription" : "Mortgage and Income Protection",
                "BenefitCode" : "MortProt",
                "BenefitCategory" : "Income Protection",
                "AttributeGroup1" : "Income Protection",
                "MortgageType" : "Mortgage",
                "MortgageRepaymentAmount" : "${#TestCase#SUM_ASSURED}",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "isIndexed" : "${#TestCase#INDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "SortOrder" : 16,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "b3a65330-c620-4fb3-b1c4-50a2c9d4ab2b",
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitId" : "ad853b55-ea12-4708-856e-bd9ae544fbbe",
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitId" : "916027c1-1d11-4910-92d4-16b292290e4a",
                    "BenefitCode" : "MortProt"
                  }, {
                    "BenefitId" : "c5a4e1e6-651b-4ef0-a53f-b3613a4f88f9",
                    "BenefitCode" : "CompLivAss"
                  }, {
                    "BenefitId" : "8c3a0d5b-324d-484c-bb99-eee765e46921",
                    "BenefitCode" : "ProgCare"
                  }, {
                    "BenefitId" : "cb42a374-560e-471e-8512-3b86fe52ce82",
                    "BenefitCode" : "TPD"
                  }, {
                    "BenefitId" : "c8ff67cf-32c9-44d7-8daf-71a30f07375d",
                    "BenefitCode" : "AccDth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "Load" :"${#TestCase#WOP_LOAD}",
                "isMain" : false,
                "isAvailable" : true,
                "BenefitId" : "89b330da-00bd-4069-bb8d-9d72bc22cc6c",
                "BenefitName" : "Waiver of Premium",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking MIP and WoP" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_mip = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_mip = context.expand( '${#TestCase#SHEET_MIP}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_mip = Math.abs(_api_mip - _sheet_mip) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_mip = _diff_mip.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_mip <= tolerance && _diff_wop <= tolerance  && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="77db7e89-72a7-4535-84fe-f759473d41c8">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="4919cd0b-9949-4792-852b-327c8911089c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="7da3feaf-3ffb-45aa-8512-47b389c7f811">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.MIP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>MR - Cover type</con:name>
              <con:value>Mortgage</con:value>
            </con:property>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sum Assured Frequency</con:name>
              <con:value>${#TestCase#SUM_ASSURED_FREQUENCY}</con:value>
            </con:property>
            <con:property>
              <con:name>Mortgage and Income Protection</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Indexed</con:name>
              <con:value>${#TestCase#INDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>RED - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>MIP</con:name>
              <con:value>${#TestCase#SHEET_MIP}</con:value>
            </con:property>
            <con:property>
              <con:name>API MIP</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>MIP Error</con:name>
              <con:value>${#TestCase#DIFF_MIP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="a17948b2-e4a0-4a02-a453-5462e939ad78">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i check the token status</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="de8aed9a-af50-4143-8d1a-88454cdf4111">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="ae1bf036-f8bb-4292-886b-5664c54cca58">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzg2MDIxOSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM4NjM4MTksIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJjNGYxMjhmNi1hMTJhLTRiMjgtOTQyMi0yYjc2ZjBjMmVlNTUiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.eIeOUIRju6XoQRYWwu_XBQ1MF1OC4FtFZ-RC4IZZciKxSK82e1OCINWnLk9Mqr-yKKPh8Gu-OzIl2vMqK_ismmbvgD-OjBRcvgNXwT3ko5nAQ3WFK-MO4WKItaj3tYsN1XG1vPzDF5IfOLnCeTEF29tMV3f-vO88kbs9ozQxqog</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>10/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>F</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>73.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>2036.16</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>67.92</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>LOE</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>85.26</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>26253</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>A</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_MIP</con:name>
          <con:value>1894.44</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_MIP</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7b97bcd1-0fb9-471a-8a9c-10b206cb944e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>055613e3-dba9-4f2b-a5d0-64926e8dfe97</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="05bb2af9-6efc-4cab-b520-e4ba195fe310" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="MIP_Income(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="1d70a10d-223b-4c22-a2a1-4156f309a17f">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="e7e3ccd3-f853-41ac-997c-7d4bb0d98ee1">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="cad8e847-9055-49ef-b818-533288f8b31e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="99627dba-9ffc-49cf-acda-2f7a4dbf80f9">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="62b9b8ec-00f8-4fc6-935a-214317563ced">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="2ec5a41c-019e-4e31-91f4-ebcc470fe41b">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/MIP_Income.xlsx</file>
              <worksheet>MIP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>MR - Cover type</con:property>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>MR - Benefit Payment Period</con:property>
          <con:property>MR - Waiting Period</con:property>
          <con:property>MR - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Sum Assured Frequency</con:property>
          <con:property>Mortgage and Income Protection</con:property>
          <con:property>MR - Indexed</con:property>
          <con:property>MR - Loading</con:property>
          <con:property>MR - Mental Health Limitation</con:property>
          <con:property>RED - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>MIP</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i check the token status" id="92185976-63e9-4059-ad5f-e479d540c750">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And i check the token status.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="2351b798-0ba2-43e5-9224-8f91f1519c5a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="846220ea-7d38-49d1-9aeb-1b3c2007c003">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",            
            "OccupationClass" : "${When i read users' information#Occupation Class}",             
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",             
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "WaitingPeriod" : "${When i read users' information#MR - Waiting Period}",
                "SumAssuredFrequency" : "${#TestCase#SUM_ASSURED_FREQUENCY}",
                "SortOrder" : 8,
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "MaxInstancesOfBenefit" : "1",
                "Load" : "${#TestCase#LOAD}",
                "isMain" : true,
                "isAvailable" : true,               
                "BenefitName" : "Mortgage and Income Protection",
                "BenefitDescription" : "Mortgage and Income Protection",
                "BenefitCode" : "MortProt",
                "BenefitCategory" : "Income Protection",
                "AttributeGroup1" : "Income Protection",
                "MortgageType" : "Income",
                "MortgageRepaymentAmount" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "isIndexed" : "${#TestCase#INDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "SortOrder" : 16,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "b3a65330-c620-4fb3-b1c4-50a2c9d4ab2b",
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitId" : "ad853b55-ea12-4708-856e-bd9ae544fbbe",
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitId" : "916027c1-1d11-4910-92d4-16b292290e4a",
                    "BenefitCode" : "MortProt"
                  }, {
                    "BenefitId" : "c5a4e1e6-651b-4ef0-a53f-b3613a4f88f9",
                    "BenefitCode" : "CompLivAss"
                  }, {
                    "BenefitId" : "8c3a0d5b-324d-484c-bb99-eee765e46921",
                    "BenefitCode" : "ProgCare"
                  }, {
                    "BenefitId" : "cb42a374-560e-471e-8512-3b86fe52ce82",
                    "BenefitCode" : "TPD"
                  }, {
                    "BenefitId" : "c8ff67cf-32c9-44d7-8daf-71a30f07375d",
                    "BenefitCode" : "AccDth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "Load" :"${#TestCase#WOP_LOAD}",
                "isMain" : false,
                "isAvailable" : true,
                "BenefitId" : "89b330da-00bd-4069-bb8d-9d72bc22cc6c",
                "BenefitName" : "Waiver of Premium",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking MIP and WoP" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_mip = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_mip = context.expand( '${#TestCase#SHEET_MIP}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_mip = Math.abs(_api_mip - _sheet_mip) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_mip = _diff_mip.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_mip <= tolerance && _diff_wop <= tolerance  && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="53553964-3fe6-456e-b01b-130fb02e75e4">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="ebf47f1f-f74f-4008-b127-e640f15e376e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="bdda69f9-2ed2-4520-89ea-13f7b03ef421">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.MIP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>MR - Cover type</con:name>
              <con:value>Income</con:value>
            </con:property>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sum Assured Frequency</con:name>
              <con:value>${#TestCase#SUM_ASSURED_FREQUENCY}</con:value>
            </con:property>
            <con:property>
              <con:name>Mortgage and Income Protection</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Indexed</con:name>
              <con:value>${#TestCase#INDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>RED - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>MIP</con:name>
              <con:value>${#TestCase#SHEET_MIP}</con:value>
            </con:property>
            <con:property>
              <con:name>API MIP</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>MIP Error</con:name>
              <con:value>${#TestCase#DIFF_MIP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="1bced188-3a69-4bed-9667-6caa026d3370">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i check the token status</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="e88c4e1d-e3f0-4d77-9a33-49289df67393">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="33c5cd36-37a7-4359-b1e3-b6c32ac4e56e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzA4NjIzMSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzMwODk4MzEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiIwMjAzZTExZS1kYzAwLTQxMTUtYTkxMi04ZmU4OWZkZDM0Y2MiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.S9Iz-8-oMJIslYT8UuSYoX1cuGhLByZlkiLcOZI6hinNZ9JaPWZO_bZX9-wflICzyDgGlLltjTaL7u8qvHYHa_YFhRPvGohn6107hx8a5HRyWOY3w-9rEhHhg2KYSUz7tWNqFuJ7pwiBxuVRjLDxK9c-cT9fQ-zfyKLlcppNPlo</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>01/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Unemployed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>60</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>66.73</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>5.58</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>2Y</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>LOE</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>85.26</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>21874</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>A</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_MIP</con:name>
          <con:value>55.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_MIP</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7b97bcd1-0fb9-471a-8a9c-10b206cb944e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>62b9b8ec-00f8-4fc6-935a-214317563ced</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="6ebe84fb-37a2-425e-899d-f1cb85cd0344" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="MIP_Mortgage(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="47652998-a35e-4d43-8f95-3a7f8de974b0">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="4c33c275-f9f6-449b-96ba-2aebca09fc2b">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="175b3e34-6df0-4b51-a20b-3919c91714b7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="823db921-74cb-4527-9f1f-4d3ed98dbce1">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="22fe18a8-40bd-4510-b60e-908a56c5b68f">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="f56b3ff2-b5c0-4bc7-8a87-d0c776f3c71d">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/MIP_Mortgage.xlsx</file>
              <worksheet>MIP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>MR - Cover type</con:property>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>MR - Benefit Payment Period</con:property>
          <con:property>MR - Waiting Period</con:property>
          <con:property>MR - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Sum Assured Frequency</con:property>
          <con:property>Mortgage and Income Protection</con:property>
          <con:property>MR - Indexed</con:property>
          <con:property>MR - Loading</con:property>
          <con:property>MR - Mental Health Limitation</con:property>
          <con:property>RED - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>MIP</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i check the token status" id="32b305c8-f54b-4515-9c1c-d663800aec7c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And i check the token status.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="f090e406-4449-4e25-8f65-31a175782a39">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="0ecb5550-de70-4ebd-8a43-8f707ef81072">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",            
            "OccupationClass" : "${When i read users' information#Occupation Class}",             
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",             
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "WaitingPeriod" : "${When i read users' information#MR - Waiting Period}",
                "SumAssuredFrequency" : "${#TestCase#SUM_ASSURED_FREQUENCY}",
                "SortOrder" : 8,
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "MaxInstancesOfBenefit" : "1",
                "Load" : "${#TestCase#LOAD}",
                "isMain" : true,
                "isAvailable" : true,               
                "BenefitName" : "Mortgage and Income Protection",
                "BenefitDescription" : "Mortgage and Income Protection",
                "BenefitCode" : "MortProt",
                "BenefitCategory" : "Income Protection",
                "AttributeGroup1" : "Income Protection",
                "MortgageType" : "Mortgage",
                "MortgageRepaymentAmount" : "${#TestCase#SUM_ASSURED}",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "isIndexed" : "${#TestCase#INDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "SortOrder" : 16,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "b3a65330-c620-4fb3-b1c4-50a2c9d4ab2b",
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitId" : "ad853b55-ea12-4708-856e-bd9ae544fbbe",
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitId" : "916027c1-1d11-4910-92d4-16b292290e4a",
                    "BenefitCode" : "MortProt"
                  }, {
                    "BenefitId" : "c5a4e1e6-651b-4ef0-a53f-b3613a4f88f9",
                    "BenefitCode" : "CompLivAss"
                  }, {
                    "BenefitId" : "8c3a0d5b-324d-484c-bb99-eee765e46921",
                    "BenefitCode" : "ProgCare"
                  }, {
                    "BenefitId" : "cb42a374-560e-471e-8512-3b86fe52ce82",
                    "BenefitCode" : "TPD"
                  }, {
                    "BenefitId" : "c8ff67cf-32c9-44d7-8daf-71a30f07375d",
                    "BenefitCode" : "AccDth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "Load" :"${#TestCase#WOP_LOAD}",
                "isMain" : false,
                "isAvailable" : true,
                "BenefitId" : "89b330da-00bd-4069-bb8d-9d72bc22cc6c",
                "BenefitName" : "Waiver of Premium",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking MIP and WoP" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_mip = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_mip = context.expand( '${#TestCase#SHEET_MIP}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_mip = Math.abs(_api_mip - _sheet_mip) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_mip = _diff_mip.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_mip <= tolerance && _diff_wop <= tolerance  && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking for Errors" id="420c0d76-cbbf-46e9-a3a5-f861cffbc811">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="7ffc585c-b1c5-4d36-b0ab-9174d35c5255">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="3edf89e0-95db-4c4d-9eaa-e5f53e5ab069">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.MIP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>MR - Cover type</con:name>
              <con:value>Mortgage</con:value>
            </con:property>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sum Assured Frequency</con:name>
              <con:value>${#TestCase#SUM_ASSURED_FREQUENCY}</con:value>
            </con:property>
            <con:property>
              <con:name>Mortgage and Income Protection</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Indexed</con:name>
              <con:value>${#TestCase#INDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>RED - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>MIP</con:name>
              <con:value>${#TestCase#SHEET_MIP}</con:value>
            </con:property>
            <con:property>
              <con:name>API MIP</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>MIP Error</con:name>
              <con:value>${#TestCase#DIFF_MIP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="ae5aa5d9-3c6a-4d29-9af4-9b7f75947d83">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i check the token status</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="2a4fa6f9-8edb-4e2d-8fba-00b9767170a3">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="05f1a9a8-2d6a-411b-afc3-c7c4c0b87f26">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzAxOTA4OCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzMwMjI2ODgsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI2NGE4ODE0Ni0yYjMyLTQyODUtODZjZS03MjEyNjg4ZjA2NjgiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.S59uxDNn9AB3mvebtyAQzlfpdqf4QLNBAUesDqy_UYak1m8MT5Lz9C-8h7l03vpPdA83RiAc3EJnlejJWGiksgSiJzgwIPF2zZmsgByPVhVhXRyXkfbyHr9OKUcflilrPjDGR4e7P929xoQWs-5vNFHQ8QDVQkLRPTVCztfYL7A</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>31/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>F</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>150.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>INVALID</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>60</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>73.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>8185.68</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>483.48</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>LOE</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>10.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>85.26</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>68180</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>A</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_MIP</con:name>
          <con:value>7628.4</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_MIP</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7b97bcd1-0fb9-471a-8a9c-10b206cb944e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>22fe18a8-40bd-4510-b60e-908a56c5b68f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="85ff6d91-57cd-4524-8ba2-2d849f984cb6" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="MIP_Income(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="cc3e1995-19ca-41e3-ae47-429b75af5c79">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="f6d681cf-8de4-4ae9-b346-221a6249639d">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="71b87903-5e66-4b12-9f0d-c224e4be98cc">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="f9b86705-eeee-4a8f-98b3-8a9c40df8aff">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="752f4c30-e2b3-4476-a047-03680cc95f9d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="d7c0d629-47d1-4345-a256-30466d921716">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/MIP_Income.xlsx</file>
              <worksheet>MIP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>MR - Cover type</con:property>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>MR - Benefit Payment Period</con:property>
          <con:property>MR - Waiting Period</con:property>
          <con:property>MR - Premium Options</con:property>
          <con:property>Smoker</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Sum Assured Frequency</con:property>
          <con:property>Mortgage and Income Protection</con:property>
          <con:property>MR - Indexed</con:property>
          <con:property>MR - Loading</con:property>
          <con:property>MR - Mental Health Limitation</con:property>
          <con:property>RED - Redundancy Cover</con:property>
          <con:property>Premium Waiver</con:property>
          <con:property>WA - Wait</con:property>
          <con:property>WA - Loading</con:property>
          <con:property>WA - Term</con:property>
          <con:property>MIP</con:property>
          <con:property>Waiver</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i check the token status" id="0d85585a-e43f-41b5-8159-9a3761a697c0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And i check the token status.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="a99dcb68-0cdb-4a6a-948c-17a794ec16e2">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="841d0359-4c0c-48ea-a406-8e1a57f3272e">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",            
            "OccupationClass" : "${When i read users' information#Occupation Class}",             
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",             
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "WaitingPeriod" : "${When i read users' information#MR - Waiting Period}",
                "SumAssuredFrequency" : "${#TestCase#SUM_ASSURED_FREQUENCY}",
                "SortOrder" : 8,
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "MentalHealthLimitation" : "${#TestCase#MENTAL_HEALTH}",
                "MaxInstancesOfBenefit" : "1",
                "Load" : "${#TestCase#LOAD}",
                "isMain" : true,
                "isAvailable" : true,               
                "BenefitName" : "Mortgage and Income Protection",
                "BenefitDescription" : "Mortgage and Income Protection",
                "BenefitCode" : "MortProt",
                "BenefitCategory" : "Income Protection",
                "AttributeGroup1" : "Income Protection",
                "MortgageType" : "Income",
                "MortgageRepaymentAmount" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "isIndexed" : "${#TestCase#INDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "WaitingPeriod" : "${When i read users' information#WA - Wait}",
                "SortOrder" : 16,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "b3a65330-c620-4fb3-b1c4-50a2c9d4ab2b",
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitId" : "ad853b55-ea12-4708-856e-bd9ae544fbbe",
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitId" : "916027c1-1d11-4910-92d4-16b292290e4a",
                    "BenefitCode" : "MortProt"
                  }, {
                    "BenefitId" : "c5a4e1e6-651b-4ef0-a53f-b3613a4f88f9",
                    "BenefitCode" : "CompLivAss"
                  }, {
                    "BenefitId" : "8c3a0d5b-324d-484c-bb99-eee765e46921",
                    "BenefitCode" : "ProgCare"
                  }, {
                    "BenefitId" : "cb42a374-560e-471e-8512-3b86fe52ce82",
                    "BenefitCode" : "TPD"
                  }, {
                    "BenefitId" : "c8ff67cf-32c9-44d7-8daf-71a30f07375d",
                    "BenefitCode" : "AccDth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "Load" :"${#TestCase#WOP_LOAD}",
                "isMain" : false,
                "isAvailable" : true,
                "BenefitId" : "89b330da-00bd-4069-bb8d-9d72bc22cc6c",
                "BenefitName" : "Waiver of Premium",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking MIP and WoP" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_mip = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double
def _sheet_mip = context.expand( '${#TestCase#SHEET_MIP}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _api_wop = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_wop = context.expand( '${#TestCase#SHEET_WOP}' ) as double

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_mip = Math.abs(_api_mip - _sheet_mip) as double

def _diff_wop = Math.abs(_api_wop - _sheet_wop) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_mip = _diff_mip.round(2)
_diff_wop = _diff_wop.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_mip <= tolerance && _diff_wop <= tolerance  && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="218d2020-ba9d-4120-a83a-8f1e77c24923" name="Checking for Errors">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="a253b3a9-fba6-4e5e-9218-57cf78eb8d8e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/MIP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="22f6adcd-442e-40b7-99ad-92a1b03672b7">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.MIP.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>MR - Cover type</con:name>
              <con:value>Income</con:value>
            </con:property>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Benefit Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PaymentPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Waiting Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sum Assured Frequency</con:name>
              <con:value>${#TestCase#SUM_ASSURED_FREQUENCY}</con:value>
            </con:property>
            <con:property>
              <con:name>Mortgage and Income Protection</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Indexed</con:name>
              <con:value>${#TestCase#INDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>MR - Mental Health Limitation</con:name>
              <con:value>${#TestCase#MENTAL_HEALTH}</con:value>
            </con:property>
            <con:property>
              <con:name>RED - Redundancy Cover</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Waiver</con:name>
              <con:value>Yes</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Wait</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['WaitingPeriod']}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Loading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WA - Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>MIP</con:name>
              <con:value>${#TestCase#SHEET_MIP}</con:value>
            </con:property>
            <con:property>
              <con:name>API MIP</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>MIP Error</con:name>
              <con:value>${#TestCase#DIFF_MIP}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver</con:name>
              <con:value>${#TestCase#SHEET_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>API Waiver</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Error</con:name>
              <con:value>${#TestCase#DIFF_WOP}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="fd219b90-2b25-46fd-8eaf-c398ed8a2894">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i check the token status</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="384e3499-fd31-46d0-8d3c-25e8d14ddc96">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="d421ef3c-af74-457c-8c5b-49f4b3110ae0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzA4NjIzMSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzMwODk4MzEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiIwMjAzZTExZS1kYzAwLTQxMTUtYTkxMi04ZmU4OWZkZDM0Y2MiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.S9Iz-8-oMJIslYT8UuSYoX1cuGhLByZlkiLcOZI6hinNZ9JaPWZO_bZX9-wflICzyDgGlLltjTaL7u8qvHYHa_YFhRPvGohn6107hx8a5HRyWOY3w-9rEhHhg2KYSUz7tWNqFuJ7pwiBxuVRjLDxK9c-cT9fQ-zfyKLlcppNPlo</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>01/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Unemployed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>60</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>66.73</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>5.58</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>2Y</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>LOE</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>85.26</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>21874</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>A</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_MIP</con:name>
          <con:value>55.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_MIP</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7b97bcd1-0fb9-471a-8a9c-10b206cb944e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>752f4c30-e2b3-4476-a047-03680cc95f9d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="7f44b950-c38c-4c9a-9aae-be026bf03245" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="STPD(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="1ac4a768-8912-4c39-97a5-4cf260af7982">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="0970afb8-f411-4fcd-94dc-4291f258aff7">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="2698a51f-1bed-40ee-bf66-40531cb5245f">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="a9bedb88-5c4f-4f12-896c-b15d34bed9d6">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="cacefab1-6c38-4272-8816-78d92bb307b4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="af0ca643-1867-4610-b568-c9c7d90a59ac">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/STPD.xlsx</file>
              <worksheet>STPD</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>TPD - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>TPD Cover - SA</con:property>
          <con:property>STPD - Expiry Age</con:property>
          <con:property>TPD - Type</con:property>
          <con:property>TPD - accel type</con:property>
          <con:property>TPD - SA Index</con:property>
          <con:property>TPD - Loading</con:property>
          <con:property>TPD - Per Mille Loading $</con:property>
          <con:property>TPD - Per Mille Loading term</con:property>
          <con:property>STPD</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="d8ac8eee-a71e-48e2-b880-e757d8bce3a9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/STPD/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="e4405a20-8165-4b80-b91a-4ead30021e0f">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{  
   "Quote":{  
      "PartyRolesInQuote":{  
         "PartyRoleInQuote":[  
            {  
               "Products":{  
                  "Product":[  
                     {  
                        "ProductBenefits":{  
                           "ProductBenefit":[  
                              {  
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"TPD",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {  
                                          "Values":null,
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"TPD",
                                 "BenefitCode":"TPD",
                                 "BenefitDescription":"Total Permanent Disablement",
                                 "BenefitName":"Total Permanent Disablement",
                                 "BenefitTerm":"${#TestCase#BENEFIT_TERM}",
                                 "BenefitType":"${#TestCase#BENEFIT_TYPE}",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"3256e203-9ad8-436b-aab3-a2bfa73a6322",
                                 "isAvailable":true,
                                 "isIndexed":"${#TestCase#INDEX}",
                                 "isMain":true,
                                 "LinkType":"S",
                                 "Load":"${#TestCase#LOAD}",
                                 "LoadingPerMille":"${When i read users' information#TPD - Per Mille Loading $}",
								 "LoadingTerm": "${When i read users' information#TPD - Per Mille Loading term}",
                                 "MaxInstancesOfBenefit":"1",
                                 "PremiumOption":"${#TestCase#PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":13,
                                 "SumAssured":"${#TestCase#SUM_ASSURED}"
                              }
                           ]
                        },
                        "Channel":"SOVHUB",
                        "ProductName":"TotalCare Max - Personal",
                        "ProductCode":"TCMP"
                     }
                  ]
               },
               "PartyRoleDetails":{  
                  "Party":{  
                     "selfEmployedGT3Years":"${#TestCase#SEGT3}",
                     "EmploymentStatus":"${#TestCase#EMPLOYMENTSTATUS}",                     
                     "OccupationClass":"${When i read users' information#Occupation Class}",                      
                     "Gender":"${#TestCase#GENDER}",
                     "SmokerStatus":"${#TestCase#SMOKER}",                    
                     "Age":"${When i read users' information#Age}" 
                  },                
                  "LifeNumber":1
               }
            }
         ]
      },
      "TCMPPolicyFee":"${#TestCase#TCMP_POL_FEE}",
      "PaymentFrequency":"${#TestCase#FREQUENCY}",      
      "QuoteNumber":""
   }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking STPD" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText>def _stpd=context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as String

double _api_stpd = _stpd?.trim().length()!=0 ? Double.parseDouble(_stpd) : 0.0

def _sheet_stpd = context.expand( '${#TestCase#SHEET_STPD}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_stpd = Math.abs(_api_stpd - _sheet_stpd) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_stpd = _diff_stpd.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_stpd &lt;= tolerance &amp;&amp; _diff_pf &lt;= 0.01</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="0d8f841d-f6cc-43af-bcb4-58a7a6151da1" name="Checking for Errors">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="9982625b-c465-4c17-a753-62315085906a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/STPD/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="5e7c19f9-7b7e-432c-a93c-fead23771b63">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.STPD.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>STPD</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD Cover - SA</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>STPD - Expiry Age</con:name>
              <con:value>${#TestCase#BENEFIT_TERM}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Type</con:name>
              <con:value>${#TestCase#BENEFIT_TYPE}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - accel type</con:name>
              <con:value>Standard</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - SA Index</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Per Mille Loading $</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Per Mille Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>STPD</con:name>
              <con:value>${#TestCase#SHEET_STPD}</con:value>
            </con:property>
            <con:property>
              <con:name>API STPD</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>STPD Error</con:name>
              <con:value>${#TestCase#DIFF_STPD}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="6b43bbfb-51a2-4adb-b5bd-8ac5b03e5ba3">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="c0651ba6-587e-4995-8efd-603d1be23092">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="15046598-1d86-4555-a6ec-5298449db670">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzc4MDk3Mywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM3ODQ1NzMsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI1MTYyNWVlYS1lNTY5LTQyYmMtODRkMi0xZmU5NWIxODMxNWQiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.DAMszJpg56gHlyHHCjct-KrqUBWc2UVvwGpqogEHLg9z7ocwTyIZe-0Ha6njmh4lvpeYBgiWgEukuXW9QT30qk-IoXHl2ebIjttiEeqCr1VjgWEUTjwhccxZOB2GF_X9GTMoUNtdkVRkD2uqyJU9IbDBcX1aj_xuPQaOVl_o5y8</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>09/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>F</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>100</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>17060.35</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>483.48</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>AOCC</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>10.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>85.26</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>4929284</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>A</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_MIP</con:name>
          <con:value>7628.4</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_MIP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_STPD</con:name>
          <con:value>17054.2</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_STPD</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7b97bcd1-0fb9-471a-8a9c-10b206cb944e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>cacefab1-6c38-4272-8816-78d92bb307b4</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="5451af7e-1c6e-49a3-8d3b-85046d31d4af" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="STPD(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="b11cccb8-bd51-4049-9f11-68fac9310284">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="542d4428-6d80-49b8-a918-741b873e8714">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="3901b18d-8bd4-498f-9b2f-880263e679bd">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="51799c87-2e39-410b-a458-8aa044153f5f">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="8390cb43-e622-40f8-a487-dcfd929de282">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="18b104c9-9856-40dd-83e3-a7869e5d1122">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/STPD.xlsx</file>
              <worksheet>STPD</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>TPD - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>TPD Cover - SA</con:property>
          <con:property>STPD - Expiry Age</con:property>
          <con:property>TPD - Type</con:property>
          <con:property>TPD - accel type</con:property>
          <con:property>TPD - SA Index</con:property>
          <con:property>TPD - Loading</con:property>
          <con:property>TPD - Per Mille Loading $</con:property>
          <con:property>TPD - Per Mille Loading term</con:property>
          <con:property>STPD</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="5c1665ae-9f4a-4e8d-9743-8b5e1df0de5f">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/STPD/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="cb667dc5-10e6-4c1b-81dd-e52e46983532">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{  
   "Quote":{  
      "PartyRolesInQuote":{  
         "PartyRoleInQuote":[  
            {  
               "Products":{  
                  "Product":[  
                     {  
                        "ProductBenefits":{  
                           "ProductBenefit":[  
                              {  
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"TPD",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {  
                                          "Values":null,
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"TPD",
                                 "BenefitCode":"TPD",
                                 "BenefitDescription":"Total Permanent Disablement",
                                 "BenefitName":"Total Permanent Disablement",
                                 "BenefitTerm":"${#TestCase#BENEFIT_TERM}",
                                 "BenefitType":"${#TestCase#BENEFIT_TYPE}",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"3256e203-9ad8-436b-aab3-a2bfa73a6322",
                                 "isAvailable":true,
                                 "isIndexed":"${#TestCase#INDEX}",
                                 "isMain":true,
                                 "LinkType":"S",
                                 "Load":"${#TestCase#LOAD}",
                                 "LoadingPerMille":"${When i read users' information#TPD - Per Mille Loading $}",
								 "LoadingTerm": "${When i read users' information#TPD - Per Mille Loading term}",
                                 "MaxInstancesOfBenefit":"1",
                                 "PremiumOption":"${#TestCase#PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":13,
                                 "SumAssured":"${#TestCase#SUM_ASSURED}"
                              }
                           ]
                        },
                        "Channel":"SOVHUB",
                        "ProductName":"TotalCare Max - Personal",
                        "ProductCode":"TCMP"
                     }
                  ]
               },
               "PartyRoleDetails":{  
                  "Party":{  
                     "selfEmployedGT3Years":"${#TestCase#SEGT3}",
                     "EmploymentStatus":"${#TestCase#EMPLOYMENTSTATUS}",                     
                     "OccupationClass":"${When i read users' information#Occupation Class}",                      
                     "Gender":"${#TestCase#GENDER}",
                     "SmokerStatus":"${#TestCase#SMOKER}",                    
                     "Age":"${When i read users' information#Age}" 
                  },                
                  "LifeNumber":1
               }
            }
         ]
      },
      "TCMPPolicyFee":"${#TestCase#TCMP_POL_FEE}",
      "PaymentFrequency":"${#TestCase#FREQUENCY}",      
      "QuoteNumber":""
   }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking STPD" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText>def _stpd=context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as String

double _api_stpd = _stpd?.trim().length()!=0 ? Double.parseDouble(_stpd) : 0.0

def _sheet_stpd = context.expand( '${#TestCase#SHEET_STPD}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_stpd = Math.abs(_api_stpd - _sheet_stpd) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_stpd = _diff_stpd.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_stpd &lt;= tolerance &amp;&amp; _diff_pf &lt;= 0.01</scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="0d8f841d-f6cc-43af-bcb4-58a7a6151da1" name="Checking for Errors">
              <con:configuration>
                <scriptText>def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
assert errorMessages==null || errorMessages==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="d4149c13-5de6-47da-83ec-7c77c5fb7644">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/STPD/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="7f04a7df-515c-42d2-b818-d979c6de409b">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.STPD.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>STPD</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD Cover - SA</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>STPD - Expiry Age</con:name>
              <con:value>${#TestCase#BENEFIT_TERM}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Type</con:name>
              <con:value>${#TestCase#BENEFIT_TYPE}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - accel type</con:name>
              <con:value>Standard</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - SA Index</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Per Mille Loading $</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Per Mille Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>STPD</con:name>
              <con:value>${#TestCase#SHEET_STPD}</con:value>
            </con:property>
            <con:property>
              <con:name>API STPD</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>STPD Error</con:name>
              <con:value>${#TestCase#DIFF_STPD}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="fcc6d9d0-e06e-40e5-aed5-1125796b193d">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="64de0d0d-da2b-45ef-a298-840766531f2b">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="1765e135-24d5-4696-a4bb-59b54f60bdf6">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzc4MDk3Mywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM3ODQ1NzMsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI1MTYyNWVlYS1lNTY5LTQyYmMtODRkMi0xZmU5NWIxODMxNWQiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.DAMszJpg56gHlyHHCjct-KrqUBWc2UVvwGpqogEHLg9z7ocwTyIZe-0Ha6njmh4lvpeYBgiWgEukuXW9QT30qk-IoXHl2ebIjttiEeqCr1VjgWEUTjwhccxZOB2GF_X9GTMoUNtdkVRkD2uqyJU9IbDBcX1aj_xuPQaOVl_o5y8</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>09/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>F</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>100</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>17060.35</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>483.48</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>AOCC</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>10.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>85.26</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>4929284</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>A</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_MIP</con:name>
          <con:value>7628.4</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_MIP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_STPD</con:name>
          <con:value>17054.2</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_STPD</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7b97bcd1-0fb9-471a-8a9c-10b206cb944e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8390cb43-e622-40f8-a487-dcfd929de282</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="ef41f67e-0293-4a70-9853-a990ca7e70fe" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="ACLA(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="b26a9b17-1407-41d6-af7d-62671ec7b9e4">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="40c59c07-d276-4681-90f7-3fe28617d912">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="dcce25ba-b1a0-4bca-b9bd-76606b6f5320">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="b7c7c98d-1faa-43c5-b5f0-354f79a021f7">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="9b7d188e-dcd7-4d54-a9f7-d412f8c96ee9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="c63edfa2-04a0-4702-aaf8-93af4ecf0c37">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/ACLA.xlsx</file>
              <worksheet>ACLA</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>LABL - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Living Assurance - Accel</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>LAB - Loading</con:property>
          <con:property>LAB - Per Mille Loading</con:property>
          <con:property>LAB - Per Mille Loading term</con:property>
          <con:property>LAB - Buyback Discount</con:property>
          <con:property>LIFE</con:property>
          <con:property>LABL</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="e5215aef-b03b-4ce6-b498-16d08a0011a9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/ACLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="416f444b-7cf5-411b-936b-cc7982184686">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "fc0ce194-6893-4137-911f-ce3be9f489be",
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",
            "Salary" : null,
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Occupation" : null,
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "BirthDate" : null,
            "Age" : "${When i read users' information#Age}",
            "LastName" : "zzz",
            "FirstName" : null
          },
          "LifeId" : "fc0ce194-6893-4137-911f-ce3be9f489be"
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "BenefitId" : "f2b13e76-cd8b-4ff3-9bc7-a394379448d3",
                "isAvailable" : true,
                "isMain" : true,
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "MaxInstancesOfBenefit" : "4",
                "SortOrder" : 1,
                "SumAssured" : "${When i read users' information#Life Cover}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "PremiumOption" : "${#TestCase#LPRE_OPT}",
				"LoadingTerm": "${When i read users' information#Life - Loading term}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitDescription" : "Living Assurance",
                "BenefitName" : "Accelerated Living Assurance",
                "LivingBuybackDiscount" : "${#TestCase#BUYBACK_DISCOUNT}",
                "Channel" : "SOVHUB",
                "BenefitId" : "e6f0d0e9-6741-4373-9d75-a658f7154c8c",
                "isAvailable" : true,
                "isMain" : false,
                "LinkType" : "A",
                "Load" : "${#TestCase#LABLOAD}",
                "LoadingPerMille" : "${When i read users' information#LAB - Per Mille Loading}",
		      "LoadingTerm" : "${When i read users' information#LAB - Per Mille Loading term}",
                "MaxInstancesOfBenefit" : "4",
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "f2b13e76-cd8b-4ff3-9bc7-a394379448d3",
                    "BenefitCode" : "Life"
                  } ]
                },
                "ProductCode" : "TCMP",
                "ProductName" : "TotalCare Max - Personal",
                "SortOrder" : 5,
                "SumAssured" : "${When i read users' information#Living Assurance - Accel}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking ACLA" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_acla = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_acla = context.expand( '${#TestCase#SHEET_ACLA}' ) as double

def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double
def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_acla = Math.abs(_api_acla - _sheet_acla) as double
def _diff_life = Math.abs(_api_life - _sheet_life) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double

_diff_acla = _diff_acla.round(2)
_diff_life = _diff_life.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

log.info tolerance

assert _diff_acla <= tolerance && _diff_pf <= 0.01
assert _diff_life <= tolerance && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="16ee5198-2a00-4b6d-96c5-9877ee034c4d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/ACLA/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="415fc6ce-9e53-4380-b402-2b3a93cf2956">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.ACLA.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${When i read users' information#Sex}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${When i read users' information#Smoker}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL - Premium Options</con:name>
              <con:value>${When i read users' information#LABL - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${When i read users' information#Premium Frequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${When i read users' information#Commission Adjustment}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${When i read users' information#Life Cover}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>${When i read users' information#Life - Type}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${When i read users' information#Life - Indexing}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${When i read users' information#Life - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${When i read users' information#Life - Loading per mille}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${When i read users' information#Life - Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>Living Assurance - Accel</con:name>
              <con:value>${When i read users' information#Living Assurance - Accel}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${When i read users' information#Life - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Loading</con:name>
              <con:value>${When i read users' information#LAB - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading</con:name>
              <con:value>${When i read users' information#LAB - Per Mille Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading term</con:name>
              <con:value>${When i read users' information#LAB - Per Mille Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Buyback Discount</con:name>
              <con:value>${When i read users' information#LAB - Buyback Discount}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API LIFE</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL</con:name>
              <con:value>${#TestCase#SHEET_ACLA}</con:value>
            </con:property>
            <con:property>
              <con:name>API LABL</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL Error</con:name>
              <con:value>${#TestCase#DIFF_ACLA}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API Pol Fee</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="08b0e68e-4316-49cb-898f-6ce5f1c7bc65">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="b202017a-6332-4418-bbd3-43f8528e37f8">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="5d352aa6-53ea-4a6c-a896-28dd0e448319">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzY5Mjg5Mywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM2OTY0OTMsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJjMTBlZjFhMi1kYzUzLTQ5M2YtOGM1ZS0wNmJjNTYzMGJlYzIiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.LvUNsPJKZ2KtzeMOxK5vKu7Lt48wbuTALTAsiNSOOYkSNvbhh2S6AJ9By7CLzAr2M74XVV9PjUy2xUuVeII8rC8rlUOyuCpy70CeNNdLNx-lxg8MY5-rfd5mJNpr7IiDvAZGO3qvR-ty7YjGMIR5IUlRnmIiUi_qzWAAK1oTAF0</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>08/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>20</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">47.46</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>106.73</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">&lt; 3 years</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>54.43</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>27.03</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SLAB</con:name>
          <con:value>470.28</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SCLA</con:name>
          <con:value>1898.88</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SCLA</con:name>
          <con:value>1547.83</con:value>
        </con:property>
        <con:property>
          <con:name>test</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>LABLOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ACLA</con:name>
          <con:value>53.12</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ACLA</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LPRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e44e1505-5a5b-48b9-a76f-efb2a39dcd3a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9b7d188e-dcd7-4d54-a9f7-d412f8c96ee9</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="b8fc66e2-6f87-4fb5-807d-debc85080c2b" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="ACLA(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="967ddf91-d9b8-4152-8c22-6ad1d0878c84">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="10827c45-0d25-4e87-808a-737beb7e13cd">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="066cfbe7-6262-419b-b943-161addcd3621">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="1dbd61d1-53fe-4cab-9648-6269d195d8d3">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="f6ef3818-bbdc-4982-afc1-e7b78c412b2a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="07b9bd99-ee2f-4c2f-8e0a-b0cdcdf8dd0c">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/ACLA.xlsx</file>
              <worksheet>ACLA</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>LABL - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Living Assurance - Accel</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>LAB - Loading</con:property>
          <con:property>LAB - Per Mille Loading</con:property>
          <con:property>LAB - Per Mille Loading term</con:property>
          <con:property>LAB - Buyback Discount</con:property>
          <con:property>LIFE</con:property>
          <con:property>LABL</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="26dba7ae-c963-45cb-9a5d-5d98e7f7c7b4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/ACLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="796fba69-76a5-462f-ab61-f4393b86af5e">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "${#TestCase#FREQUENCY}",
    "TCMPPolicyFee" : "${#TestCase#TCMP_POL_FEE}",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "fc0ce194-6893-4137-911f-ce3be9f489be",
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOYMENTSTATUS}",
            "Salary" : null,
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Occupation" : null,
            "Gender" : "${#TestCase#GENDER}",
            "SmokerStatus" : "${#TestCase#SMOKER}",
            "BirthDate" : null,
            "Age" : "${When i read users' information#Age}",
            "LastName" : "zzz",
            "FirstName" : null
          },
          "LifeId" : "fc0ce194-6893-4137-911f-ce3be9f489be"
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "BenefitId" : "f2b13e76-cd8b-4ff3-9bc7-a394379448d3",
                "isAvailable" : true,
                "isMain" : true,
                "Load" : "${#TestCase#LOAD}",
                "LoadingPerMille" : "${When i read users' information#Life - Loading per mille}",
                "MaxInstancesOfBenefit" : "4",
                "SortOrder" : 1,
                "SumAssured" : "${When i read users' information#Life Cover}",
                "isIndexed" : "${#TestCase#LIFEINDEX}",
                "PremiumOption" : "${#TestCase#LPRE_OPT}",
				"LoadingTerm": "${When i read users' information#Life - Loading term}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              }, {
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitDescription" : "Living Assurance",
                "BenefitName" : "Accelerated Living Assurance",
                "LivingBuybackDiscount" : "${#TestCase#BUYBACK_DISCOUNT}",
                "Channel" : "SOVHUB",
                "BenefitId" : "e6f0d0e9-6741-4373-9d75-a658f7154c8c",
                "isAvailable" : true,
                "isMain" : false,
                "LinkType" : "A",
                "Load" : "${#TestCase#LABLOAD}",
                "LoadingPerMille" : "${When i read users' information#LAB - Per Mille Loading}",
		      "LoadingTerm" : "${When i read users' information#LAB - Per Mille Loading term}",
                "MaxInstancesOfBenefit" : "4",
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "f2b13e76-cd8b-4ff3-9bc7-a394379448d3",
                    "BenefitCode" : "Life"
                  } ]
                },
                "ProductCode" : "TCMP",
                "ProductName" : "TotalCare Max - Personal",
                "SortOrder" : 5,
                "SumAssured" : "${When i read users' information#Living Assurance - Accel}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : "${#TestCase#SHEET_COMMISSION}"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking ACLA" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_acla = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_acla = context.expand( '${#TestCase#SHEET_ACLA}' ) as double

def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double
def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_acla = Math.abs(_api_acla - _sheet_acla) as double
def _diff_life = Math.abs(_api_life - _sheet_life) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double

_diff_acla = _diff_acla.round(2)
_diff_life = _diff_life.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

log.info tolerance

assert _diff_acla <= tolerance && _diff_pf <= 0.01
assert _diff_life <= tolerance && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="2a9c1586-5944-4328-94c2-57a3f1b7ec10">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/ACLA/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="172c876c-e14d-4a85-8509-c0ee7e6ff4f0">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.ACLA.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${When i read users' information#Sex}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${When i read users' information#Smoker}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL - Premium Options</con:name>
              <con:value>${When i read users' information#LABL - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${When i read users' information#Premium Frequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${When i read users' information#Commission Adjustment}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${When i read users' information#Life Cover}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>${When i read users' information#Life - Type}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${When i read users' information#Life - Indexing}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${When i read users' information#Life - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${When i read users' information#Life - Loading per mille}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${When i read users' information#Life - Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>Living Assurance - Accel</con:name>
              <con:value>${When i read users' information#Living Assurance - Accel}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${When i read users' information#Life - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Loading</con:name>
              <con:value>${When i read users' information#LAB - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading</con:name>
              <con:value>${When i read users' information#LAB - Per Mille Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading term</con:name>
              <con:value>${When i read users' information#LAB - Per Mille Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Buyback Discount</con:name>
              <con:value>${When i read users' information#LAB - Buyback Discount}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API LIFE</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL</con:name>
              <con:value>${#TestCase#SHEET_ACLA}</con:value>
            </con:property>
            <con:property>
              <con:name>API LABL</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL Error</con:name>
              <con:value>${#TestCase#DIFF_ACLA}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API Pol Fee</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="2ca03ba1-6f7c-4206-9db8-e002b6f6e3c8">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="88cf3007-fd9f-4b9e-9c6b-fa6747d37c57">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="29d39a22-8bd4-47d0-9afa-0d6f0ba0f284">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMzNzg2NjA1LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMzc5MDIwNSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImIxYzQ0ZDUxLWJiZDEtNGE4Ny04NTgyLTExZjBjNGRhOThmNSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.bun9dzv-Twhecn6M9evBmVUMC928DcAiYw7kkUZx_tYBncmFfd_LTQHLGQSzdOAZkQH6W6UcQgCiK-oPeDMg_G77DBXILlNmHUEqQW9J8P-KCcV4l5mnW2p_IN0eBMjl6PDIknCFMUl1Ydh_fFOICXFEXuWykLSG7b3yRiFCioc</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>09/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Weekly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Unemployed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>30</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">10.42</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>1.42</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>20.24</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>54.43</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>27.03</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SLAB</con:name>
          <con:value>470.28</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SCLA</con:name>
          <con:value>1898.88</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SCLA</con:name>
          <con:value>1547.83</con:value>
        </con:property>
        <con:property>
          <con:name>test</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>LABLOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ACLA</con:name>
          <con:value>8.4</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ACLA</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LPRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e44e1505-5a5b-48b9-a76f-efb2a39dcd3a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f6ef3818-bbdc-4982-afc1-e7b78c412b2a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="d864fc5a-e8de-4385-a1d4-cdc115f564f8" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="ATPD_ACLA(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="d4586634-78b8-4bd4-8be3-9cf927e0dee3">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="9683bf59-14b2-449c-8b6b-844ebd90b29d">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="f0db2093-db46-4b51-84dc-381094479668">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="ef69b6c5-c6a5-44cd-bb61-0a2e935708f2">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="7db3c370-e6f4-49cc-b79d-046d01c4dcb7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="cdfaff35-39cc-439b-addf-5c7bde63aefc">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/ATPD_ACLA.xlsx</file>
              <worksheet>ATPD</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>TPD - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life - Business Safeguard Sum Assured</con:property>
          <con:property>Living Assurance - Accel</con:property>
          <con:property>LABL - Premium Options</con:property>
          <con:property>LAB - Loading</con:property>
          <con:property>LAB - Per Mille Loading $</con:property>
          <con:property>LAB - Per Mille Loading term</con:property>
          <con:property>TPD Cover - Accel</con:property>
          <con:property>TPDL - Expiry Age</con:property>
          <con:property>TPD - Type</con:property>
          <con:property>TPD - accel type</con:property>
          <con:property>TPD - Loading</con:property>
          <con:property>TPD - Per Mille Loading $</con:property>
          <con:property>TPD - Per Mille Loading term</con:property>
          <con:property>LIFE</con:property>
          <con:property>LABL</con:property>
          <con:property>TPD</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="48a5f1a5-b3e1-45d4-a4a4-21604c765e53">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/ATPD/ACLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="e3b51d57-680d-4d7b-a6e2-15c7528e97b3">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{  
   "Quote":{  
      "PartyRolesInQuote":{  
         "PartyRoleInQuote":[  
            {  
               "Products":{  
                  "Product":[  
                     {  
                        "ProductBenefits":{  
                           "ProductBenefit":[  
                              {  
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"Trauma",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {  
                                          "Values":"Trauma",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"Trauma",
                                 "BenefitCode":"CompLivAss",
                                 "BenefitDescription":"Living Assurance",
                                 "BenefitName":"Accelerated Living Assurance",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"fe5b6b71-c576-4850-bef5-f7951e2195f7",
                                 "isAvailable":true,
                                 "isMain":false,
                                 "LinkType":"A",
                                 "Load":"${#TestCase#ACLA_LOAD}",
                                 "LoadingPerMille":"${When i read users' information#LAB - Per Mille Loading $}",
                                 "LoadingTerm":"${When i read users' information#LAB - Per Mille Loading term}",
                                 "MaxInstancesOfBenefit":"4",
                                 "ParentBenefits":{  
                                    "ParentBenefit":[  
                                       {  
                                          "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                          "BenefitCode":"Life"
                                       }
                                    ]
                                 },
                                 "PremiumOption":"${#TestCase#ACLA_PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":5,
                                 "SumAssured":"${#TestCase#ACLA_SUM_ASSURED}"
                              },
                              {  
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"TPD",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {  
                                          "Values":"TPD",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"TPD",
                                 "BenefitCode":"TPD",
                                 "BenefitDescription":"Accelerated Total Permanent Disablement",
                                 "BenefitName":"Accelerated Total Permanent Disablement",
                                 "BenefitTerm":"${#TestCase#BENEFIT_TERM}",
                                 "BenefitType":"${#TestCase#BENEFIT_TYPE}",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"84d60d6b-5c9b-420b-8ed7-30475a8ad023",
                                 "isAvailable":true,
                                 "isMain":false,
                                 "LinkType":"A",
                                 "Load":"${#TestCase#TPD_LOAD}",
                                 "LoadingPerMille":"${When i read users' information#TPD - Per Mille Loading $}",
                                 "LoadingTerm":"${When i read users' information#TPD - Per Mille Loading term}",
								 "MaxInstancesOfBenefit":"4",
                                 "ParentBenefits":{  
                                    "ParentBenefit":[  
                                       {  
                                          "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                          "BenefitCode":"Life"
                                       }
                                    ]
                                 },
                                 "PremiumOption":"${#TestCase#TPD_PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":13,
                                 "SumAssured":"${#TestCase#TPD_SUM_ASSURED}"
                              },
                              {  
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"Life",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"Life",
                                 "BenefitCode":"Life",
                                 "BenefitDescription":"Life Cover",
                                 "BenefitName":"Life Cover",
                                 "Channel":"SOVHUB",
                                 "ExistingCover":"N",
                                 "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                 "isAvailable":true,
                                 "isIndexed":"${#TestCase#INDEX}",
                                 "isMain":true,
                                 "Load":"${#TestCase#LIFE_LOAD}",
                                 "LoadingPerMille":"${When i read users' information#Life - Loading per mille}",
								 "LoadingTerm":"${When i read users' information#Life - Loading term}",
                                 "MaxInstancesOfBenefit":"4",
                                 "PremiumOption":"${#TestCase#LIFE_PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":1,
                                 "SumAssured":"${#TestCase#LIFE_SUM_ASSURED}"
                              }
                           ]
                        },
                        "Channel":"SOVHUB",
                        "ProductName":"TotalCare Max - Personal",
                        "ProductCode":"TCMP"
                     }
                  ]
               },
               "PartyRoleDetails":{  
                  "Party":{  
                     "selfEmployedGT3Years":"${#TestCase#SEGT3}",
                     "EmploymentStatus":"${#TestCase#EMPLOYMENTSTATUS}",                   
                     "OccupationClass":"${When i read users' information#Occupation Class}",                   
                     "Gender":"${#TestCase#GENDER}",
                     "SmokerStatus":"${#TestCase#SMOKER}",                   
                     "Age":"${When i read users' information#Age}" 
                  },                 
                  "LifeNumber":1
               }
            }
         ]
      },
      "TCMPPolicyFee":"${#TestCase#TCMP_POL_FEE}",
      "PaymentFrequency":"${#TestCase#FREQUENCY}",   
      "QuoteNumber":""
   }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking ATPD, ACLA &amp; Life" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as String

def _acla=context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as String

def _atpd=context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'BenefitPremium\']}' ) as String

double _api_atpd = _atpd?.trim().length()!=0 ? Double.parseDouble(_atpd) : 0.0
double _api_life = _life?.trim().length()!=0 ? Double.parseDouble(_life) : 0.0
double _api_acla = _acla?.trim().length()!=0 ? Double.parseDouble(_acla) : 0.0

def _sheet_atpd = context.expand( '${#TestCase#SHEET_ATPD}' ) as double
def _sheet_acla = context.expand( '${#TestCase#SHEET_ACLA}' ) as double
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_atpd = Math.abs(_api_atpd - _sheet_atpd) as double
def _diff_acla = Math.abs(_api_acla - _sheet_acla) as double
def _diff_life = Math.abs(_api_life - _sheet_life) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_atpd = _diff_atpd.round(2)
_diff_life = _diff_life.round(2)
_diff_acla = _diff_acla.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_life <= tolerance && _diff_acla <= tolerance && _diff_atpd <= tolerance && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="0d8f841d-f6cc-43af-bcb4-58a7a6151da1" name="Checking for Errors">
              <con:configuration>
                <scriptText>def errorMessagesLife = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
def errorMessagesACLA = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\']}')
def errorMessagesATPD = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'ErrorMessages\'][\'ErrorMessage\']}')


assert errorMessagesLife==null || errorMessagesLife==""
assert errorMessagesACLA==null || errorMessagesACLA==""
assert errorMessagesATPD==null || errorMessagesATPD==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="b0cc265e-2ffe-4fe5-a420-1285c3991d45">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/ATPD/ACLA/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="60653ae1-686a-4baf-9fb9-60fe0e61f4ed">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.ATPD.ACLA.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>ATPD</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>Family</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Future Insurability or Business Safeguard</con:name>
              <con:value>No</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Business Safeguard Sum Assured</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>Living Assurance - Accel</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading $</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>LAB - Per Mille Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD Cover - Accel</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPDL - Expiry Age</con:name>
              <con:value>${#TestCase#BENEFIT_TERM}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Type</con:name>
              <con:value>${#TestCase#BENEFIT_TYPE}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - accel type</con:name>
              <con:value>Accel LABL</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Per Mille Loading $</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Per Mille Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API LIFE</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL</con:name>
              <con:value>${#TestCase#SHEET_ACLA}</con:value>
            </con:property>
            <con:property>
              <con:name>API LABL</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LABL Error</con:name>
              <con:value>${#TestCase#DIFF_ACLA}</con:value>
            </con:property>
            <con:property>
              <con:name>ATPD</con:name>
              <con:value>${#TestCase#SHEET_ATPD}</con:value>
            </con:property>
            <con:property>
              <con:name>API ATPD</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>ATPD Error</con:name>
              <con:value>${#TestCase#DIFF_ATPD}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="4effa351-48ba-4fda-803b-e800a5319fef">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="15bd4c64-b7be-46f2-a9a3-daefa2daeea7">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="496570a3-3ddd-441d-bb45-f96dbc6c1f8c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzg2NTg2MSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM4Njk0NjEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI2NDhjNTlhYi1iNTNhLTRkYjQtOWI0Ny0zYWIxYTEzNDhhMDEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.F-Cye9qebuk05QtcAQ8WXJXk8SwC_b_lVqcPUQwlL2HX11YpuXPoCdYqs5vvvtmsw3dYWqIQuEYkWExAPOBFynV8EcNKOxBVOy7erLbVFAoFqxK4Ae4Y3AFR7stJ-yQvRSKOLSwkszWhxx2svMpXpM8-pMMjL8M8Yfqia8L2X9Q</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>10/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Fortnightly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">229.29</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>407.46</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>483.48</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>23.64</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">3+ years</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>OOCC</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>10.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>85.26</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>4929284</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>A</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_MIP</con:name>
          <con:value>7628.4</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_MIP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_STPD</con:name>
          <con:value>17054.2</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_STPD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>TPD_LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>LIFE_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>ACLA_LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>TPD_PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>TPD_REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>LIFE_PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>LIFE_REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>ACLA_PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>ACLA_REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>TPD_SUM_ASSURED</con:name>
          <con:value>544373</con:value>
        </con:property>
        <con:property>
          <con:name>LIFE_SUM_ASSURED</con:name>
          <con:value>834484</con:value>
        </con:property>
        <con:property>
          <con:name>ACLA_SUM_ASSURED</con:name>
          <con:value>803142</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ATPD</con:name>
          <con:value>143.06</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ACLA</con:name>
          <con:value>35.11</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ATPD</con:name>
          <con:value>23.64</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ACLA</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7b97bcd1-0fb9-471a-8a9c-10b206cb944e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7db3c370-e6f4-49cc-b79d-046d01c4dcb7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="8d351256-f12d-4beb-bd0f-bffb2075243f" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="APC(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="bed431d7-b751-44df-b02a-a8762de03b33">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="b6e92ab9-85c7-4775-9ba4-43f5f0e8a0fe">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="ac68855d-cf5e-4520-9dd7-9c8622e841a8">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="05cbd879-4ba3-4641-87eb-6f053df00a19">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="c44d08ee-444a-4c76-935e-1a8e7b517d77">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="fa9f99b2-9890-4f3b-8420-c5cd12d159f2">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/APC.xlsx</file>
              <worksheet>APC</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>SBA - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>ProgressiveCare - Accel</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>SB - Loading</con:property>
          <con:property>SB - Per Mille Loading</con:property>
          <con:property>SB - Per Mille Loading term</con:property>
          <con:property>LIFE</con:property>
          <con:property>SBA</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="7f1564b0-ca77-4e80-a11a-e8ffd1ddab6b">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/APC/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="9fb74cf0-716c-4105-8469-47a8c890fd71">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking SBA" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_sba = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_sba = context.expand( '${#TestCase#SHEET_SBA}' ) as double

def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double
def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_sba = Math.abs(_api_sba - _sheet_sba) as double
def _diff_life = Math.abs(_api_life - _sheet_life) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double

_diff_sba = _diff_sba.round(2)
_diff_life = _diff_life.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

log.info tolerance

assert _diff_sba <= tolerance && _diff_pf <= 0.01
assert _diff_life <= tolerance && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="6c601764-12d9-4db2-9b56-68fb6fd827ac" name="Checking Error">
              <con:configuration>
                <scriptText>//try to catch unexpected error message, which should be null or empty string
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="84d510da-c400-4115-aaf5-abe2ecd6383d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/APC/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="f70dd668-c35b-424e-9d3e-de0f8e58bb97">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.APC.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${When i read users' information#Sex}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${When i read users' information#Smoker}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA - Premium Options</con:name>
              <con:value>${When i read users' information#SBA - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${When i read users' information#Premium Frequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${When i read users' information#Life Cover}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>${When i read users' information#Life - Type}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${When i read users' information#Life - Indexing}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${When i read users' information#Life - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${When i read users' information#Life - Loading per mille}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${When i read users' information#Life - Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>ProgressiveCare - Accel</con:name>
              <con:value>${When i read users' information#ProgressiveCare - Accel}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${When i read users' information#Life - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Loading</con:name>
              <con:value>${When i read users' information#SB - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading</con:name>
              <con:value>${When i read users' information#SB - Per Mille Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading term</con:name>
              <con:value>${When i read users' information#SB - Per Mille Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API LIFE</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA</con:name>
              <con:value>${#TestCase#SHEET_SBA}</con:value>
            </con:property>
            <con:property>
              <con:name>API SBA</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA Error</con:name>
              <con:value>${#TestCase#DIFF_SBA}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API Pol Fee</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="e5dc9a4a-25d0-447d-95ae-df7a2a2cde40">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="e0018a4c-e606-4c21-b573-ffcc30f09f41">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="65f0f702-493d-49d9-9c71-0f461a97c5d1">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzg3MzYyNywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM4NzcyMjcsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiIyZDU2ZjBjMi04MzkwLTRlZjUtYWY2ZC1lZWM1ZGM2ODJmMDMiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.YESs9CTodosGvNIEUpapFK35DjZnStltSKQ8j0-Eb19yQGBSWM13ujSHTVytsn-o9Lcz9fOKFs6Vw-SW5PI7gbTC1xq3nvRGOLydHrA74RWQelO5nCeLOSKnn5Q-_S0REnUnBF0whwAAlT74FDJKMuehAI0Mo-vAguMWnsEv3SU</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>10/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>F</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">34.81</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>89.3</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">&lt; 3 years</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">{
	"Quote": {
		"PartyRolesInQuote": {
			"PartyRoleInQuote": [{
				"Products": {
					"Product": [{
						"ProductBenefits": {
							"ProductBenefit": [{
								"CommissionFactor": "${#TestCase#SHEET_COMMISSION}",
								"AttributeGroups": {
									"AttributeGroup": [{
										"Values": "Trauma",
										"Name": "SumAssuredValidation",
										"Description": "SumAssuredValidation"
									},
									{
										"Values": "Trauma",
										"Name": "OutputDisplay",
										"Description": "OutputDisplay"
									}]
								},
								"BenefitCategory": "Trauma",
								"BenefitCode": "ProgCare",
								"BenefitDescription": "Accelerated Progressive Care",
								"BenefitName": "Accelerated Progressive Care",
								"Channel": "SOVHUB",
								"BenefitId": "9afdff62-2d2a-4b41-a210-df6c21cbfea1",
								"isAvailable": true,
								"isMain": false,
								"LinkType": "A",
								"Load": "${#TestCase#SBLOAD}",
								"LoadingPerMille": "${When i read users' information#SB - Per Mille Loading}",
								"LoadingTerm": "${When i read users' information#SB - Per Mille Loading term}",
								"MaxInstancesOfBenefit": "4",
								"ParentBenefits": {
									"ParentBenefit": [{
										"BenefitId": "3c464b53-dde2-422b-b005-9e268eab51ec",
										"BenefitCode": "Life"
									}]
								},
								"PremiumOption": "${#TestCase#SBA_PRE_OPT}",
								"ProductCode": "TCMP",
								"ProductName": "TotalCare Max - Personal",
								"SortOrder": 4,
								"SumAssured": "${When i read users' information#ProgressiveCare - Accel}"
							},
							{
								"CommissionFactor": "${#TestCase#SHEET_COMMISSION}",
								"AttributeGroups": {
									"AttributeGroup": [{
										"Values": "Life",
										"Name": "OutputDisplay",
										"Description": "OutputDisplay"
									}]
								},
								"BenefitCategory": "Life",
								"BenefitCode": "Life",
								"BenefitDescription": "Life Cover",
								"BenefitName": "Life Cover",
								"Channel": "SOVHUB",
								"ExistingCover": "N",
								"BenefitId": "3c464b53-dde2-422b-b005-9e268eab51ec",
								"isAvailable": true,
								"isIndexed": "${#TestCase#LIFEINDEX}",
								"isMain": true,
								"Load": "${#TestCase#LOAD}",
								"LoadingPerMille": "${When i read users' information#Life - Loading per mille}",
								"LoadingTerm": "${When i read users' information#Life - Loading term}",
								"MaxInstancesOfBenefit": "4",
								"PremiumOption": "${#TestCase#LPRE_OPT}",
								"ProductCode": "TCMP",
								"ProductName": "TotalCare Max - Personal",
								"SortOrder": 1,
								"SumAssured": "${When i read users' information#Life Cover}"
							}]
						},
						"Channel": "SOVHUB",
						"ProductName": "TotalCare Max - Personal",
						"ProductCode": "TCMP"
					}]
				},
				"PartyRoleDetails": {
					"Party": {
						"selfEmployedGT3Years": "${#TestCase#SEGT3}",
						"EmploymentStatus": "${#TestCase#EMPLOYMENTSTATUS}",
						"Salary": null,
						"OccupationClass": "${When i read users' information#Occupation Class}",
						"Occupation": null,
						"Gender": "${#TestCase#GENDER}",
						"SmokerStatus": "${#TestCase#SMOKER}",
						"BirthDate": null,
						"Age": "${When i read users' information#Age}",
						"LastName": "zzz",
						"FirstName": null
					},
					"LifeId": "a552f453-1c48-42f3-be6b-09e118c9c9fb",
					"Id": "a552f453-1c48-42f3-be6b-09e118c9c9fb",
					"LifeNumber": 1
				}
			}]
		},
		"TCMPPolicyFee": "${#TestCase#TCMP_POL_FEE}",
		"PaymentFrequency": "${#TestCase#FREQUENCY}",
		"TotalPremium": null,
		"QuoteNumber": ""
	}
}</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>test</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>SBA_PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>SBA_REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SBASUM_ASSURED</con:name>
          <con:value>24020</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SBA</con:name>
          <con:value>54.49</con:value>
        </con:property>
        <con:property>
          <con:name>SBLOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LPRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SBA</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>UNEXPECTED_ERROR</con:name>
          <con:value>Invalid Sum Assured for progressive care  instances. [Total sum assured must be $50k - $1.5m]</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e44e1505-5a5b-48b9-a76f-efb2a39dcd3a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c44d08ee-444a-4c76-935e-1a8e7b517d77</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="b2e2f3bd-8682-40f8-a178-3e78f0705f90" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="APC(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="8a22a21c-8ece-4981-83df-972719ce84ab">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="0b879a1a-4e3f-4a30-8119-47c33e8df760">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="97221f11-c6ac-4909-a10c-73b163c83e13">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="f06251df-814a-4f1c-9e98-18d2097192c2">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="86053101-32ca-460b-b9a8-81b6b04e4235">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="5c2d89c4-ed42-44ba-90fa-bea658a7d120">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/APC.xlsx</file>
              <worksheet>APC</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>SBA - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>ProgressiveCare - Accel</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>SB - Loading</con:property>
          <con:property>SB - Per Mille Loading</con:property>
          <con:property>SB - Per Mille Loading term</con:property>
          <con:property>LIFE</con:property>
          <con:property>SBA</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="96c816a1-c726-4fb9-8b53-9e05a9153ba4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/APC/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="6a350085-e6a6-4e5b-8701-fa41895fd769">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking SBA" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _api_sba = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as double
def _sheet_sba = context.expand( '${#TestCase#SHEET_SBA}' ) as double

def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double
def _api_life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_sba = Math.abs(_api_sba - _sheet_sba) as double
def _diff_life = Math.abs(_api_life - _sheet_life) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double

_diff_sba = _diff_sba.round(2)
_diff_life = _diff_life.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

log.info tolerance

assert _diff_sba <= tolerance && _diff_pf <= 0.01
assert _diff_life <= tolerance && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="a8ea65f3-a901-450d-b29c-ce13611970a6" name="Checking Error">
              <con:configuration>
                <scriptText>//try to catch unexpected error message, which should be null or empty string
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="d2dcf3ce-c683-41ba-9a5b-f4d62340cd8e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/APC/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="4c0af6c9-079b-4091-bb38-d787e3e9ca38">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.APC.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${When i read users' information#Sex}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${When i read users' information#Smoker}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA - Premium Options</con:name>
              <con:value>${When i read users' information#SBA - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${When i read users' information#Premium Frequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${When i read users' information#Life Cover}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>${When i read users' information#Life - Type}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${When i read users' information#Life - Indexing}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${When i read users' information#Life - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${When i read users' information#Life - Loading per mille}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${When i read users' information#Life - Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>ProgressiveCare - Accel</con:name>
              <con:value>${When i read users' information#ProgressiveCare - Accel}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${When i read users' information#Life - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Loading</con:name>
              <con:value>${When i read users' information#SB - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading</con:name>
              <con:value>${When i read users' information#SB - Per Mille Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading term</con:name>
              <con:value>${When i read users' information#SB - Per Mille Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API LIFE</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA</con:name>
              <con:value>${#TestCase#SHEET_SBA}</con:value>
            </con:property>
            <con:property>
              <con:name>API SBA</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA Error</con:name>
              <con:value>${#TestCase#DIFF_SBA}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API Pol Fee</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
            <con:property>
              <con:name>Unexpected Error</con:name>
              <con:value>${#TestCase#UNEXPECTED_ERROR}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="02495efd-22e1-415e-b1e5-9a30538a01ba">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="7eda3a05-7191-4c12-bdc7-9848a82a23f8">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="b69c3d12-f1ef-4454-a2f9-629590881da2">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzg2MzQ0Miwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM4NjcwNDIsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJiNDA4MzMzOS1jMDZlLTQ4OGItYTE0ZC04NDlkZTM4NmIwNjkiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.WXI4irdElHCV07RCBAtLUldJeesq2XkzdDMGsOdwjYDbfTLRyxk9fNHPKVsrsYEXm3qaPT0B7p-80Y3fiSFFtciNeahqqsAmQklmJgnSJ5RlemU8vGoSkwo8b171bfSgWLBXqUefSCblWeS8kE7zZLuah66HfoOImzTdArB0xEs</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>10/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Unemployed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>40</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">1822.68</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>4211.4</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">true</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">{
	"Quote": {
		"PartyRolesInQuote": {
			"PartyRoleInQuote": [{
				"Products": {
					"Product": [{
						"ProductBenefits": {
							"ProductBenefit": [{
								"CommissionFactor": "${#TestCase#SHEET_COMMISSION}",
								"AttributeGroups": {
									"AttributeGroup": [{
										"Values": "Trauma",
										"Name": "SumAssuredValidation",
										"Description": "SumAssuredValidation"
									},
									{
										"Values": "Trauma",
										"Name": "OutputDisplay",
										"Description": "OutputDisplay"
									}]
								},
								"BenefitCategory": "Trauma",
								"BenefitCode": "ProgCare",
								"BenefitDescription": "Accelerated Progressive Care",
								"BenefitName": "Accelerated Progressive Care",
								"Channel": "SOVHUB",
								"BenefitId": "9afdff62-2d2a-4b41-a210-df6c21cbfea1",
								"isAvailable": true,
								"isMain": false,
								"LinkType": "A",
								"Load": "${#TestCase#SBLOAD}",
								"LoadingPerMille": "${When i read users' information#SB - Per Mille Loading}",
								"LoadingTerm": "${When i read users' information#SB - Per Mille Loading term}",
								"MaxInstancesOfBenefit": "4",
								"ParentBenefits": {
									"ParentBenefit": [{
										"BenefitId": "3c464b53-dde2-422b-b005-9e268eab51ec",
										"BenefitCode": "Life"
									}]
								},
								"PremiumOption": "${#TestCase#SBA_PRE_OPT}",
								"ProductCode": "TCMP",
								"ProductName": "TotalCare Max - Personal",
								"SortOrder": 4,
								"SumAssured": "${When i read users' information#ProgressiveCare - Accel}"
							},
							{
								"CommissionFactor": "${#TestCase#SHEET_COMMISSION}",
								"AttributeGroups": {
									"AttributeGroup": [{
										"Values": "Life",
										"Name": "OutputDisplay",
										"Description": "OutputDisplay"
									}]
								},
								"BenefitCategory": "Life",
								"BenefitCode": "Life",
								"BenefitDescription": "Life Cover",
								"BenefitName": "Life Cover",
								"Channel": "SOVHUB",
								"ExistingCover": "N",
								"BenefitId": "3c464b53-dde2-422b-b005-9e268eab51ec",
								"isAvailable": true,
								"isIndexed": "${#TestCase#LIFEINDEX}",
								"isMain": true,
								"Load": "${#TestCase#LOAD}",
								"LoadingPerMille": "${When i read users' information#Life - Loading per mille}",
								"LoadingTerm": "${When i read users' information#Life - Per Mille Loading term}",
								"MaxInstancesOfBenefit": "4",
								"PremiumOption": "${#TestCase#LPRE_OPT}",
								"ProductCode": "TCMP",
								"ProductName": "TotalCare Max - Personal",
								"SortOrder": 1,
								"SumAssured": "${When i read users' information#Life Cover}"
							}]
						},
						"Channel": "SOVHUB",
						"ProductName": "TotalCare Max - Personal",
						"ProductCode": "TCMP"
					}]
				},
				"PartyRoleDetails": {
					"Party": {
						"selfEmployedGT3Years": "${#TestCase#SEGT3}",
						"EmploymentStatus": "${#TestCase#EMPLOYMENTSTATUS}",
						"Salary": null,
						"OccupationClass": "${When i read users' information#Occupation Class}",
						"Occupation": null,
						"Gender": "${#TestCase#GENDER}",
						"SmokerStatus": "${#TestCase#SMOKER}",
						"BirthDate": null,
						"Age": "${When i read users' information#Age}",
						"LastName": "zzz",
						"FirstName": null
					},
					"LifeId": "a552f453-1c48-42f3-be6b-09e118c9c9fb",
					"Id": "a552f453-1c48-42f3-be6b-09e118c9c9fb",
					"LifeNumber": 1
				}
			}]
		},
		"TCMPPolicyFee": "${#TestCase#TCMP_POL_FEE}",
		"PaymentFrequency": "${#TestCase#FREQUENCY}",
		"TotalPremium": null,
		"QuoteNumber": ""
	}
}</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>test</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>SBA_PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>SBA_REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SBASUM_ASSURED</con:name>
          <con:value>424715</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SBA</con:name>
          <con:value>2388.72</con:value>
        </con:property>
        <con:property>
          <con:name>SBLOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>LPRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SBA</con:name>
          <con:value>0.0</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e44e1505-5a5b-48b9-a76f-efb2a39dcd3a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>86053101-32ca-460b-b9a8-81b6b04e4235</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="beb57fb2-f0ce-4838-aada-9617ff919491" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="ATPD_APC(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="18550ac1-ed34-479c-bf1c-1c3983b0e459">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="ec52ca70-b518-4920-9934-0dc5e8c4b6b6">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="e463a90c-793a-4773-bfc7-e4b125e0abe8">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="6084cb8f-3e3e-41df-95b2-d0935b79e8cb">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="6afcfcc3-7fbe-4d38-929c-77c19a9b9afb">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="453f5d9c-ebb7-46ab-b286-a72666c39203">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/ATPD_APC.xlsx</file>
              <worksheet>ATPD</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>TPD - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>Life Cover</con:property>
          <con:property>Life - Type</con:property>
          <con:property>Life - Indexing</con:property>
          <con:property>Life - Premium Options</con:property>
          <con:property>Life - Loading</con:property>
          <con:property>Life - Loading per mille</con:property>
          <con:property>Life - Loading term</con:property>
          <con:property>Life - Future Insurability or Business Safeguard</con:property>
          <con:property>Life - Business Safeguard Sum Assured</con:property>
          <con:property>ProgressiveCare - Accel</con:property>
          <con:property>SBA - Premium Options</con:property>
          <con:property>SB - Loading</con:property>
          <con:property>SB - Per Mille Loading $</con:property>
          <con:property>SB - Per Mille Loading term</con:property>
          <con:property>TPD Cover - Accel</con:property>
          <con:property>TPDL - Expiry Age</con:property>
          <con:property>TPD - Type</con:property>
          <con:property>TPD - accel type</con:property>
          <con:property>TPD - Loading</con:property>
          <con:property>TPD - Per Mille Loading $</con:property>
          <con:property>TPD - Per Mille Loading term</con:property>
          <con:property>LIFE</con:property>
          <con:property>SBA</con:property>
          <con:property>TPD</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="19a81e7e-f996-4512-a21f-6f330b017844">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/ATPD/APC/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="33371533-e6d9-4e13-a4cf-e3106aa5a606">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{  
   "Quote":{  
      "PartyRolesInQuote":{  
         "PartyRoleInQuote":[  
            {  
               "Products":{  
                  "Product":[  
                     {  
                        "ProductBenefits":{  
                           "ProductBenefit":[  
                              {  
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"Trauma",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {  
                                          "Values":"Trauma",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"Trauma",
                                 "BenefitCode":"ProgCare",
                                 "BenefitDescription":"Accelerated Progressive Care",
                                 "BenefitName":"Accelerated Progressive Care",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"fb6cf427-582a-41f2-a2a8-0a242f0e2fe7",
                                 "isAvailable":true,
                                 "isMain":false,
                                 "LinkType":"A",
                                 "Load":"${#TestCase#APC_LOAD}",
                                 "LoadingPerMille":"${When i read users' information#SB - Per Mille Loading $}",
								 "LoadingTerm":"${When i read users' information#SB - Per Mille Loading term}",
                                 "MaxInstancesOfBenefit":"4",
                                 "ParentBenefits":{  
                                    "ParentBenefit":[  
                                       {  
                                          "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                          "BenefitCode":"Life"
                                       }
                                    ]
                                 },
                                 "PremiumOption":"${#TestCase#APC_PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":4,
                                 "SumAssured":"${#TestCase#APC_SUM_ASSURED}"
                              },
                              {  
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"TPD",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {  
                                          "Values":"TPD",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"TPD",
                                 "BenefitCode":"TPD",
                                 "BenefitDescription":"Accelerated Total Permanent Disablement",
                                 "BenefitName":"Accelerated Total Permanent Disablement",
                                 "BenefitTerm":"${#TestCase#BENEFIT_TERM}",
                                 "BenefitType":"${#TestCase#BENEFIT_TYPE}",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"84d60d6b-5c9b-420b-8ed7-30475a8ad023",
                                 "isAvailable":true,
                                 "isMain":false,
                                 "LinkType":"A",
                                 "Load":"${#TestCase#TPD_LOAD}",
                                 "LoadingPerMille":"${When i read users' information#TPD - Per Mille Loading $}",
                                 "LoadingTerm":"${When i read users' information#TPD - Per Mille Loading term}",
                                 "MaxInstancesOfBenefit":"4",
                                 "ParentBenefits":{  
                                    "ParentBenefit":[  
                                       {  
                                          "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                          "BenefitCode":"Life"
                                       }
                                    ]
                                 },
                                 "PremiumOption":"${#TestCase#TPD_PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":13,
                                 "SumAssured":"${#TestCase#TPD_SUM_ASSURED}"
                              },
                              {  
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"Life",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"Life",
                                 "BenefitCode":"Life",
                                 "BenefitDescription":"Life Cover",
                                 "BenefitName":"Life Cover",
                                 "Channel":"SOVHUB",
                                 "ExistingCover":"N",
                                 "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                 "isAvailable":true,
                                 "isIndexed":"${#TestCase#INDEX}",
                                 "isMain":true,
                                 "Load":"${#TestCase#LIFE_LOAD}",
                                 "LoadingPerMille":"${When i read users' information#Life - Loading per mille}",
								 "LoadingTerm":"${When i read users' information#Life - Loading term}",
                                 "MaxInstancesOfBenefit":"4",
                                 "PremiumOption":"${#TestCase#LIFE_PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":1,
                                 "SumAssured":"${#TestCase#LIFE_SUM_ASSURED}"
                              }
                           ]
                        },
                        "Channel":"SOVHUB",
                        "ProductName":"TotalCare Max - Personal",
                        "ProductCode":"TCMP"
                     }
                  ]
               },
               "PartyRoleDetails":{  
                  "Party":{  
                     "selfEmployedGT3Years":"${#TestCase#SEGT3}",
                     "EmploymentStatus":"${#TestCase#EMPLOYMENTSTATUS}",                         
                     "OccupationClass":"${When i read users' information#Occupation Class}",                       
                     "Gender":"${#TestCase#GENDER}",
                     "SmokerStatus":"${#TestCase#SMOKER}",                      
                     "Age":"${When i read users' information#Age}" 
                  },
                    "LifeNumber":1
               }
            }
         ]
      },
      "TCMPPolicyFee":"${#TestCase#TCMP_POL_FEE}",
      "PaymentFrequency":"${#TestCase#FREQUENCY}",         
      "QuoteNumber":""
   }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking ATPD, APC &amp; Life" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText><![CDATA[def _life = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'BenefitPremium\']}' ) as String

def _apc=context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'BenefitPremium\']}' ) as String

def _atpd=context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'BenefitPremium\']}' ) as String

double _api_atpd = _atpd?.trim().length()!=0 ? Double.parseDouble(_atpd) : 0.0
double _api_life = _life?.trim().length()!=0 ? Double.parseDouble(_life) : 0.0
double _api_apc = _apc?.trim().length()!=0 ? Double.parseDouble(_apc) : 0.0

def _sheet_atpd = context.expand( '${#TestCase#SHEET_ATPD}' ) as double
def _sheet_apc = context.expand( '${#TestCase#SHEET_APC}' ) as double
def _sheet_life = context.expand( '${#TestCase#SHEET_LIFE}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_atpd = Math.abs(_api_atpd - _sheet_atpd) as double
def _diff_apc = Math.abs(_api_apc - _sheet_apc) as double
def _diff_life = Math.abs(_api_life - _sheet_life) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_atpd = _diff_atpd.round(2)
_diff_life = _diff_life.round(2)
_diff_apc = _diff_apc.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_life <= tolerance && _diff_acla <= tolerance && _diff_atpd <= tolerance && _diff_pf <= 0.01]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="0d8f841d-f6cc-43af-bcb4-58a7a6151da1" name="Checking for Errors">
              <con:configuration>
                <scriptText>def errorMessagesLife = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
def errorMessagesACLA = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\']}')
def errorMessagesATPD = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'ErrorMessages\'][\'ErrorMessage\']}')


assert errorMessagesLife==null || errorMessagesLife==""
assert errorMessagesACLA==null || errorMessagesACLA==""
assert errorMessagesATPD==null || errorMessagesATPD==""</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="821a39a8-d1a8-4e80-bd78-3d470dd6babe">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/ATPD/APC/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="b13d2ecc-56d3-4dbc-9609-29fecd1a8201">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.ATPD.APC.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>ATPD</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Age']}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['Gender']}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['SmokerStatus']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['Party']['OccupationClass']}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${#TestCase#SELFEMPLOYED}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PaymentFrequency']}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['CommissionFactor']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Type</con:name>
              <con:value>Family</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Indexing</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['isIndexed']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading per mille</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Future Insurability or Business Safeguard</con:name>
              <con:value>No</con:value>
            </con:property>
            <con:property>
              <con:name>Life - Business Safeguard Sum Assured</con:name>
              <con:value>0</con:value>
            </con:property>
            <con:property>
              <con:name>ProgressiveCare - Accel</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA - Premium Options</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading $</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD Cover - Accel</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPDL - Expiry Age</con:name>
              <con:value>${#TestCase#BENEFIT_TERM}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Type</con:name>
              <con:value>${#TestCase#BENEFIT_TYPE}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - accel type</con:name>
              <con:value>Accel SBA</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Loading</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['Load']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Per Mille Loading $</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['LoadingPerMille']}</con:value>
            </con:property>
            <con:property>
              <con:name>TPD - Per Mille Loading term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['LoadingTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE</con:name>
              <con:value>${#TestCase#SHEET_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>API LIFE</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>LIFE Error</con:name>
              <con:value>${#TestCase#DIFF_LIFE}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA</con:name>
              <con:value>${#TestCase#SHEET_APC}</con:value>
            </con:property>
            <con:property>
              <con:name>API SBA</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>SBA Error</con:name>
              <con:value>${#TestCase#DIFF_APC}</con:value>
            </con:property>
            <con:property>
              <con:name>ATPD</con:name>
              <con:value>${#TestCase#SHEET_ATPD}</con:value>
            </con:property>
            <con:property>
              <con:name>API ATPD</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][2]['BenefitPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>ATPD Error</con:name>
              <con:value>${#TestCase#DIFF_ATPD}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="7ca5d418-e431-4f67-8c6c-c5e537800d30">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="c1682e76-da50-4e5b-b665-82843c70f2bd">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="e9d7670d-0e3d-4a63-b02a-b5ee73be5c0d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzNDIwMTI2Miwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzQyMDQ4NjIsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI2ZWRhNGVlNy0yYWEyLTQ1MDEtODM5MS0xMzY5OGY0NDU1YzMiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.B2zA-b825mmJsgypdfoEA1cAnjVdS8Nq5O19QmKw6B0MZXPpAmCRCiQrdGJPvfAVZoGNo5hmhHpROJMnmHD4ADR6HkH6EoGXL1hih6jwOAv-3OuEmVmvd3Ej-9A4ZwH7NvUSUq8O2oBasb_oAn8Zpi1kdH10lKD2oVGtdErjR2E</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>14/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Yearly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>F</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>INVALID</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>20</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">3530.28</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>73.8</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>7718.64</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>483.48</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>135.45</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>OOCC</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>10.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>85.26</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>4929284</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>A</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_MIP</con:name>
          <con:value>7628.4</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_MIP</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_STPD</con:name>
          <con:value>17054.2</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_STPD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>TPD_LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>LIFE_LOAD</con:name>
          <con:value>150.0</con:value>
        </con:property>
        <con:property>
          <con:name>ACLA_LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>TPD_PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>TPD_REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>LIFE_PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>LIFE_REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>ACLA_PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>ACLA_REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>TPD_SUM_ASSURED</con:name>
          <con:value>128614</con:value>
        </con:property>
        <con:property>
          <con:name>LIFE_SUM_ASSURED</con:name>
          <con:value>414452</con:value>
        </con:property>
        <con:property>
          <con:name>ACLA_SUM_ASSURED</con:name>
          <con:value>803142</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ATPD</con:name>
          <con:value>1590.72</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ACLA</con:name>
          <con:value>35.11</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ATPD</con:name>
          <con:value>21.89</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_ACLA</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>APC_LOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>APC_PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>APC_REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>APC_SUM_ASSURED</con:name>
          <con:value>247287</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_APC</con:name>
          <con:value>2523.84</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_APC</con:name>
          <con:value>113.56</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>866155b4-2e37-41ad-886f-a1d1669710b5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7b97bcd1-0fb9-471a-8a9c-10b206cb944e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7db3c370-e6f4-49cc-b79d-046d01c4dcb7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="90bc6c9e-83f4-4f46-9c54-a541b3070d35" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="SPC(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="cbde6f21-aaa8-4edd-a4dc-932861a9d0af">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="b44af764-7024-4e3c-a1f7-18d30455b91c">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="fe5d3540-cff5-492c-84cf-f0dbc664b937">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="068840b6-9686-4f01-8e81-6bb16e4cada6">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="71f279ed-d092-40e5-8cee-9d6659ffe1dd">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/SPC.xlsx</file>
              <worksheet>SPC</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>SB - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>ProgressiveCare - SA</con:property>
          <con:property>SB - SA Index</con:property>
          <con:property>SB - Loading</con:property>
          <con:property>SB - Per Mille Loading $</con:property>
          <con:property>SB - Per Mille Loading term</con:property>
          <con:property>SBS</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="a47468d4-d422-466b-ae08-891a47604ea6">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="f6cc1931-2831-4ff5-b41f-f7cdf34b42e2">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/SPC/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="c5cd136b-5e2a-4f6f-aa57-3f4a029136f3">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
   "Quote":{
      "PartyRolesInQuote":{
         "PartyRoleInQuote":[
            {
               "Products":{
                  "Product":[
                     {
                        "ProductBenefits":{
                           "ProductBenefit":[
                              {
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{
                                    "AttributeGroup":[
                                       {
                                          "Values":"Trauma",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {
                                          "Values":"Trauma",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"Trauma",
                                 "BenefitCode":"ProgCare",
                                 "BenefitDescription":"Progressive Care",
                                 "BenefitName":"Progressive Care",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"2e45719c-9f0f-487b-a161-64f67964580b",
                                 "isAvailable":true,
                                 "isIndexed":"${#TestCase#SPCINDEX}",
                                 "isMain":true,
                                 "LinkType":"S",
                                 "Load":"${#TestCase#SPCLOAD}",
                                 "LoadingPerMille":"${When i read users' information#SB - Per Mille Loading $}",
                                 "LoadingTerm" : "${When i read users' information#SB - Per Mille Loading term}",
                                 "MaxInstancesOfBenefit":"1",
                                 "PremiumOption":"${#TestCase#PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":4,
                                 "SumAssured":"${When i read users' information#ProgressiveCare - SA}"
                              }
                           ]
                        },
                        "Channel":"SOVHUB",
                        "ProductName":"TotalCare Max - Personal",
                        "ProductCode":"TCMP"
                     }
                  ]
               },
               "PartyRoleDetails":{
                  "Party":{
                     "selfEmployedGT3Years":"${#TestCase#SEGT3}",
                     "EmploymentStatus":"${#TestCase#EMPLOYMENTSTATUS}",
                     "Salary":null,
                     "OccupationClass":"${When i read users' information#Occupation Class}",
                     "Occupation":null,
                     "Gender":"${#TestCase#GENDER}",
                     "SmokerStatus":"${#TestCase#SMOKER}",
                     "BirthDate":null,
                     "Age":"${When i read users' information#Age}",
                     "LastName":"zzz",
                     "FirstName":null
                  },
                  "LifeId":"a552f453-1c48-42f3-be6b-09e118c9c9fb",
                  "Id":"a552f453-1c48-42f3-be6b-09e118c9c9fb",
                  "LifeNumber":1
               }
            }
         ]
      },
      "TCMPPolicyFee":"${#TestCase#TCMP_POL_FEE}",
      "PaymentFrequency":"${#TestCase#FREQUENCY}",
      "TotalPremium":null,
      "QuoteNumber":"e0168fc3-c396-406d-85dc-702f82d59bab"
   }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking SPC" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText>def _api_spc = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'PartyRoleDetails\'][\'LifeAssuredPremium\']}' ) as double

def _sheet_spc = context.expand( '${#TestCase#SHEET_SPC}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_spc = Math.abs(_api_spc - _sheet_spc) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_spc = _diff_spc.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_spc &lt;= tolerance &amp;&amp; _diff_pf &lt;= 0.01
//try to catch unexpected error message, which should be null
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="fe4384ee-adee-4f9a-a1d6-19e00f6809bc">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/SPC/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="54a0d950-fdd9-4529-ac50-a3be9c06caf7">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.SPC.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${When i read users' information#Sex}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${When i read users' information#Smoker}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Premium Options</con:name>
              <con:value>${When i read users' information#SB - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${When i read users' information#Premium Frequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${When i read users' information#Commission Adjustment}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>ProgressiveCare - SA</con:name>
              <con:value>${When i read users' information#ProgressiveCare - SA}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - SA Index</con:name>
              <con:value>${When i read users' information#SB - SA Index}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Loading</con:name>
              <con:value>${When i read users' information#SB - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading</con:name>
              <con:value>${When i read users' information#SB - Per Mille Loading $}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading term</con:name>
              <con:value>${When i read users' information#SB - Per Mille Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>SBS</con:name>
              <con:value>${#TestCase#SHEET_SPC}</con:value>
            </con:property>
            <con:property>
              <con:name>API SBS</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['LifeAssuredPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>SBS Error</con:name>
              <con:value>${#TestCase#DIFF_SPC}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="bda4b2ba-7a00-4d2e-897d-2f1cab2bd8d9">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="af01ef21-f000-4eaf-9489-63749af4d7bc">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="8eb3bae3-29b2-4627-9a7b-83c1b6c64a28">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzNDIxODU2OCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzQyMjIxNjgsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI3MTg3MTM2Mi1lOGRlLTQzYzktOGU1Mi1jYTVjNzliMmI1OGUiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.bAH5x36c_Lr22Q5UynkNC63pYzmhQv0eGCqowDW91xDDZeaUud1lfmzN2Qu5D29C8k4Gh_Xa9NiDtbFcy7x7pUf4XCO3Ut-fZuUUe19dsOv0QTyVK-Wy73l8VZkHb19VvJJlQEb9HNme8-qTtQiSY1gEhvk3He60MM0DwFzr99k</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>14/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Fortnightly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>2.84</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>23.18</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">No</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>54.43</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>27.03</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SLAB</con:name>
          <con:value>470.28</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SCLA</con:name>
          <con:value>61.28</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SCLA</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SPCINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>SPCLOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SPC</con:name>
          <con:value>20.34</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SPC</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>UNEXPECTED_ERROR</con:name>
          <con:value/>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e44e1505-5a5b-48b9-a76f-efb2a39dcd3a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b892654e-fdc0-4d54-9551-5632c2eda235</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="aac0e84d-583f-470a-a077-9d04551f9906" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="SPC(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="f1ad48da-3ad6-4533-acc6-bd4f54f66c81">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="1153dae2-42a6-4da2-8aee-e70d1c62f40e">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="00f6dd9c-3fab-4b43-a3d4-822a5df73221">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="597174ec-3d1e-4e35-a261-e81ce55af801">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="a40c49b8-b1db-40c0-9bc1-89442118947c">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/SPC.xlsx</file>
              <worksheet>SPC</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Sex</con:property>
          <con:property>Smoker</con:property>
          <con:property>SB - Premium Options</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Premium Frequency</con:property>
          <con:property>Commission Adjustment</con:property>
          <con:property>Policy Fee</con:property>
          <con:property>ProgressiveCare - SA</con:property>
          <con:property>SB - SA Index</con:property>
          <con:property>SB - Loading</con:property>
          <con:property>SB - Per Mille Loading $</con:property>
          <con:property>SB - Per Mille Loading term</con:property>
          <con:property>SBS</con:property>
          <con:property>Pol Fee</con:property>
          <con:property>Total</con:property>
          <con:startRow>${#TestCase#START_ROW}</con:startRow>
          <con:endRow>${#TestCase#END_ROW}</con:endRow>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And I set the start_row and end_row" id="b808fe3c-8e86-43c1-aa9c-2cabb7839801">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Smoke/And I set the start_row and end_row.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="f5b4d278-3767-410f-9afd-8f48da5af1fd">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/SPC/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="4e76f96d-73c1-4571-a98e-ea15ffa25434">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
   "Quote":{
      "PartyRolesInQuote":{
         "PartyRoleInQuote":[
            {
               "Products":{
                  "Product":[
                     {
                        "ProductBenefits":{
                           "ProductBenefit":[
                              {
                                 "CommissionFactor":"${#TestCase#SHEET_COMMISSION}",
                                 "AttributeGroups":{
                                    "AttributeGroup":[
                                       {
                                          "Values":"Trauma",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {
                                          "Values":"Trauma",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"Trauma",
                                 "BenefitCode":"ProgCare",
                                 "BenefitDescription":"Progressive Care",
                                 "BenefitName":"Progressive Care",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"2e45719c-9f0f-487b-a161-64f67964580b",
                                 "isAvailable":true,
                                 "isIndexed":"${#TestCase#SPCINDEX}",
                                 "isMain":true,
                                 "LinkType":"S",
                                 "Load":"${#TestCase#SPCLOAD}",
                                 "LoadingPerMille":"${When i read users' information#SB - Per Mille Loading $}",
                                 "LoadingTerm" : "${When i read users' information#SB - Per Mille Loading term}",
                                 "MaxInstancesOfBenefit":"1",
                                 "PremiumOption":"${#TestCase#PRE_OPT}",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":4,
                                 "SumAssured":"${When i read users' information#ProgressiveCare - SA}"
                              }
                           ]
                        },
                        "Channel":"SOVHUB",
                        "ProductName":"TotalCare Max - Personal",
                        "ProductCode":"TCMP"
                     }
                  ]
               },
               "PartyRoleDetails":{
                  "Party":{
                     "selfEmployedGT3Years":"${#TestCase#SEGT3}",
                     "EmploymentStatus":"${#TestCase#EMPLOYMENTSTATUS}",
                     "Salary":null,
                     "OccupationClass":"${When i read users' information#Occupation Class}",
                     "Occupation":null,
                     "Gender":"${#TestCase#GENDER}",
                     "SmokerStatus":"${#TestCase#SMOKER}",
                     "BirthDate":null,
                     "Age":"${When i read users' information#Age}",
                     "LastName":"zzz",
                     "FirstName":null
                  },
                  "LifeId":"a552f453-1c48-42f3-be6b-09e118c9c9fb",
                  "Id":"a552f453-1c48-42f3-be6b-09e118c9c9fb",
                  "LifeNumber":1
               }
            }
         ]
      },
      "TCMPPolicyFee":"${#TestCase#TCMP_POL_FEE}",
      "PaymentFrequency":"${#TestCase#FREQUENCY}",
      "TotalPremium":null,
      "QuoteNumber":"e0168fc3-c396-406d-85dc-702f82d59bab"
   }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" name="Checking SPC" id="ac887459-633d-4052-a57b-f10343e3666b">
              <con:configuration>
                <scriptText>def _api_spc = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'PartyRoleDetails\'][\'LifeAssuredPremium\']}' ) as double

def _sheet_spc = context.expand( '${#TestCase#SHEET_SPC}' ) as double

def _frequency = context.expand( '${#TestCase#FREQUENCY}' ) as String

def _sheet_pf = context.expand( '${#TestCase#SHEET_PF}' ) as double
def _api_pf = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PolicyFee\']}' ) as double

def _sheet_total = context.expand( '${#TestCase#SHEET_TOTAL}' ) as double
def _api_total = context.expand( '${And i get premium#Response#$[\'Quote\'][\'TotalPremium\']}' ) as double

def _diff_spc = Math.abs(_api_spc - _sheet_spc) as double
def _diff_pf = Math.abs(_api_pf - _sheet_pf) as double
def _diff_total = Math.abs(_api_total - _sheet_total) as double


_diff_spc = _diff_spc.round(2)
_diff_pf=_diff_pf.round(2)
_diff_total=_diff_total.round(2)

double tolerance = context.expand( '${#TestCase#FREQUENCY}' ) == "Yearly" ? 0.12 : 0.01

assert _diff_spc &lt;= tolerance &amp;&amp; _diff_pf &lt;= 0.01
//try to catch unexpected error message, which should be null
def unexpectedResponse = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
assert (unexpectedResponse == null ||unexpectedResponse == "")</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="6419c2d7-5718-4a26-beab-54faf9739de5">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Pricing.Products.and.Benefits/SPC/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="d3aedddc-5e99-4667-b5fe-2bb869d6d1e9">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Pricing.SPC.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.xlsx</outfile>
              <worksheet>API</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Sex</con:name>
              <con:value>${When i read users' information#Sex}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${When i read users' information#Smoker}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Premium Options</con:name>
              <con:value>${When i read users' information#SB - Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Frequency</con:name>
              <con:value>${When i read users' information#Premium Frequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Commission Adjustment</con:name>
              <con:value>${When i read users' information#Commission Adjustment}</con:value>
            </con:property>
            <con:property>
              <con:name>Policy Fee</con:name>
              <con:value>${When i read users' information#Policy Fee}</con:value>
            </con:property>
            <con:property>
              <con:name>ProgressiveCare - SA</con:name>
              <con:value>${When i read users' information#ProgressiveCare - SA}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - SA Index</con:name>
              <con:value>${When i read users' information#SB - SA Index}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Loading</con:name>
              <con:value>${When i read users' information#SB - Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading</con:name>
              <con:value>${When i read users' information#SB - Per Mille Loading $}</con:value>
            </con:property>
            <con:property>
              <con:name>SB - Per Mille Loading term</con:name>
              <con:value>${When i read users' information#SB - Per Mille Loading term}</con:value>
            </con:property>
            <con:property>
              <con:name>SBS</con:name>
              <con:value>${#TestCase#SHEET_SPC}</con:value>
            </con:property>
            <con:property>
              <con:name>API SBS</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['PartyRoleDetails']['LifeAssuredPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>SBS Error</con:name>
              <con:value>${#TestCase#DIFF_SPC}</con:value>
            </con:property>
            <con:property>
              <con:name>Pol Fee</con:name>
              <con:value>${#TestCase#SHEET_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>API PF</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PolicyFee']}</con:value>
            </con:property>
            <con:property>
              <con:name>PF Error</con:name>
              <con:value>${#TestCase#DIFF_PF}</con:value>
            </con:property>
            <con:property>
              <con:name>Total</con:name>
              <con:value>${#TestCase#SHEET_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>API Total</con:name>
              <con:value>${And i get premium#Response#$['Quote']['TotalPremium']}</con:value>
            </con:property>
            <con:property>
              <con:name>Total Error</con:name>
              <con:value>${#TestCase#DIFF_TOTAL}</con:value>
            </con:property>
            <con:property>
              <con:name>PASS</con:name>
              <con:value>${#TestCase#PASS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="671b846f-b2ee-44b7-8bf1-5f9ff1ad3492">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i summarise the result" id="694626a8-3060-4bf7-a863-10a07d0bb041">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Overview.xlsx</file>
              <outfile>./Results/Pricing-${=testRunner.testCase.name}-${=new Date().format('ddMMYYYY')}.Summary.xlsx</outfile>
              <worksheet>Overview</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Run</con:name>
              <con:value>${#Project#RUN}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#Project#PASSED}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail</con:name>
              <con:value>${#Project#FAILED}</con:value>
            </con:property>
            <con:property>
              <con:name>Invalid</con:name>
              <con:value>${#Project#INVALID}</con:value>
            </con:property>
            <con:property>
              <con:name>Start Time</con:name>
              <con:value>${#Project#START}</con:value>
            </con:property>
            <con:property>
              <con:name>End Time</con:name>
              <con:value>${=new Date().format('HH:mm:ss dd/MM/YYYY')}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i highlight the faild cases" id="08591af8-5c17-4648-9a46-26f685eab1e6">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/REPORTING/Then_i_highlight_the_faild_cases.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTM0MjAzNjIyLCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzNDIwNzIyMiwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6Ijc2ZjU2YWIxLTIwMmYtNGI3OS05Y2E0LTFkY2MwMjA5MTZiYiIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.Duf84Sx3I107NNtGDgJO2L37BtWyyFguzNtyGWbBGH7Lh0VNNJmwJjbnCVF5etugTUniBauSx_SxtRaImFqa3O3tSKPD5nN0LFB9_mrN9H4UnPdYEdGyLfAE7AoHDQstCdi-a0lo3vTYlEcVONA8GB-oa5Tfc6oV9rtSjYy1L4c</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>14/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Weekly</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>M</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>1.42</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>70.83</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EXCESS_FACTOR</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TCMP_POL_FEE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">false</con:value>
        </con:property>
        <con:property>
          <con:name>CHILD_COVER</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_ST_CHILD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>LOAD_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SHEET_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>S&amp;T</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_WOP</con:name>
          <con:value>2.01</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_FI</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_ST</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIBENEFITCODE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIFF_PF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_TOTAL</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEETNAME</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">3+ years</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>FIPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>STPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WOPPREMIUMINDEX</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>API_WOP</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>WAITINGPERIOD</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>50.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_DI</con:name>
          <con:value>54.43</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIFF_DI</con:name>
          <con:value>27.03</con:value>
        </con:property>
        <con:property>
          <con:name>SCLAINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>BUYBACK_DISCOUNT</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SLAB</con:name>
          <con:value>470.28</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SCLA</con:name>
          <con:value>61.28</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SCLA</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SPCINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>SPCLOAD</con:name>
          <con:value>100.0</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_SPC</con:name>
          <con:value>69.41</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF_SPC</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>UNEXPECTED_ERROR</con:name>
          <con:value/>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b425f27-72ce-401b-9f85-486af48a6670</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>76f80216-164a-4e46-82e3-b003dffa96a7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4f6acd08-4192-4758-80a3-7f8e12463ff8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bf7dc085-0afe-44dd-a3a2-6fca0f6bde36</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>07a016c4-8e8f-4a50-bfd5-144e2b1b4c3b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e258c140-92e4-42be-a71a-13a68f03da66</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1b8add74-ae42-4691-ab23-911108918a88</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8b2582f1-baad-4c2a-86b9-6e61b6f52c4e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3b76872d-6db5-44d4-a3e7-2aed9ca4a055</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a02c01ff-1504-4883-b53a-b75d1b1de24d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1d86da95-d74b-4cd3-a756-0a757ae27b44</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e253161c-1230-4918-a0b6-3f4e9ee65093</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5576aede-ceb2-4488-9681-ff5256722f43</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba6a11ab-6fff-4f27-80a5-dcd6c62f2ee0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2fcafd2e-0d85-4be5-83dc-c09ebd61bae8</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e0b645b3-979f-41ef-a52b-1a12db12bae3</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c65db60a-1bdc-4def-898d-1609c4fe58e7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1cba34a7-4da6-4f44-b6f5-f051cfac3f1c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02417a72-5efb-4607-93e9-53dd56b46da6</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c512d4ff-bddc-40d8-8b38-bdd5379016ac</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>90e0637e-e861-4417-a2ee-0642bc9c6253</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3e01a933-d8c8-490e-beb8-2626568c198b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0c659f89-6b02-4aae-868f-44b72f964e72</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>88dea154-b344-4ce3-ac80-ac90d08b6e21</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>63684570-a655-44f1-9162-669f53819370</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>1ec77339-847c-4f3d-8f45-9df93e05e989</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>89307ffe-646b-4bc8-9b16-6e5fd9153e18</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>02880862-e92c-4c56-a6d9-321e406fa2eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9a824958-bee1-40e7-bb14-d7b7f481a393</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3bcfa1a1-1b51-492f-88f1-f998057cfe13</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b8061cec-70dc-4d42-a268-c4a238d6120f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>a1208bbd-f856-40bd-98e4-588d43c87559</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c4dd258f-eccb-4b27-90f9-30b884916a92</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>f352058b-762d-40a4-adad-9602de0a8a5c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b2db1a84-d215-497e-a4b9-d053e11a3d8d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be4d851e-715d-4343-b534-7f50b483f582</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e9c01b55-839c-4f1e-900d-8c451666971e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>0879de9e-4aae-43e7-a6c0-410294e45dfa</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b4b3a3df-112e-4572-8f68-b3d1a42fb0ec</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>54127d94-5564-436e-b0e0-1804515e8e3d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>01b24d1b-9567-4e4b-8574-f19c06f5cf10</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e44e1505-5a5b-48b9-a76f-efb2a39dcd3a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b892654e-fdc0-4d54-9551-5632c2eda235</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>SCOPE</con:name>
        <con:value>SOV.Adviser.ValidateEmail</con:value>
      </con:property>
      <con:property>
        <con:name>PROJECT_PATH</con:name>
        <con:value>C:\SOAPUI/</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="7ca9c487-f22b-4de4-89b2-93dd6eb72b7e" name="Validation Rules">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="3ff7eafd-9d17-43b3-a6c9-4a6326102710" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="DI(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="2a9de85c-47de-4ba6-af4a-8bef92de26f3">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="f0f3f5c5-099e-4377-9d78-71502b94ee09">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="6d4e6baa-f26b-43a2-ad58-32e5e976f7cd">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="1c3b9826-9fea-4351-acaa-789aec921066">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="d241c690-1f00-407f-9a2f-f383bb10ffe4">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>DI</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Gender</con:property>
          <con:property>Age</con:property>
          <con:property>Smoker</con:property>
          <con:property>OccClass</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>SumAssured</con:property>
          <con:property>SumAssuredFrequency</con:property>
          <con:property>Indexation</con:property>
          <con:property>PremiumOption</con:property>
          <con:property>BenefitType</con:property>
          <con:property>PaymentPeriod</con:property>
          <con:property>Loading</con:property>
          <con:property>WaitingPeriod</con:property>
          <con:property>MentalHealth</con:property>
          <con:property>PremierOption</con:property>
          <con:property>WoPWaitingPeriod</con:property>
          <con:property>WoPLoading</con:property>
          <con:property>ErrorOnBenefit</con:property>
          <con:property>ExpectedMessage</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="98db5da5-b817-40b8-b457-1118c270988a">
        <con:settings/>
        <con:config>
          <script>/*String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/DI/And_i_refine_the_data.groovy"
evaluate(new File(file))*/
/********************************************************
Desc:   format API input payload read from the spreadsheet.
Date:   26/07/2018
Author: Prathiba Kankanala
********************************************************/

//convert value: NS == No, S == Yes
def smoker = context.expand( '${When i read users\' information#Smoker}' ) as String
//testRunner.testCase.setPropertyValue("SMOKER", (smoker == 'NS') ?  "No" : "Yes")
testRunner.testCase.setPropertyValue("SMOKER", smoker.toString())
//convert value: M == Monthly, W == Weekly, F == Fortnightly, Y == Annual
def premiumFrequency = context.expand( '${When i read users\' information#Premium Frequency}' ) as String
testRunner.testCase.setPropertyValue("FREQUENCY", premiumFrequency)
testRunner.testCase.setPropertyValue("DIINDEX", (context.expand( '${When i read users\' information#Indexation}' ) == 'Y') ? "I" : "L")
//convert value: 1 means 100
def diLoading = context.expand( '${When i read users\' information#Loading}' ) as Double
testRunner.testCase.setPropertyValue("LOAD", (diLoading * 100).toString() )
//convert Premium Opt
//convert Review Term
String _opt = ""
String _term = ""
def diPremiumOptions = context.expand( '${When i read users\' information#PremiumOption}' ) as String
switch(diPremiumOptions)
{
	case ~/.*Rate For Age.*/:
		//_opt = "Rate for Age"
		_opt = "R"
		_term = "1"
		break	
	case~/.*10 Year.*/:
		//_opt = "10 Year"
		_opt = "10"
		_term = "10"
		break
	case~/.*To Age 65.*/:
		//_opt = "To Age 65"
		_opt = "65"
		_term = "65"
		break	
	default:
		_opt = "No Matched Options"
		_term = "No Matched Term"
	
}
testRunner.testCase.setPropertyValue("PRE_OPT", _opt )
testRunner.testCase.setPropertyValue("REVIEW_TERM", _term )

//convert payment period: 1yr == 1 year, 2yrs == 2 years, 5Yrs == 5 years, to age 65 == To Age 65, to age 70=To Age 70
def paymentPeriod = context.expand( '${When i read users\' information#PaymentPeriod}' ) as String
def pp = ""
switch(paymentPeriod)
{
	case "1 year":
		pp = "1Y";
		break;
	case "2 years":
		pp = "2Y";
		break;
	case "5 years":
		pp = "5Y";
		break;
	case "To Age 65":
		pp = "65";
		break;
	case "To Age 70":
		pp = "70";
		break;
}
testRunner.testCase.setPropertyValue("PAYMENT_PERIOD", pp)

//convert Cover type: DI == 1 year, 2yrs == 2 years, 5Yrs == 5 years, to age 65 == To Age 65, to age 70=To Age 70
def benefitType = context.expand( '${When i read users\' information#BenefitType}' ) as String
def bt = ""
switch(benefitType)
{
	case "Indemnity":
		bt = "I";
		break;
	case "Agreed Value":
		bt = "AV";
		break;
	case "Loss of Earnings":
		bt = "LOE";
		break;	
}
testRunner.testCase.setPropertyValue("BENEFIT_TYPE", bt)

//convert values: Y == Yes, N == No
testRunner.testCase.setPropertyValue("MENTAL_HEALTH", (context.expand( '${When i read users\' information#MentalHealth}' ) == 'Y') ? "Yes" : "No")
testRunner.testCase.setPropertyValue("PREMIER_OPTION", (context.expand( '${When i read users\' information#PremierOption}' ) == 'Y') ? "Yes" : "No")
//convert value: 1 means 100
def wopLoading = context.expand( '${When i read users\' information#WoPLoading}' ) as Double
testRunner.testCase.setPropertyValue("WOP_LOAD", (wopLoading * 100).toString() )

def sumAssured = context.expand( '${When i read users\' information#SumAssured}' ) as String
testRunner.testCase.setPropertyValue("SUM_ASSURED", sumAssured )</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="a4178bf0-872c-4cb7-a0c5-9dae87a49a4b">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "false",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "No",
            "EmploymentStatus" : "Employed",           
            "OccupationClass" : "${When i read users' information#OccClass}",            
            "Gender" : "${When i read users' information#Gender}",
            "SmokerStatus" : "${#TestCase#SMOKER}",         
            "Age" : "${When i read users' information#Age}"            
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "${When i read users' information#SumAssuredFrequency}",
                "Load" : "${#TestCase#LOAD}",
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "WaitingPeriod" : "${When i read users' information#WaitingPeriod}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "BenefitType" : "${#TestCase#BENEFIT_TYPE}",
                "MentalHealthLimitation" : "${When i read users' information#MentalHealth}",
                "isIndexed" : "${#TestCase#DIINDEX}",
                "BenefitTerm" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "PremierOption" : "${When i read users' information#PremierOption}",
                "ReviewTerm" : "",                
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : "100"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#WOP_LOAD}",
                "WaitingPeriod" : "${When i read users' information#WoPWaitingPeriod}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",               
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : "100"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="945b9d6c-cfdf-4b3b-ac4e-c3b710d684f6" name="Script Assertion">
              <con:configuration>
                <scriptText>def expectedMessage = context.expand( '${When i read users\' information#ExpectedMessage}' ) as String
def errorOnBenefit = context.expand( '${When i read users\' information#ErrorOnBenefit}' ) as String
def actualMessage

if(errorOnBenefit=="IP")
{
actualMessage=context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
}

if(errorOnBenefit=="WoP")
{
actualMessage=context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
}

assert expectedMessage==actualMessage</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="18ac96f1-3cea-4589-a4fe-4e6ade2f6c61">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/DI/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="1ae158d7-7bbb-4592-88c3-86103bcca416">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.DI.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>DI</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Gender</con:name>
              <con:value>${When i read users' information#Gender}</con:value>
            </con:property>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${#TestCase#SMOKER}</con:value>
            </con:property>
            <con:property>
              <con:name>OccClass</con:name>
              <con:value>${When i read users' information#OccClass}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${When i read users' information#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssured</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssuredFrequency</con:name>
              <con:value>${When i read users' information#SumAssuredFrequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Indexation</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>PremiumOption</con:name>
              <con:value>${#TestCase#PRE_OPT}</con:value>
            </con:property>
            <con:property>
              <con:name>BenefitType</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>PaymentPeriod</con:name>
              <con:value>${When i read users' information#PaymentPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WaitingPeriod</con:name>
              <con:value>${When i read users' information#WoPWaitingPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>MentalHealth</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>PremierOption</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>WoPWaitingPeriod</con:name>
              <con:value>${When i read users' information#WoPWaitingPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>WoPLoading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>Expected Message</con:name>
              <con:value>${When i read users' information#ExpectedMessage}</con:value>
            </con:property>
            <con:property>
              <con:name>Actual Message</con:name>
              <con:value>${#TestCase#ACTUAL_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>RESULT</con:name>
              <con:value>${#TestCase#STATUS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="ac2a7112-0007-45a8-b596-c350278c9fc3">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">"Invalid Occupation Class</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjY0NDYwMSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI2NDgyMDEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJhODRjOTUzYi01YTY5LTQ1NDctOTk2NC02ZmYwOWYzZmQ2NzkiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.eeUr_Bjv9zRzNm5Nokmb6AzvILLhSIraCOl8rV8KLbFi3oinMaB84dGUXUcOeRChUAuEuP_ibMR5AFzCWZxW9v6nqKa2MjQs__nw-bzYgKggiwZwYZi-m7ovKGoeJ08-Jt2nA7VsteL5Bj_c6MlgBdSK_BWx3_VLoYKwEC3OPts</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>200.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>10</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>2Y</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>AV</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>-1.0</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>3434343</con:value>
        </con:property>
        <con:property>
          <con:name>STATUS</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>ACTUAL_MESSAGE</con:name>
          <con:value>Invalid loading [0..999]</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="7c197be2-e2a3-4b82-a020-f29eac3641d4" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="WoP(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="9eba3b81-2ad0-4398-b002-e1baa21083ce">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="1978c1b1-8205-4ba9-8c8b-b48f8907a72a">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="e1b44adf-2780-439e-b145-7a4eaefea03d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="9dde86ca-87b6-4cbe-82ef-a092508e1d8a">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="4867a736-63bd-4408-a9d5-02a32e64175d">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>WoP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Premium Options</con:property>
          <con:property>Life Indexed</con:property>
          <con:property>Waiver Waiting Period</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="433b2878-a5d7-4417-8919-5deca9081853">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/WoP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="786b6494-9974-433b-a7ac-f96e5bcd0814">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : false,
    "PrvtHlthPolicyFee" : false,
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "PaymentFrequencyHeader" : "p/m",
          "Party" : {
            "EmploymentStatus" : "Employed",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "Male",
            "SmokerStatus" : "No",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "0",
                "LoadingPerMille" : "0.00",
                "LoadingTerm" : "0",
                "isIndexed" : "${When i read users' information#Life Indexed}",
                "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "232323",
                "CompositeCode" : "TCMP_Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Life",
                "CommissionFactor" : 100
              }, {
                "Load" : "023",
                "WaitingPeriod" : "${When i read users' information#Waiver Waiting Period}",
                "isIndexed" : "Level",
                "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "",
                "isOtherBenefit" : true,
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitName" : "Waiver of Premium",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : 100
              } ]
            }
          }, {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "PremiumOption" : "Rate for Age",
                "ExcessFactor" : "0",
                "Load" : "023",
                "CompositeCode" : "PrvtHlth_Hlth",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Hlth",
                "CommissionFactor" : 100
              }, {
                "PremiumOption" : "Rate for Age",
                "Load" : "0",
                "ExcessFactor" : "0",
                "CompositeCode" : "PrvtHlth_HlthPls",
                "BenefitCode" : "HlthPls",
                "BenefitDescription" : "Health Plus",
                "BenefitName" : "Health Plus",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Hlth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "HlthPls",
                "CommissionFactor" : 100
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="04430221-9776-4041-995d-cf9a32c758c5">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/WoP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="33a77a85-076b-4e4e-9994-05e9aa8628c8">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.WoP.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>WoP</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Options</con:name>
              <con:value>${When i read users' information#Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Indexed</con:name>
              <con:value>${When i read users' information#Life Indexed}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Waiting Period</con:name>
              <con:value>${When i read users' information#Waiver Waiting Period}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Benefit Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Eror Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value xsi:nil="true"/>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="06562e48-6ffd-4206-bcaf-adcf975fc656">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMDU2Njk2NCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzA1NzA1NjQsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJhNjBlNzQ2MS0yN2I1LTRjYzMtYmE3Zi01ZjdmNWRmYTZkNDAiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.dt4c21kyFpY7bpnTTPZitcGuza0n2ttkohHElSl0MghE4mBP1bgKWJECHgTe53p18WIQ08k_KUMmIbnJIrn8kcSadp-MzslkvkmGMswpvdKjbqbMy2CfSZtQiXvVzCykKzs75D24o5rbYe9Wj6EL8OTJZXIGYs_6mSHSNGW-2Ic</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>03/07/18</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="ca95b4de-23c7-4c61-a139-4b7d4d1583a5" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="WoP(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="acd02487-a018-4db5-ba96-8097ff0470f7">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="85e6b8d7-8cfe-4903-ab6e-682f9ae5d6d4">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="9b6fc2ab-e43c-4a1a-9fd9-c35160ca515a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="acb78b33-9521-44e9-b508-3df9991829d5">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="595a49bf-f4a6-44ae-9349-91b7e36ac586">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>WoP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Premium Options</con:property>
          <con:property>Life Indexed</con:property>
          <con:property>Waiver Waiting Period</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="6ad18aef-35eb-4b41-8c4b-ec9efb3fb93e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/WoP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="7e2e9ec4-5799-4b3e-8667-d3e18a5672af">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : false,
    "PrvtHlthPolicyFee" : false,
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "PaymentFrequencyHeader" : "p/m",
          "Party" : {
            "EmploymentStatus" : "Employed",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "Male",
            "SmokerStatus" : "No",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "0",
                "LoadingPerMille" : "0.00",
                "LoadingTerm" : "0",
                "isIndexed" : "${When i read users' information#Life Indexed}",
                "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "232323",
                "CompositeCode" : "TCMP_Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Life",
                "CommissionFactor" : 100
              }, {
                "Load" : "023",
                "WaitingPeriod" : "${When i read users' information#Waiver Waiting Period}",
                "isIndexed" : "Level",
                "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "",
                "isOtherBenefit" : true,
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitName" : "Waiver of Premium",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : 100
              } ]
            }
          }, {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "PremiumOption" : "Rate for Age",
                "ExcessFactor" : "0",
                "Load" : "023",
                "CompositeCode" : "PrvtHlth_Hlth",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "Hlth",
                "CommissionFactor" : 100
              }, {
                "PremiumOption" : "Rate for Age",
                "Load" : "0",
                "ExcessFactor" : "0",
                "CompositeCode" : "PrvtHlth_HlthPls",
                "BenefitCode" : "HlthPls",
                "BenefitDescription" : "Health Plus",
                "BenefitName" : "Health Plus",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Hlth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "HlthPls",
                "CommissionFactor" : 100
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="5f136499-e15f-4c15-8221-2a973cc6b72e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/WoP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="291b5910-9289-4e57-854c-5a687cb452a0">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.WoP.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>WoP</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Options</con:name>
              <con:value>${When i read users' information#Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Indexed</con:name>
              <con:value>${When i read users' information#Life Indexed}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Waiting Period</con:name>
              <con:value>${When i read users' information#Waiver Waiting Period}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Payment Period</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['PremiumOption']}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Benefit Term</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['BenefitTerm']}</con:value>
            </con:property>
            <con:property>
              <con:name>Eror Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value xsi:nil="true"/>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="f1568c01-3e7d-4a5f-be94-6c87db340d82">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMwNTY5NTQ4LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMDU3MzE0OCwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImFkNjY3OTlkLThjOWItNGQ4OC04MjA0LTFiMjRiYmM0Y2Q1NyIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.LtVAkFWu0CDzg8FjzR-jXznJ2J8hHB-wzgZcL9K7PvD60pLQnBQW8AeptwZsuMQMBR5pRc-bzCR0AzM_JKXIAlRuFRfPyzK-sHt2dcORCTu7KEaEv1Y2H1-LwN8R0LqNOaLDNPD2HoEM59zNp-M_jJfiojNa0Dk9zyzBGOWg5NY</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>03/07/18</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="ecd7e571-4502-44ff-b1ee-6a6b9b9f649f" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="S&amp;T(DEV)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="87c4ebc4-0bcc-4162-97f1-de4e7bc69237">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="2929e27a-fd31-40f3-b68f-d4a77f3ccd00">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="bd93b436-1eaf-44da-98ce-e1ecd46b931a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="0cd5772e-c5bd-4824-87a8-559d7ae172cf">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="85d1036a-02ef-4736-9fd7-71ee42ce3bf2">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>S&amp;T</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Child Cover Included</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Access Factor</con:property>
          <con:property>Child Number</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="5ba293f6-ec78-40f5-8850-09d07f8fe479">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/S&amp;T/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="7d2110a5-584a-40d6-b450-0325b2e4f889">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "No",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "Party" : {
            "selfEmployedGT3Years" : "false",
            "OccupationClass" : "4",
            "Gender" : "M",
            "SmokerStatus" : "NS",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCode" : "Life",
                "ReviewTerm" : "",
                "SumAssured" : "${When i read users' information#Sum Assured}",
                "PremiumOption" : "65",
                "Load" : "200.0",
                "isIndexed" : "L",
                "LoadingTerm" : "9",
                "LoadingPerMille" : "1",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "20"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "${When i read users' information#Child Number}",
                "Load" : "100.0",
                "PremiumOption" : "",
                "ExcessFactor" : "${When i read users' information#Access Factor}",
                "ChildCover" : "${When i read users' information#Child Cover Included}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "20"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="a5150fb3-09b5-4c6e-a9a8-b3d95d249d77">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/S&amp;T/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="e8caa858-1176-45d5-b846-417764179085">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.S&amp;T.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>S&amp;T</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Cover Included</con:name>
              <con:value>${When i read users' information#Child Cover Included}</con:value>
            </con:property>
            <con:property>
              <con:name>Sum Assured</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>Access Factor</con:name>
              <con:value>${When i read users' information#Access Factor}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Number</con:name>
              <con:value>${When i read users' information#Child Number}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="05c0ff5d-a16a-40a0-90a9-452b3d55a2a6">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>S&amp;T not allowed without a parent benefit</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjY1NTUzMiwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI2NTkxMzIsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiI3MmJkMDRkOS01YzdjLTRiZWMtYjZhYy1jMGQwNDU1NjY1YWUiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.SWSK8qYxCvfUFmMGSSq79C1dyTEqCQwLGj83T4Vqekfm5slHG_KRUWueYYx542o3rjysxDx6pChMuMMKEP9XF77zRsa8YHO_nvooRGcWjw9liPX9wPBKheLoiv0FF2gjcysD_HnIrqnPzvUSuPvJ3jiLQLMJWL9LuRxM_d4qchc</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="e1febd60-1bc7-4235-801d-8c88ade00897" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="S&amp;T(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="6a7051f9-53cd-443f-bbb2-edabbe1f3e6a">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="8e10e4b7-84dd-4916-8842-cd425f200a73">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="5d1a7dba-9e49-4238-8e1f-5ca0eb023810">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="8e0af21b-49d8-4661-8a0b-3bc0afcf8ebd">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="24569766-c17d-4096-9ee1-627dfd9bd62b">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>S&amp;T</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Child Cover Included</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Access Factor</con:property>
          <con:property>Child Number</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="0524a6d2-3805-4466-a174-b5787e75a4bb">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/S&amp;T/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="9918a0d1-1d13-40d1-a702-1726131c0b83">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "No",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "Party" : {
            "selfEmployedGT3Years" : "false",
            "OccupationClass" : "4",
            "Gender" : "M",
            "SmokerStatus" : "NS",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCode" : "Life",
                "ReviewTerm" : "",
                "SumAssured" : "${When i read users' information#Sum Assured}",
                "PremiumOption" : "65",
                "Load" : "200.0",
                "isIndexed" : "L",
                "LoadingTerm" : "9",
                "LoadingPerMille" : "1",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "20"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "${When i read users' information#Child Number}",
                "Load" : "100.0",
                "PremiumOption" : "",
                "ExcessFactor" : "${When i read users' information#Access Factor}",
                "ChildCover" : "${When i read users' information#Child Cover Included}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "20"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="2b296367-76c5-4e1e-b1d4-0820ab8f8417">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/S&amp;T/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="125c97c9-1f90-4e1d-ac78-1a93c7f54d5c">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.S&amp;T.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>S&amp;T</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Cover Included</con:name>
              <con:value>${When i read users' information#Child Cover Included}</con:value>
            </con:property>
            <con:property>
              <con:name>Sum Assured</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>Access Factor</con:name>
              <con:value>${When i read users' information#Access Factor}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Number</con:name>
              <con:value>${When i read users' information#Child Number}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="3567530e-db2c-4d60-8dec-ff47f6134879">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>S&amp;T not allowed without a parent benefit</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjY1NTM1Miwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI2NTg5NTIsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI4ZDVjNDM2ZC1hNTRkLTQ1NGQtOTI5ZS0xM2Y0NzRiYmQzZTYiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.P2-lH8KbIOok_AgiMWWb6q9Ra_4sLf9vR2MajGI0Huckwy4fU8TN9xmETYOPzpK0Xx8urIsK0jXSqoJEHwikObYDUA5WXfAmD2PqbBEt0xh1HlpVXH7UV7mKYDrDgSVv4Z0S5fbo1xY2lDPfixD77MagyYh89aDx4dxVBe8yqG0</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="5d8f0a20-4ba3-44c6-bcf9-8eb1556095fb" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="S&amp;T(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="da060eab-856f-414a-8595-3a2d44ad8b54">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="9b100605-9e95-43eb-a457-eb18f79f9cbc">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="2fd1fbd1-387d-4271-bb3b-6941bc912d73">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="d9950cbe-8a54-4640-b4f8-744a1c87bebe">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="6182ebec-f1b7-4d8d-842a-7fbdd5446483">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>S&amp;T</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Child Cover Included</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Access Factor</con:property>
          <con:property>Child Number</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="a6fbb2dc-ae63-4bc2-aa2d-40b283cfbfdb">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/S&amp;T/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="eb64673a-6a1b-44f0-b30a-592f2c8db6db">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "No",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "Party" : {
            "selfEmployedGT3Years" : "false",
            "OccupationClass" : "4",
            "Gender" : "M",
            "SmokerStatus" : "NS",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCode" : "Life",
                "ReviewTerm" : "",
                "SumAssured" : "${When i read users' information#Sum Assured}",
                "PremiumOption" : "65",
                "Load" : "200.0",
                "isIndexed" : "L",
                "LoadingTerm" : "9",
                "LoadingPerMille" : "1",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "isMain" : true,
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "20"
              }, {
                "BenefitCode" : "SpecTest",
                "ReviewTerm" : "",
                "NumberOfChildren" : "${When i read users' information#Child Number}",
                "Load" : "100.0",
                "PremiumOption" : "",
                "ExcessFactor" : "${When i read users' information#Access Factor}",
                "ChildCover" : "${When i read users' information#Child Cover Included}",
                "isOtherBenefit" : true,
                "BenefitDescription" : "Specialist &amp; Diagnostic Testing",
                "BenefitName" : "Specialist &amp; Diagnostic Testing",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  } ]
                },
                "isAvailable" : true,
                "BenefitType" : "Life",
                "CommissionFactor" : "20"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="5fed0ea4-fd57-4d2d-9df2-a954f731cdb5">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/S&amp;T/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="d79f5e11-50fe-429c-afc5-ebc224dc41cb">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.S&amp;T.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>S&amp;T</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Cover Included</con:name>
              <con:value>${When i read users' information#Child Cover Included}</con:value>
            </con:property>
            <con:property>
              <con:name>Sum Assured</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>Access Factor</con:name>
              <con:value>${When i read users' information#Access Factor}</con:value>
            </con:property>
            <con:property>
              <con:name>Child Number</con:name>
              <con:value>${When i read users' information#Child Number}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="2385ba0e-981d-4ec3-b599-8f1ec1cfc47f">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>S&amp;T not allowed without a parent benefit</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyNjU1NTQxLCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjY1OTE0MSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImJjYmQ4NTg4LWU1MjMtNDYxNy1hYmQzLWE4ZWI3YmU3ZmIwNCIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.T7mITHm41stpF0FaRwGwwi4JMbXDFaPYBWDG2fwI-AVbSm-6lmtwIyJtMprDsmzhEAbq7pOGUsexiVvT8pPXIUr-DH05BFqSwd64rWyr7iFEXIbu2yW6WS0zL7YoCzEp_ZbwmoA90cZnx4-pNYzbKUVbis2ViyC6Wd_60AEb8bo</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="844151aa-6eb4-492f-95bb-6a5777f53ba9" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="FI(DEV)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="35414135-b0c8-432a-a31f-a873033bdb3e">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="7576bf76-03c7-47ea-9200-7b80a2ba67b5">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="2d61f393-479e-4513-8a7d-8a8796b7733f">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="e19d6bad-fb28-46b3-b87c-bdbc5dec77c8">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="90577c2f-43b6-440c-9469-b583395b1bca">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Premium Options</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="e09f68fc-92bf-4797-bac3-9dd0d3dbc065">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/FI/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="c0c350e6-9f53-4d1e-a1b8-d024e7d441db">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" :"",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "",
          "LifeNumber" : 1,   
          "Party" : {
            "selfEmployedGT3Years" : "false",
            "EmploymentStatus" : "Employed",
            "Salary" : null,
            "OccupationClass" : "4",
             "Gender" : "M",
            "SmokerStatus" : "NS",
            "BirthDate" : null,
            "Age" : "${When i read users' information#Age}"
         
          },
          "LifeId" : ""
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "150",
                "LoadingPerMille" : "1",
                "LoadingTerm" : "3",
                "isIndexed" :  "L",
                 "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "${When i read users' information#Sum Assured}",          
                "ReviewTerm" : "1",  
                "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Life Cover",
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitName" : "Life Cover",
                "CommissionFactor" : "30"
              }, {
                "ReviewTerm" : "1",
                "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "${When i read users' information#Sum Assured}",            
                "isIndexed" :"L",
                "Load" : "150.0",
                "BenefitId" : "",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                    "BenefitCode" : "Life"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Future Insurability",
                "BenefitCode" : "FI",
                "BenefitName" : "Future Insurability"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="38afe075-c101-480a-a59e-9846a2a9581a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/FI/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="11dcb763-3624-4439-99ec-89d3e4d74cfe">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.FI.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Options</con:name>
              <con:value>${When i read users' information#Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Assured</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Assured</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="9185646c-00e6-45f4-bed6-251cc452fe2b">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>Invalid Sum Assured [>=200K]</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjY1ODIzMSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI2NjE4MzEsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiIwZjA5ZmE4MC1kZDA4LTRlZGYtYWZjNC02ZDZlYTdmM2M4N2EiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.Y94bw8P9P7T_pjEFOYO_9K7XyzC8P3Hak2hrCBBIi0eWLZqTPFMVQE7p9k-E_uNsSOUhlm8qBRIQkosZAfLKpNww3ZKAZI2xd--p9EaGi-nnhgUsBi_KcraRe3qzoVCEG387i7mxpo4GnEeUaxK_7o_yWnL0FHLC1j-d04jY-FI</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="6701cbc6-a6c7-46d9-9ae0-855d5074f3e5" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="FI(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="63752a53-70ba-4820-b3ba-91733fb27d9c">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="dc5b2ced-65ce-4aee-8379-5caa10e1481b">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="1a682c7a-3265-4acf-880b-4b3f39e59533">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="f1c93575-450b-498d-9551-4b3169a8f270">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="3783f841-a254-4fda-872e-9ac80df84741">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Premium Options</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="b64b90c3-a97e-464a-b8ef-5bef163a3a6a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/FI/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="fda6cfd9-9293-4c6a-b997-651c0db34852">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" :"",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "",
          "LifeNumber" : 1,   
          "Party" : {
            "selfEmployedGT3Years" : "false",
            "EmploymentStatus" : "Employed",
            "Salary" : null,
            "OccupationClass" : "4",
             "Gender" : "M",
            "SmokerStatus" : "NS",
            "BirthDate" : null,
            "Age" : "${When i read users' information#Age}"
         
          },
          "LifeId" : ""
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "150",
                "LoadingPerMille" : "1",
                "LoadingTerm" : "3",
                "isIndexed" :  "L",
                 "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "${When i read users' information#Sum Assured}",          
                "ReviewTerm" : "1",  
                "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Life Cover",
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitName" : "Life Cover",
                "CommissionFactor" : "30"
              }, {
                "ReviewTerm" : "1",
                "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "${When i read users' information#Sum Assured}",            
                "isIndexed" :"L",
                "Load" : "150.0",
                "BenefitId" : "",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                    "BenefitCode" : "Life"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Future Insurability",
                "BenefitCode" : "FI",
                "BenefitName" : "Future Insurability"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="a7aea76f-098c-4e43-9028-fab86deaaaa5">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/FI/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="644a442b-0864-4d24-aada-b495d8122a49">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.FI.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Options</con:name>
              <con:value>${When i read users' information#Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Assured</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Assured</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="a423a668-5249-4065-833c-79a0722908ad">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>Invalid Sum Assured [>=200K]</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjY1ODMxNiwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI2NjE5MTYsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiIwNmQ2ZDJlMi02YTE4LTQ2MDYtOTk5My02NzVkODUwODFiNzQiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.N6sfc9sXP38OpjCXKxAV4puD0QuDLEelnJ55IgfdW25mGrKgssxwE2dNb_N_iUhBU2huP2Y-aUaHPp_GeWnZViEJXlyNbo1-XOd_NXUK0UdVKFib-p2UR6d9pZPNQq2OQXTnNMvcV79YZW6rxxdThRIdfJn-qZm4ZZMAg-mGzBo</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="aab7cdd8-044b-44be-a3f7-a963045083d2" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="FI(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="8256f573-e1c0-47a9-886c-fbcf2b1609a8">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="e5f6dc74-5d26-4a82-ad57-baf19001edde">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="79fcab7f-9141-4e48-9426-2c09323d2346">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="9738de36-e478-4052-9fde-923bfe10d33d">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="35b07fba-68f2-46f3-81f8-e95da374d3d3">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Premium Options</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="7a0970de-bc8c-4d64-812f-760b03f4442c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/FI/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="a86962e8-c073-483c-bea9-5d69c2265be3">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" :"",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "",
          "LifeNumber" : 1,   
          "Party" : {
            "selfEmployedGT3Years" : "false",
            "EmploymentStatus" : "Employed",
            "Salary" : null,
            "OccupationClass" : "4",
             "Gender" : "M",
            "SmokerStatus" : "NS",
            "BirthDate" : null,
            "Age" : "${When i read users' information#Age}"
         
          },
          "LifeId" : ""
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "Load" : "150",
                "LoadingPerMille" : "1",
                "LoadingTerm" : "3",
                "isIndexed" :  "L",
                 "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "${When i read users' information#Sum Assured}",          
                "ReviewTerm" : "1",  
                "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Life Cover",
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitName" : "Life Cover",
                "CommissionFactor" : "30"
              }, {
                "ReviewTerm" : "1",
                "PremiumOption" : "${When i read users' information#Premium Options}",
                "SumAssured" : "${When i read users' information#Sum Assured}",            
                "isIndexed" :"L",
                "Load" : "150.0",
                "BenefitId" : "",
                "MaxInstancesOfBenefit" : "4",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "a791d9d7-d5ab-4240-821d-9107d76492df",
                    "BenefitCode" : "Life"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Future Insurability",
                "BenefitCode" : "FI",
                "BenefitName" : "Future Insurability"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="3cd54c4d-b8ee-4743-8c24-53341a9d3d02">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/FI/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="45d4cb8c-035e-41c0-bd2b-daf7a10b1d66">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.FI.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>FI</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Options</con:name>
              <con:value>${When i read users' information#Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Assured</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>FI Assured</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][1]['SumAssured']}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="287b3b66-abfa-4a4c-8cdc-5887531f9210">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>Invalid Sum Assured [>200K]</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyNjU4MzM4LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjY2MTkzOCwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6IjczMTU4ZWE3LWI3NzgtNGQ4OS1hY2VjLTkwMGY0MzFmYzk2MCIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.Li4PD3jIJAN5bvaZNYrxGhBcdsepDN0JWG7pzXAPmFdodIjg43cgvbEzx90OBVjDZoqTaDT6rN6COzuiSe-07Y-KXX_LstjLmLujM1ER9fwfYMbTOk9R3MmEjvDej79UrQGsvBlRAs-f6EJLY0KrjAiHaV3Vb2-Slg7J4AFFXR4</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>NO</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="44be67c0-69c7-4bff-81a6-32a413d2f3e8" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(DEV)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="c6f2d2aa-da5e-4c9e-a53a-4ced25b8c6d8">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="2e419fe7-b6f1-46d7-a432-93df21df28d0">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="3f63afd3-0a76-4406-8664-c838e6a40b3a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="d3605a2b-038a-40a6-913f-7a486df6642c">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="8814a569-fbbb-4bec-9509-c0dc4f21bef4">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>Life</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Premium Options</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Per mille</con:property>
          <con:property>Loading Term</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="6b89cd18-e89d-411a-afb2-8a7ae076df7d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Life/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="8b31dc3b-a47f-4d56-899e-78a1ffe4ac53">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "123",
    "PaymentFrequency": "Monthly",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "Rachel",
            "LastName": "Simpson",
            "Age": "${When i read users' information#Age}",
            "BirthDate": "12/06/18",
            "SmokerStatus": "S",
            "Gender": "F",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "isMain": true,
                "PremiumOption": "${When i read users' information#Premium Options}",
                "SumAssured": "${When i read users' information#Sum Assured}",
                "ReviewTerm": "1",
                "Load": "100",
                "BenefitCode": "Life",
                "BenefitType": "Life",
                "LoadingPerMille": "${When i read users' information#Per mille}",
                "LoadingTerm": "${When i read users' information#Loading Term}",
                "isIndexed": "L",
                "CommissionFactor": "80"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="496c6dce-7b06-4287-ae19-54134e6308b3">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Life/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="77f35d07-470a-4283-b25d-505293fe04ab">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.Life.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>Life</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Options</con:name>
              <con:value>${When i read users' information#Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading per mille</con:name>
              <con:value>${When i read users' information#Per mille}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading term</con:name>
              <con:value>${When i read users' information#Loading Term}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="4aae9946-58b6-449f-8634-dc98a7020732">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>Invalid Loading Term [1..99]</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjY1OTAzNywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI2NjI2MzcsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiJmZWViNDcwYS0yMmRmLTRkNTYtOTBkNi04MDM2YWQ2ZDQ0MDEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.WffHbEPmiKXS0Ovpz0nelWzeFbl8fdGZ8J1KMXKPBUa5b1QJyppg6vsx9BtCFGTsry_bQ0X20Q87OA72HPCUiGeptkCrVFN5zYFUD0N36XaKhGDFF2vHPPv8BvxuT9_vPF8dFfRTY8bi8BzAjfAFOxrZ2FX2tv7Neue2zcGOU2c</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="2226ffbb-6d45-4778-b6a4-ea00b8359697" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="37017af4-035e-435e-8cd4-64fc7b118f0f">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="15ee99f9-a53a-4998-bd68-1f4c0c8e45a6">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="14363a39-5f03-45d9-96b6-054c718816e4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="1acd2d97-9766-497d-ad73-b05f30dbb763">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="d4ade65f-4d9f-41cd-9371-df2fadffb41a">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>Life</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Premium Options</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Per mille</con:property>
          <con:property>Loading Term</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="20aa6035-1e43-4c53-8fbe-455ae6b43cf9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Life/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="070c72c3-de8a-4685-a52d-797be9592ffa">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "123",
    "PaymentFrequency": "Monthly",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "Rachel",
            "LastName": "Simpson",
            "Age": "${When i read users' information#Age}",
            "BirthDate": "12/06/18",
            "SmokerStatus": "S",
            "Gender": "F",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "isMain": true,
                "PremiumOption": "${When i read users' information#Premium Options}",
                "SumAssured": "${When i read users' information#Sum Assured}",
                "ReviewTerm": "1",
                "Load": "100",
                "BenefitCode": "Life",
                "BenefitType": "Life",
                "LoadingPerMille": "${When i read users' information#Per mille}",
                "LoadingTerm": "${When i read users' information#Loading Term}",
                "isIndexed": "L",
                "CommissionFactor": "80"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="d5e42706-91a0-420e-9f6f-26f38ef9c493">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Life/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="e2aab19d-9733-40cb-ad48-df5fcc2bf155">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.Life.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>Life</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Options</con:name>
              <con:value>${When i read users' information#Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading per mille</con:name>
              <con:value>${When i read users' information#Per mille}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading term</con:name>
              <con:value>${When i read users' information#Loading Term}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="d371dbad-6801-426e-8ac4-fe1a64978805">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>Invalid Loading Term [1..99]</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjY1ODkwOCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI2NjI1MDgsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJkYjQ2N2E4NS1mNzIxLTQyMWQtOTYxMi03NWRkMjM2NzVjNjIiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.XvsXhf8sldV9-kfCAvpJqNvjRV7POqCxW2shYanctyW9xGEjYNEcICi7lXBZBWQaqo8Mmx9X8FvL7QlfvGuAyhDPSUa6C_kiRhFC2xh4PrSheiH6CZCrw-g8evam-Ium_7krHTHvlUZ8ahrrHmisdyc9NrERjt6zRfhd4PynJhE</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="bb0af620-1c51-425c-8b6c-517b91aba0f6" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="8d4e306c-2a96-43d6-8fb4-f10d3a719b84">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="bf47bcf0-f8af-4bb4-b370-3f0ab8f36850">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="37a84abf-6745-43c4-891a-559a035db21a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="d8331491-527f-4cd2-ad94-4758ca813731">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="4c2b2c5c-62e9-4dc2-9112-9946e0add9f4">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>Life</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Premium Options</con:property>
          <con:property>Sum Assured</con:property>
          <con:property>Per mille</con:property>
          <con:property>Loading Term</con:property>
          <con:property>Error Message</con:property>
          <con:property>API Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="3a676ddf-c75e-4c1a-b90c-d954f488934c">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Life/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="67604a7c-cf03-468d-8238-e27ff57e20a2">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "123",
    "PaymentFrequency": "Monthly",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "FirstName": "Rachel",
            "LastName": "Simpson",
            "Age": "${When i read users' information#Age}",
            "BirthDate": "12/06/18",
            "SmokerStatus": "S",
            "Gender": "F",
            "OccupationClass": "1",
            "EmploymentStatus": "Employed",
            "selfEmployedGT3Years": "false"
          }
        },
        "Products": {
          "Product": {
            "ProductName": "TotalCare Max Personal",
            "ProductCode": "TCMP",
            "Channel": "SOVHUB",
            "ProductBenefits": {
              "ProductBenefit": {
                "BenefitName": "Life Cover",
                "isMain": true,
                "PremiumOption": "${When i read users' information#Premium Options}",
                "SumAssured": "${When i read users' information#Sum Assured}",
                "ReviewTerm": "1",
                "Load": "100",
                "BenefitCode": "Life",
                "BenefitType": "Life",
                "LoadingPerMille": "${When i read users' information#Per mille}",
                "LoadingTerm": "${When i read users' information#Loading Term}",
                "isIndexed": "L",
                "CommissionFactor": "80"
              }
            }
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="bbb598e5-9a6e-4b31-b59e-d571bc026a69">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Life/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="1a2248a5-fe4f-4ec6-8953-24f7110e7ae1">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.Life.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>Life</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Premium Options</con:name>
              <con:value>${When i read users' information#Premium Options}</con:value>
            </con:property>
            <con:property>
              <con:name>Life Cover</con:name>
              <con:value>${When i read users' information#Sum Assured}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading per mille</con:name>
              <con:value>${When i read users' information#Per mille}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading term</con:name>
              <con:value>${When i read users' information#Loading Term}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="5338ed40-cd86-4ee8-970c-d6b6e4879fbe">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>Invalid Loading Term [1..99]</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyNjU5MTQzLCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjY2Mjc0Mywib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImIxOGJiMzBlLTIwYjUtNDc3YS04OTJlLWYxNTJmMTk3ZDkxMyIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.U04iRlVGRavgKF5jP12pux_b5K5JAEGJb3x7DqCpiTZuQORyKSBcJwaS_sT6AYLZfUr_6f4CriE_974u15aHvSCqKNIEDHBHoqNktOZvSquLcQjHCBW6y6xNTONFia-pjLfa7blwbwH3lKV4iSo4UY4s8S8CY1BXKvhJa2SA2oA</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="071cff6c-cfe2-43ed-b8f3-2332ff2db8b2" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Health(DEV)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="48486945-c4da-4313-ae02-f318d2edaeed">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="d9219b24-40d7-4f12-ab26-2496de5f323e">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="27e64757-0c3e-40b9-9f7e-ec596d262bc1">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="142434ce-386a-41a8-b3ef-fb0b758170d5">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="d6bdae9f-c3cf-4259-87bc-23b6eb29bbf0">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>Health</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Max Benefit Instances</con:property>
          <con:property>Load Percentage</con:property>
          <con:property>Excess Factor</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Waiver Waiting Period</con:property>
          <con:property>PW Load Percentage</con:property>
          <con:property>Optional Benefit</con:property>
          <con:property>Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="f3de3775-4ddd-4558-bfca-bfdc1c24e1d4">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Health/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="f34a521a-3ed7-4ec0-8a9a-d3c4f0c721b4">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="f1ca80b3-223e-483d-b9ad-0e773c8a90ac">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Health/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="ea0d29ef-d55a-41f4-bcf6-c446850deb02">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Validation.Health.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>Health</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Max Benefit Instances</con:name>
              <con:value>${When i read users' information#Max Benefit Instances}</con:value>
            </con:property>
            <con:property>
              <con:name>Load Percentage</con:name>
              <con:value>${When i read users' information#Load Percentage}</con:value>
            </con:property>
            <con:property>
              <con:name>Excess Factor</con:name>
              <con:value>${When i read users' information#Excess Factor}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupuation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>PW Load Percent</con:name>
              <con:value>${When i read users' information#PW Load Percentage}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Waiting Period</con:name>
              <con:value>${When i read users' information#Waiver Waiting Period}</con:value>
            </con:property>
            <con:property>
              <con:name>Optional Benefit</con:name>
              <con:value>${When i read users' information#Optional Benefit}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="a30205b7-861e-4e73-b4b9-22bb1eb304db">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value>Invalid loading [0..999]</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMTcwNDg5NCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzE3MDg0OTQsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiI3Zjc4NDcxMi04MDhhLTQ5ZGEtODFlMy05NzY1MmI4MmNjYWYiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.Lg9tLMeSJhruG0LxIBr88jWXvpmQeFH96nmCGuOjuKx-bAKRwGdUm08rdaBq9qSjCxQ5Q-WphZuomeFBw7uADeQECZz_QZRzN4ls92UEhgp_jpUo2LuZCPvU8nyreAm2w1CxU8IqR1EAXeCUbyZ4t8F99cvRxgGnSao7sxnrFCg</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>16/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOY_STATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>HP_BENEFITFLAG</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>HW_BENEFITFLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>HC_BENEFITFLAG</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Yearly",
    "PrvtHlthPolicyFee" : "false",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years": "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOY_STATUS}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "M",
            "SmokerStatus" : "NS",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ 
              {
                "ExcessFactor" : "${When i read users' information#Excess Factor}",
                "Load" : "${When i read users' information#Load Percentage}",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "BenefitCategory" : "Health",
                "MaxInstancesOfBenefit" : "${When i read users' information#Max Benefit Instances}",
                "isAvailable" : true,
                "CommissionFactor" : "20",
                "selfEmployedGT3Years": "No"
              },
              {
                "BenefitDescription" : "Health Waiver of Premium",
                "BenefitName" : "Health Waiver of Premium",
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "isMain" : false,
                "PaymentPeriod" : "",
                "isIndexed" : "I",
                "Load" : "${When i read users' information#PW Load Percentage}",
                "WaitingPeriod" : "${When i read users' information#Waiver Waiting Period}",
                "SumAssured" : "",
                "BenefitTerm" : "65",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ 
			   {
                    "BenefitCode" : "Hlth"
                  }]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "60",
                "selfEmployedGT3Years": "No"
              }]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="a1096760-09f4-4be9-9058-6d57ebcde273" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Health(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="9371fa87-2af3-45ed-8822-5690666aa93c">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="aa5516f9-289f-4d5f-a244-9fdffc94d5c4">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="c903775c-285e-42ba-a1b4-bcc41bb461da">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="d2986209-5050-4131-af2c-240828c772fd">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="e9e593e0-caaf-4ddf-853a-fc2b7bb1357a">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>Health</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Max Benefit Instances</con:property>
          <con:property>Load Percentage</con:property>
          <con:property>Excess Factor</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Waiver Waiting Period</con:property>
          <con:property>PW Load Percentage</con:property>
          <con:property>Be Validated Benefit</con:property>
          <con:property>Error Message</con:property>
          <con:property>HW Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="86b47a45-b2b8-474c-bf2e-a0a11e87341d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Health/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="21670246-17de-4ee1-85cb-9e1f21cb3192">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="5cc7428b-4d08-4387-81ba-38434ed10b83">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Health/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="24feb042-e380-4ee4-9401-c50c8b51db69">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Validation.Health.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>Health</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Max Benefit Instances</con:name>
              <con:value>${When i read users' information#Max Benefit Instances}</con:value>
            </con:property>
            <con:property>
              <con:name>Load Percentage</con:name>
              <con:value>${When i read users' information#Load Percentage}</con:value>
            </con:property>
            <con:property>
              <con:name>Excess Factor</con:name>
              <con:value>${When i read users' information#Excess Factor}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupuation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>PW Load Percent</con:name>
              <con:value>${When i read users' information#PW Load Percentage}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Waiting Period</con:name>
              <con:value>${When i read users' information#Waiver Waiting Period}</con:value>
            </con:property>
            <con:property>
              <con:name>Be Validated Benefit</con:name>
              <con:value>${When i read users' information#Be Validated Benefit}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>HW Error Message</con:name>
              <con:value>${When i read users' information#HW Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="5b4ca9ed-c49f-40ab-b076-8248f58e442c">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMTc3ODQyMiwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzE3ODIwMjIsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJlMjBlMmFmOC03Y2IxLTRhZTAtOWQwNC1iYjgzZWEzNTU0N2MiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.GwLw0ikBt8dYH7FbEVTmCJL1DtIB9-gee6rN-ji08bVQZz2D7ftYu4458x4i_C-7xEQTfq8q0fcks__uMyFNA_vO6rq_TH22ZulL7I4btsiLC36zGXqdKbo3QleSt6AeYSAslnRx58s6m_JYEa6D5KkO5Gchu35P1GxsuMyeRjc</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>17/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOY_STATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>HP_BENEFITFLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>HW_BENEFITFLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>HC_BENEFITFLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Yearly",
    "PrvtHlthPolicyFee" : "false",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years": "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOY_STATUS}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "M",
            "SmokerStatus" : "NS",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ 
              {
                "ExcessFactor" : "${When i read users' information#Excess Factor}",
                "Load" : "${When i read users' information#Load Percentage}",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "BenefitCategory" : "Health",
                "MaxInstancesOfBenefit" : "${When i read users' information#Max Benefit Instances}",
                "isAvailable" : true,
                "CommissionFactor" : "20",
                "selfEmployedGT3Years": "No"
              } ,
			 {
                "CompositeCode" : "PrvtHlth_HlthPls",
                "BenefitCode" : "HlthPls",
                "BenefitDescription" : "Health Plus",
                "BenefitName" : "Health Plus",
                "Load" : "150",
                "ExcessFactor" : "250",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Hlth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "HlthPls",
                "CommissionFactor" : "60",
                "selfEmployedGT3Years": "Yes"
              },
              {
                "BenefitDescription" : "Health Waiver of Premium",
                "BenefitName" : "Health Waiver of Premium",
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "isMain" : false,
                "PaymentPeriod" : "",
                "isIndexed" : "I",
                "Load" : "${When i read users' information#PW Load Percentage}",
                "WaitingPeriod" : "${When i read users' information#Waiver Waiting Period}",
                "SumAssured" : "",
                "BenefitTerm" : "65",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ 
			   {
                    "BenefitCode" : "Hlth"
                  }]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "60",
                "selfEmployedGT3Years": "No"
              }]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="3de8e803-2285-4178-a0f1-7c3875949d6c" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Health(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="f1e81dd5-10d3-4763-9650-2506d2baf12e">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="f828081c-fd03-4c1b-accf-e56af4ba2913">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="752ccbe9-a047-47ef-8092-0fcff0dc6ebc">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="03fc00eb-2c5e-4747-9bd5-7640adb6ec81">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="5a4129f2-66cc-4050-95d3-2cf48ff2b8ad">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>Health</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>Max Benefit Instances</con:property>
          <con:property>Load Percentage</con:property>
          <con:property>Excess Factor</con:property>
          <con:property>Occupation Class</con:property>
          <con:property>Self Employed</con:property>
          <con:property>Waiver Waiting Period</con:property>
          <con:property>PW Load Percentage</con:property>
          <con:property>Be Validated Benefit</con:property>
          <con:property>Error Message</con:property>
          <con:property>HW Error Message</con:property>
          <con:property>Pass</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="79219ab5-60d7-456d-b4b8-45a7dfe09c1b">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Health/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="7e3fa3d5-3add-4c89-bb9d-9014d65942d6">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="c928da25-d3bd-4f1c-ba33-94b138357061">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/Health/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="df2aa660-21a8-4e2c-b58b-c32264cb2ee4">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>Results/Templates/Validation.Health.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>Health</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Max Benefit Instances</con:name>
              <con:value>${When i read users' information#Max Benefit Instances}</con:value>
            </con:property>
            <con:property>
              <con:name>Load Percentage</con:name>
              <con:value>${When i read users' information#Load Percentage}</con:value>
            </con:property>
            <con:property>
              <con:name>Excess Factor</con:name>
              <con:value>${When i read users' information#Excess Factor}</con:value>
            </con:property>
            <con:property>
              <con:name>Occupuation Class</con:name>
              <con:value>${When i read users' information#Occupation Class}</con:value>
            </con:property>
            <con:property>
              <con:name>Self Employed</con:name>
              <con:value>${When i read users' information#Self Employed}</con:value>
            </con:property>
            <con:property>
              <con:name>PW Load Percent</con:name>
              <con:value>${When i read users' information#PW Load Percentage}</con:value>
            </con:property>
            <con:property>
              <con:name>Waiver Waiting Period</con:name>
              <con:value>${When i read users' information#Waiver Waiting Period}</con:value>
            </con:property>
            <con:property>
              <con:name>Be Validated Benefit</con:name>
              <con:value>${When i read users' information#Be Validated Benefit}</con:value>
            </con:property>
            <con:property>
              <con:name>Error Message</con:name>
              <con:value>${When i read users' information#Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>HW Error Message</con:name>
              <con:value>${When i read users' information#HW Error Message}</con:value>
            </con:property>
            <con:property>
              <con:name>API Error Message</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>Pass</con:name>
              <con:value>${#TestCase#PASS_FLAG}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="9d580488-e53d-4992-8f63-0c23cd717594">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMxNzc4NTg5LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMTc4MjE4OSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImZhNjE1NWUzLTU4NDUtNGVmMS1iY2Q1LTVhNGEzNTFiZDBhYSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.GmFUmRgWKuL2HLn0caFkhHETS6n_WtPtCY8C_wcRqSpIid-yrV4V06PcqB0o-v-3tgyDdDgaqqRmUdBZGVpSVdSMyMNVRos880-U2JG1DUHsxcA2HB_N3K8P7dfnh0qTeiZ9oStBmvq9uqt7oaV8wurJHU9IUcKTnd283g9tHmQ</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>17/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>PASS_FLAG</con:name>
          <con:value>NO</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOY_STATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>HP_BENEFITFLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>HW_BENEFITFLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>HC_BENEFITFLAG</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Yearly",
    "PrvtHlthPolicyFee" : "false",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years": "${#TestCase#SEGT3}",
            "EmploymentStatus" : "${#TestCase#EMPLOY_STATUS}",
            "OccupationClass" : "${When i read users' information#Occupation Class}",
            "Gender" : "M",
            "SmokerStatus" : "NS",
            "Age" : "${When i read users' information#Age}"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "PrvtHlth",
            "Channel" : "SOVHUB",
            "ProductName" : "Private Health",
            "ProductBenefits" : {
              "ProductBenefit" : [ 
              {
                "ExcessFactor" : "${When i read users' information#Excess Factor}",
                "Load" : "${When i read users' information#Load Percentage}",
                "BenefitCode" : "Hlth",
                "BenefitDescription" : "Health Cover",
                "BenefitName" : "Health Cover",
                "isMain" : true,
                "BenefitCategory" : "Health",
                "MaxInstancesOfBenefit" : "${When i read users' information#Max Benefit Instances}",
                "isAvailable" : true,
                "CommissionFactor" : "20",
                "selfEmployedGT3Years": "No"
              } ,
			 {
                "CompositeCode" : "PrvtHlth_HlthPls",
                "BenefitCode" : "HlthPls",
                "BenefitDescription" : "Health Plus",
                "BenefitName" : "Health Plus",
                "Load" : "150",
                "ExcessFactor" : "250",
                "isMain" : false,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Hlth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "HlthPls",
                "CommissionFactor" : "60",
                "selfEmployedGT3Years": "Yes"
              },
              {
                "BenefitDescription" : "Health Waiver of Premium",
                "BenefitName" : "Health Waiver of Premium",
                "CompositeCode" : "TCMP_WOP",
                "BenefitCode" : "WOP",
                "isMain" : false,
                "PaymentPeriod" : "",
                "isIndexed" : "I",
                "Load" : "${When i read users' information#PW Load Percentage}",
                "WaitingPeriod" : "${When i read users' information#Waiver Waiting Period}",
                "SumAssured" : "",
                "BenefitTerm" : "65",
                "ReviewTerm" : "",
                "isOtherBenefit" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ 
			   {
                    "BenefitCode" : "Hlth"
                  }]
                },
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "duplicateBenefit" : false,
                "MatchingBenefitCode" : "WOP",
                "CommissionFactor" : "60",
                "selfEmployedGT3Years": "No"
              }]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="4777ebf8-2bad-44b1-bccf-94df75dad7a3" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="SCLA(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="a605f594-ce65-4bdc-86d5-3749cfdcfb8f">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="426cb52b-f7ca-4bd8-8fbe-35daebddcd6e">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="d73e69bb-23a4-4cb3-9362-692e99ef2fa9">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="1a8670b5-073a-4d63-9731-46f41d9c1d51">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="ed7a00aa-c447-41cc-a9b3-58e4b00db016">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>SCLA</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>OccClass</con:property>
          <con:property>SumAssured</con:property>
          <con:property>PremiumOption</con:property>
          <con:property>Indexation</con:property>
          <con:property>Loading</con:property>
          <con:property>LoadingTerm</con:property>
          <con:property>PerMille</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>WoP</con:property>
          <con:property>ExpectedMessage</con:property>
          <con:property>ActualMessage</con:property>
          <con:property>RESULT</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="d4df6cdc-29b2-4b04-b66d-be7bfeb6b042">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/SCLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="6736a51d-0ae7-416b-b356-e56ffbaa9775">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "true",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {         
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "No",
            "EmploymentStatus" : "Employed",            
            "OccupationClass" : "${When i read users' information#Occupation Class}",               
            "Gender" : "M",
            "SmokerStatus" : "NS",          
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "LoadingPerMille" : "${When i read users' information#PerMille}",
                "LoadingTerm" : "${When i read users' information#LoadingTerm}",
                "Load" : "${#TestCase#LOAD}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "LivingBuybackDiscount" : "No",               
                "MaxInstancesOfBenefit" : "3",
                "LinkType" : "S",
                "isAvailable" : true,
                "SortOrder" : "5",
                "isMain" : true,
                "BenefitDescription" : "Living Assurance",
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitName" : "Living Assurance",
                "SumAssured" : "${When i read users' information#SumAssured}",
                "isIndexed" : "${#TestCase#INDEX}",
                "CommissionFactor" : "100"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="6376c128-420e-4db5-bdf9-01ce5a75d544" name="Script Assertion">
              <con:configuration>
                <scriptText>def expectedMessage = context.expand( '${When i read users\' information#ExpectedMessage}' ) as String
def actualMessage=context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )

assert expectedMessage==actualMessage</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="2dd07855-57ec-4314-950b-b6fcedd64fa3">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/SCLA/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="57c2548a-9974-4c60-b94e-78baa2b16b33">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.SCLA.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>SCLA</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>OccClass</con:name>
              <con:value>${When i read users' information#OccClass}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssured</con:name>
              <con:value>${When i read users' information#SumAssured}</con:value>
            </con:property>
            <con:property>
              <con:name>PremiumOption</con:name>
              <con:value>${When i read users' information#PremiumOption}</con:value>
            </con:property>
            <con:property>
              <con:name>Indexation</con:name>
              <con:value>${When i read users' information#Indexation}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>LoadingTerm</con:name>
              <con:value>${When i read users' information#LoadingTerm}</con:value>
            </con:property>
            <con:property>
              <con:name>PerMille</con:name>
              <con:value>${When i read users' information#PerMille}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${When i read users' information#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>WoP</con:name>
              <con:value>${When i read users' information#WoP}</con:value>
            </con:property>
            <con:property>
              <con:name>ExpectedMessage</con:name>
              <con:value>${When i read users' information#ExpectedMessage}</con:value>
            </con:property>
            <con:property>
              <con:name>ActualMessage</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['ErrorMessages']['ErrorMessage'][0]['ErrorMessage']}</con:value>
            </con:property>
            <con:property>
              <con:name>RESULT</con:name>
              <con:value>${#TestCase#STATUS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="6b008b8f-c3aa-4a0c-a2e0-a56cc5b67c1e">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMjQ4Mzk5NSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzI0ODc1OTUsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI2M2E4YmEwZS0xZWMxLTQ0ZmItOTk2Yi00NGMwMmVjNDcwZGYiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.ERbkspoJ0PCAMODGj56uX0SGBFPXtWD8pJt7Z71QvI9Vjx87vH37FXhugqDByW3WBFcVmikaQUIaBvy-l3Ml_0OHnhADzy8SzFjUo6BRpyvjN0GEeoYpxXms8Y60VGC26tGHQuvwA7-WG4C_gs4eLiO9i6oLws7IgDntgWhGouE</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>25/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>30000</con:value>
        </con:property>
        <con:property>
          <con:name>STATUS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>L</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="7ea7f67e-95dd-420b-bbb8-43cf3ccae3cd" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="SCLA(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="c65ea727-8060-4684-8805-2b0f476916eb">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="4bec9ca0-8f70-4d98-b9d0-6df5cbbc6b51">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="10e25801-f10b-4fb0-99e7-8299352d5b5a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="a82f6c85-ee04-4076-9aeb-120658574609">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="d3b8773d-38c7-4216-970a-227cbf448092">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>SCLA</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>OccClass</con:property>
          <con:property>SumAssured</con:property>
          <con:property>PremiumOption</con:property>
          <con:property>Indexation</con:property>
          <con:property>Loading</con:property>
          <con:property>LoadingTerm</con:property>
          <con:property>PerMille</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>WoP</con:property>
          <con:property>ExpectedMessage</con:property>
          <con:property>ActualMessage</con:property>
          <con:property>RESULT</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="b5031b30-3170-4e4c-9904-7dbd1d24c3f7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/SCLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="eebfbe3e-60f3-4361-b78d-5cf31552b5b6">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "true",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {         
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "No",
            "EmploymentStatus" : "Employed",            
            "OccupationClass" : "${When i read users' information#Occupation Class}",               
            "Gender" : "M",
            "SmokerStatus" : "NS",          
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "LoadingPerMille" : "${When i read users' information#PerMille}",
                "LoadingTerm" : "${When i read users' information#LoadingTerm}",
                "Load" : "${#TestCase#LOAD}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "LivingBuybackDiscount" : "No",               
                "MaxInstancesOfBenefit" : "3",
                "LinkType" : "S",
                "isAvailable" : true,
                "SortOrder" : "5",
                "isMain" : true,
                "BenefitDescription" : "Living Assurance",
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitName" : "Living Assurance",
                "SumAssured" : "${When i read users' information#SumAssured}",
                "isIndexed" : "${#TestCase#INDEX}",
                "CommissionFactor" : "100"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="6376c128-420e-4db5-bdf9-01ce5a75d544" name="Script Assertion">
              <con:configuration>
                <scriptText>def expectedMessage = context.expand( '${When i read users\' information#ExpectedMessage}' ) as String
def actualMessage=context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )

assert expectedMessage==actualMessage</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="aba5cb98-eabf-466e-aee7-7d1e92734390">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/SCLA/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="9b206409-3180-452a-bcd9-7a6475f5e787">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.SCLA.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>SCLA</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>OccClass</con:name>
              <con:value>${When i read users' information#OccClass}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssured</con:name>
              <con:value>${When i read users' information#SumAssured}</con:value>
            </con:property>
            <con:property>
              <con:name>PremiumOption</con:name>
              <con:value>${When i read users' information#PremiumOption}</con:value>
            </con:property>
            <con:property>
              <con:name>Indexation</con:name>
              <con:value>${When i read users' information#Indexation}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>LoadingTerm</con:name>
              <con:value>${When i read users' information#LoadingTerm}</con:value>
            </con:property>
            <con:property>
              <con:name>PerMille</con:name>
              <con:value>${When i read users' information#PerMille}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${When i read users' information#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>WoP</con:name>
              <con:value>${When i read users' information#WoP}</con:value>
            </con:property>
            <con:property>
              <con:name>ExpectedMessage</con:name>
              <con:value>${When i read users' information#ExpectedMessage}</con:value>
            </con:property>
            <con:property>
              <con:name>ActualMessage</con:name>
              <con:value>${And i get premium#Response#$['Quote']['PartyRolesInQuote']['PartyRoleInQuote'][0]['Products']['Product'][0]['ProductBenefits']['ProductBenefit'][0]['ErrorMessages']['ErrorMessage'][0]['ErrorMessage']}</con:value>
            </con:property>
            <con:property>
              <con:name>RESULT</con:name>
              <con:value>${#TestCase#STATUS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="7b3bf6eb-e1b1-466b-82e5-22a18d054838">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyNDg0MDc3LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjQ4NzY3Nywib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6IjVjMjgxYTc3LWJjZjAtNDA1My1iYzhhLTQzNjFiNTBmZDFhNyIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.dwnb_6WNpFiGScqTHpJ0VmuzDWAHgLtiR8vFyF1o7WjahVqtjxPJbhK2YgIpEkhG9a7xWzmMTxI6kzc2Pd3bPy8iPK7yZavR2-1QWQsk1mMBcQbAvAP9rhGop21WwzWGfJNKAE12vSaGUVjE7FtEoUXw9Vv5dIGhaWTwtQGTzZs</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>25/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>30000</con:value>
        </con:property>
        <con:property>
          <con:name>STATUS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>L</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="5f0cb2bc-5a01-4f4d-b0d6-3be512153a27" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="DI(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="749b37e2-6a64-4249-9dce-f42cbfd6dcc0">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="84415f64-dd6f-4f83-818e-064086fa3ce4">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="230a4144-0561-4772-9e33-06f5dac2f8e0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="61acd226-f260-437a-b518-aed02fe053d8">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="aaa29405-18ce-4dac-8f9e-6cec5fd09dcf">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/VR.xlsx</file>
              <worksheet>DI</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Gender</con:property>
          <con:property>Age</con:property>
          <con:property>Smoker</con:property>
          <con:property>OccClass</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>SumAssured</con:property>
          <con:property>SumAssuredFrequency</con:property>
          <con:property>Indexation</con:property>
          <con:property>PremiumOption</con:property>
          <con:property>BenefitType</con:property>
          <con:property>PaymentPeriod</con:property>
          <con:property>Loading</con:property>
          <con:property>WaitingPeriod</con:property>
          <con:property>MentalHealth</con:property>
          <con:property>PremierOption</con:property>
          <con:property>WoPWaitingPeriod</con:property>
          <con:property>WoPLoading</con:property>
          <con:property>ErrorOnBenefit</con:property>
          <con:property>ExpectedMessage</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="6347dacf-69a3-459f-94a0-83d829de6796">
        <con:settings/>
        <con:config>
          <script>/*String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/DI/And_i_refine_the_data.groovy"
evaluate(new File(file))*/
/********************************************************
Desc:   format API input payload read from the spreadsheet.
Date:   26/07/2018
Author: Prathiba Kankanala
********************************************************/

//convert value: NS == No, S == Yes
def smoker = context.expand( '${When i read users\' information#Smoker}' ) as String
//testRunner.testCase.setPropertyValue("SMOKER", (smoker == 'NS') ?  "No" : "Yes")
testRunner.testCase.setPropertyValue("SMOKER", smoker.toString())
//convert value: M == Monthly, W == Weekly, F == Fortnightly, Y == Annual
def premiumFrequency = context.expand( '${When i read users\' information#Premium Frequency}' ) as String
testRunner.testCase.setPropertyValue("FREQUENCY", premiumFrequency)
testRunner.testCase.setPropertyValue("DIINDEX", (context.expand( '${When i read users\' information#Indexation}' ) == 'Y') ? "I" : "L")
//convert value: 1 means 100
def diLoading = context.expand( '${When i read users\' information#Loading}' ) as Double
testRunner.testCase.setPropertyValue("LOAD", (diLoading * 100).toString() )
//convert Premium Opt
//convert Review Term
String _opt = ""
String _term = ""
def diPremiumOptions = context.expand( '${When i read users\' information#PremiumOption}' ) as String
switch(diPremiumOptions)
{
	case ~/.*Rate For Age.*/:
		//_opt = "Rate for Age"
		_opt = "R"
		_term = "1"
		break	
	case~/.*10 Year.*/:
		//_opt = "10 Year"
		_opt = "10"
		_term = "10"
		break
	case~/.*To Age 65.*/:
		//_opt = "To Age 65"
		_opt = "65"
		_term = "65"
		break	
	default:
		_opt = "No Matched Options"
		_term = "No Matched Term"
	
}
testRunner.testCase.setPropertyValue("PRE_OPT", _opt )
testRunner.testCase.setPropertyValue("REVIEW_TERM", _term )

//convert payment period: 1yr == 1 year, 2yrs == 2 years, 5Yrs == 5 years, to age 65 == To Age 65, to age 70=To Age 70
def paymentPeriod = context.expand( '${When i read users\' information#PaymentPeriod}' ) as String
def pp = ""
switch(paymentPeriod)
{
	case "1 year":
		pp = "1Y";
		break;
	case "2 years":
		pp = "2Y";
		break;
	case "5 years":
		pp = "5Y";
		break;
	case "To Age 65":
		pp = "65";
		break;
	case "To Age 70":
		pp = "70";
		break;
}
testRunner.testCase.setPropertyValue("PAYMENT_PERIOD", pp)

//convert Cover type: DI == 1 year, 2yrs == 2 years, 5Yrs == 5 years, to age 65 == To Age 65, to age 70=To Age 70
def benefitType = context.expand( '${When i read users\' information#BenefitType}' ) as String
def bt = ""
switch(benefitType)
{
	case "Indemnity":
		bt = "I";
		break;
	case "Agreed Value":
		bt = "AV";
		break;
	case "Loss of Earnings":
		bt = "LOE";
		break;	
}
testRunner.testCase.setPropertyValue("BENEFIT_TYPE", bt)

//convert values: Y == Yes, N == No
testRunner.testCase.setPropertyValue("MENTAL_HEALTH", (context.expand( '${When i read users\' information#MentalHealth}' ) == 'Y') ? "Yes" : "No")
testRunner.testCase.setPropertyValue("PREMIER_OPTION", (context.expand( '${When i read users\' information#PremierOption}' ) == 'Y') ? "Yes" : "No")
//convert value: 1 means 100
def wopLoading = context.expand( '${When i read users\' information#WoPLoading}' ) as Double
testRunner.testCase.setPropertyValue("WOP_LOAD", (wopLoading * 100).toString() )

def sumAssured = context.expand( '${When i read users\' information#SumAssured}' ) as String
testRunner.testCase.setPropertyValue("SUM_ASSURED", sumAssured )</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="dcf8657e-c6ea-4c3c-953b-c07512ecb533">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "false",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "No",
            "EmploymentStatus" : "Employed",           
            "OccupationClass" : "${When i read users' information#OccClass}",            
            "Gender" : "${When i read users' information#Gender}",
            "SmokerStatus" : "${#TestCase#SMOKER}",         
            "Age" : "${When i read users' information#Age}"            
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "${When i read users' information#SumAssuredFrequency}",
                "Load" : "${#TestCase#LOAD}",
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "WaitingPeriod" : "${When i read users' information#WaitingPeriod}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "BenefitType" : "${#TestCase#BENEFIT_TYPE}",
                "MentalHealthLimitation" : "${When i read users' information#MentalHealth}",
                "isIndexed" : "${#TestCase#DIINDEX}",
                "BenefitTerm" : "",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "PremierOption" : "${When i read users' information#PremierOption}",
                "ReviewTerm" : "",                
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : "100"
              }, {
                "PaymentPeriod" : "",
                "Load" : "${#TestCase#WOP_LOAD}",
                "WaitingPeriod" : "${When i read users' information#WoPWaitingPeriod}",
                "isIndexed" : "",
                "PremiumOption" : "",
                "SumAssured" : "",
                "BenefitTerm" : "",
                "ReviewTerm" : "",               
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : "100"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="945b9d6c-cfdf-4b3b-ac4e-c3b710d684f6" name="Script Assertion">
              <con:configuration>
                <scriptText>def expectedMessage = context.expand( '${When i read users\' information#ExpectedMessage}' ) as String
def errorOnBenefit = context.expand( '${When i read users\' information#ErrorOnBenefit}' ) as String
def actualMessage

if(errorOnBenefit=="IP")
{
actualMessage=context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
}

if(errorOnBenefit=="WoP")
{
actualMessage=context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' )
}

assert expectedMessage==actualMessage</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="58442002-7755-49f8-beb8-9ad02588a95a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/DI/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="a723837a-7f2d-46ff-9ce9-dcf197746a1e">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.DI.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>DI</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Gender</con:name>
              <con:value>${When i read users' information#Gender}</con:value>
            </con:property>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${#TestCase#SMOKER}</con:value>
            </con:property>
            <con:property>
              <con:name>OccClass</con:name>
              <con:value>${When i read users' information#OccClass}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${When i read users' information#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssured</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssuredFrequency</con:name>
              <con:value>${When i read users' information#SumAssuredFrequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Indexation</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>PremiumOption</con:name>
              <con:value>${#TestCase#PRE_OPT}</con:value>
            </con:property>
            <con:property>
              <con:name>BenefitType</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>PaymentPeriod</con:name>
              <con:value>${When i read users' information#PaymentPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WaitingPeriod</con:name>
              <con:value>${When i read users' information#WoPWaitingPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>MentalHealth</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>PremierOption</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>WoPWaitingPeriod</con:name>
              <con:value>${When i read users' information#WoPWaitingPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>WoPLoading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>Expected Message</con:name>
              <con:value>${When i read users' information#ExpectedMessage}</con:value>
            </con:property>
            <con:property>
              <con:name>Actual Message</con:name>
              <con:value>${#TestCase#ACTUAL_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>RESULT</con:name>
              <con:value>${#TestCase#STATUS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="e1da429e-f2c7-4e0e-8647-91bab06ccf1d">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">"Invalid Occupation Class</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyNjQ0NzkzLCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjY0ODM5Mywib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImVhZjFhZDUzLTUxOTctNDliYi1iYjk3LWMxMWE4ZmFkNjNjNSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.hnQmSAXYy15_1emXpRfW-7ldQegxF-upPiwhBmjZ0jDNgJre4Y8N7hafsZX7g9UE6CSiaPhcI7tFVHReBe5clnX6WgQV5zr24PeyjXVgwj_IfbO-_ab34k5QhKwcbIh91umoupP6Xg_D2uX0lJFPaGhy0j4LaGjFwxuIRPXF9og</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>27/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>S</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>65</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>2Y</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>100000001</con:value>
        </con:property>
        <con:property>
          <con:name>STATUS</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>ACTUAL_MESSAGE</con:name>
          <con:value/>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="62c144a4-1e2a-401e-92da-cead7853df88" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="ACLA(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="3cfa1f17-43e0-4665-9d56-64f5ffcb63ee">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="a315fb10-397c-479d-9739-dedb4e49b934">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="857dfc9c-09bf-448c-9a7a-a1b02b93f2f8">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="c145c2e5-b92c-48ff-8bb2-c302d4b2aa69">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="7466945c-331f-45a4-ae63-d35c67a8be58">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/ACLA_Validation.xlsx</file>
              <worksheet>ACLA</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>OccClass</con:property>
          <con:property>SumAssured</con:property>
          <con:property>ACLASumAssured</con:property>
          <con:property>SCLA</con:property>
          <con:property>SCLASumAssured</con:property>
          <con:property>PremiumOption</con:property>
          <con:property>ACLAPremiumOption</con:property>
          <con:property>FieldVerification</con:property>
          <con:property>Indexation</con:property>
          <con:property>ACLAIndexation</con:property>
          <con:property>Loading</con:property>
          <con:property>LoadingTerm</con:property>
          <con:property>PerMille</con:property>
          <con:property>SCLALoading</con:property>
          <con:property>ExpectedMessage</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="06603cd1-cf0b-431c-9548-5eb2ece4b92b">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/ACLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="690f02d7-155b-4b70-b8f2-7c2c354d6678">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="6376c128-420e-4db5-bdf9-01ce5a75d544" name="ACLA Checking">
              <con:configuration>
                <scriptText><![CDATA[//Get Expected result from sheet 
def ACLAExpectedMessage = context.expand( '${When i read users\' information#ExpectedMessage}' ) as String
//Define for SCLA
def SCLAExpectedScope = null
def SCLAExpectedErrorMessage = null
def SCLAErrorMessage = null
def SCLAErrorScope = null

//Define for ACLA 
def ACLAErrorMessage = null

//Define load for SCLA and ACLA
def expectedLoading = null
def ACLAActualLoading = null
 
//Define expected indexation for Life Cover and ACLA
def expectedIndexation = null
def ACLAActualIndexation = null
//Define expected reviewTerm for ACLA
def expectedReviewTerm = null
def ACLAActualReviewTerm = null

//define test result
def statusMatch

//Get actual results for SCLA and ACLA and redefine expected results for SCLA
def hasSCLA = context.expand( '${When i read users\' information#SCLA}' ) as String
def hasFieldValidation = context.expand( '${When i read users\' information#FieldVerification}' ) as String
if( hasSCLA == "Yes" && hasFieldValidation == null)
{
	SCLAExpectedErrorMessage = ACLAExpectedMessage
	SCLAExpectedScope = "Category"		
	SCLAErrorMessage = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' ) as String
	SCLAErrorScope = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorScope\']}' ) as String	
	ACLAErrorMessage = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' ) as String
}
else
{
	//Get actual error message for ALCA if no SCLA benefit
	ACLAErrorMessage=context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' ) as String
}

if(hasFieldValidation == "Yes")
{
	expectedLoading = context.expand( '${When i read users\' information#SCLALoading}' ) as String
	expectedIndexation = messageExchange.modelItem.testStep.testCase.getPropertyValue("INDEX")
	expectedReviewTerm = "1"	
	SCLAExpectedScope = null	//	no error message when just validating fields	
	ACLAExpectedMessage = "" //no error message when just validating fields
	ACLAActualReviewTerm = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'ReviewTerm\']}' ) as String
	ACLAActualLoading = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'Load\']}' ) as String
	ACLAActualIndexation = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'isIndexed\']}' ) as String}

//Compare the result
assert (SCLAExpectedErrorMessage == SCLAErrorMessage) && (SCLAExpectedScope == SCLAErrorScope) && (ACLAExpectedMessage==ACLAErrorMessage) && (expectedLoading==ACLAActualLoading) && (expectedIndexation==ACLAActualIndexation) && (expectedReviewTerm==ACLAActualReviewTerm)]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="85543dcc-52ae-41e1-88e2-07cf395f41c5">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/ACLA/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="1059dc9e-f870-4f5b-a572-2ee964198327">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.ACLA.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>ACLA</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>OccClass</con:name>
              <con:value>${When i read users' information#OccClass}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssured</con:name>
              <con:value>${When i read users' information#SumAssured}</con:value>
            </con:property>
            <con:property>
              <con:name>ACLASumAssured</con:name>
              <con:value>${When i read users' information#ACLASumAssured}</con:value>
            </con:property>
            <con:property>
              <con:name>SCLA</con:name>
              <con:value>${When i read users' information#SCLA}</con:value>
            </con:property>
            <con:property>
              <con:name>SCLASumAssured</con:name>
              <con:value>${When i read users' information#SCLASumAssured}</con:value>
            </con:property>
            <con:property>
              <con:name>PremiumOption</con:name>
              <con:value>${When i read users' information#PremiumOption}</con:value>
            </con:property>
            <con:property>
              <con:name>ACLAPremiumOption</con:name>
              <con:value>${When i read users' information#ACLAPremiumOption}</con:value>
            </con:property>
            <con:property>
              <con:name>FieldVerification</con:name>
              <con:value>${When i read users' information#FieldVerification}</con:value>
            </con:property>
            <con:property>
              <con:name>Indexation</con:name>
              <con:value>${When i read users' information#Indexation}</con:value>
            </con:property>
            <con:property>
              <con:name>ACLAIndexation</con:name>
              <con:value>${When i read users' information#ACLAIndexation}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading</con:name>
              <con:value>${When i read users' information#Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>LoadingTerm</con:name>
              <con:value>${When i read users' information#LoadingTerm}</con:value>
            </con:property>
            <con:property>
              <con:name>PerMille</con:name>
              <con:value>${When i read users' information#PerMille}</con:value>
            </con:property>
            <con:property>
              <con:name>SCLALoading</con:name>
              <con:value>${When i read users' information#SCLALoading}</con:value>
            </con:property>
            <con:property>
              <con:name>ExpectedMessage</con:name>
              <con:value>${When i read users' information#ExpectedMessage}</con:value>
            </con:property>
            <con:property>
              <con:name>ActualMessage</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>RESULT</con:name>
              <con:value>${#TestCase#STATUS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="c6108930-608f-4c8b-b641-933e5d5d291a">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzcwNTA0Mywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM3MDg2NDMsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI1MmYwZDEyOS02MTcwLTQ1NTgtYTBjNy02M2YzYmU1NjQzMzkiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.Ajdzc22eotTfVqhj6Tvxr6ibWzJinh8qL7lcxZKlUNl44dEpavs4_P9pZI6U2ZCB-4BCEeA_93A31GkhBztkZGqjlrlX6cv8LSN9MWQm4bjoHNVnysaPiEZpiThtUme-M_gYIIwBQPeH76aanEVVDdWZrcpfigiwj4v45prKTOM</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>08/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>500.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>3000000</con:value>
        </con:property>
        <con:property>
          <con:name>STATUS</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>ACLAPRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "e38e59fe-4e35-4949-b94b-60fdc27848ed",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : false,
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "fc0ce194-6893-4137-911f-ce3be9f489be",
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : null,
            "EmploymentStatus" : "Employed",
            "Salary" : null,
            "OccupationClass" : "${When i read users' information#Occupation Class}", 
            "Occupation" : null,
            "Gender" : "F",
            "SmokerStatus" : "S",
            "BirthDate" : null,            
            "LastName" : "ACLA",                            
            "Age" : "${When i read users' information#Age}", 
            "FirstName" : null
          },
          "LifeId" : "fc0ce194-6893-4137-911f-ce3be9f489be"
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "BenefitId" : "f2b13e76-cd8b-4ff3-9bc7-a394379448d3",
                "isAvailable" : true,
                "isMain" : true,
				"LoadingPerMille" : "${When i read users' information#PerMille}",
                "LoadingTerm" : "${When i read users' information#LoadingTerm}",
				"Load" : "${When i read users' information#Loading}",
                "MaxInstancesOfBenefit" : "4",
                "SortOrder" : 1,
                "SumAssured" : "${When i read users' information#SumAssured}",
                "isIndexed" : "${#TestCase#INDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : 100
              }			,
			{                                       
				"LoadingPerMille" : "${When i read users' information#PerMille}",
                "LoadingTerm" : "${When i read users' information#LoadingTerm}",
                "Load" : "${When i read users' information#SCLALoading}",
				"isIndexed" : "${#TestCase#INDEX}",
                "PremiumOption" : "${#TestCase#ACLAPRE_OPT}", 
                "LivingBuybackDiscount" : "No",               
                "MaxInstancesOfBenefit" : "3",
                "LinkType" : "S",
                "isAvailable" : true,
                "SortOrder" : "5",
                "isMain" : true,
				"AttributeGroups": {
					"AttributeGroup":[{
                        "Name": "SumAssuredValidation",
                        "Description": "SumAssuredValidation",
                        "Values": "Trauma"
                     },
                     {
                        "Name": "OutputDisplay",
                        "Description": "OutputDisplay",
                        "Values": "Trauma"
                     }
                  ]},
                "BenefitDescription" : "Living Assurance",
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitName" : "Living Assurance",
                "SumAssured" : "${When i read users' information#SCLASumAssured}",                
                "CommissionFactor" : "100"
              }, {
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitDescription" : "Living Assurance",
                "BenefitName" : "Accelerated Living Assurance",
                "Channel" : "SOVHUB",
                "BenefitId" : "e6f0d0e9-6741-4373-9d75-a658f7154c8c",
                "isAvailable" : true,
                "isMain" : false,
                "LinkType" : "A",
				"LoadingPerMille" : "${When i read users' information#PerMille}",
                "LoadingTerm" : "${When i read users' information#LoadingTerm}",
                "Load" : "${When i read users' information#Loading}",
				"isIndexed" : "${#TestCase#ACLAINDEX}",
                "PremiumOption" : "${#TestCase#ACLAPRE_OPT}",                              
                "MaxInstancesOfBenefit" : "4",
				"AttributeGroups": {
					"AttributeGroup":[{
                        "Name": "SumAssuredValidation",
                        "Description": "SumAssuredValidation",
                        "Values": "Trauma"
                     },
                     {
                        "Name": "OutputDisplay",
                        "Description": "OutputDisplay",
                        "Values": "Trauma"
                     }
                  ]},
				"LivingBuybackDiscount":"Yes",                
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "f2b13e76-cd8b-4ff3-9bc7-a394379448d3",
                    "BenefitCode" : "Life"
                  } ]
                },
                "ProductCode" : "TCMP",
                "ProductName" : "TotalCare Max - Personal",
                "SortOrder" : 5,
                "SumAssured" : "${When i read users' information#ACLASumAssured}",
                "CommissionFactor" : 100
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>ACLAINDEX</con:name>
          <con:value>I</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="9d022c27-dc0e-4d11-86fc-75889fdde26e" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="ACLA(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="51772791-5aa0-45ef-9e92-e312836b5e2c">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="2b8840e1-3dec-4876-be81-aecd1dcbab6e">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="fb554824-43d5-4b7e-92f0-20cd969ec09d">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="aabe99cd-1edf-42ce-a123-24d3359d3afa">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="6d8e0a70-4033-4958-96a1-bb314caeed5f">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/ACLA_Validation.xlsx</file>
              <worksheet>ACLA</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Age</con:property>
          <con:property>OccClass</con:property>
          <con:property>SumAssured</con:property>
          <con:property>ACLASumAssured</con:property>
          <con:property>SCLA</con:property>
          <con:property>SCLASumAssured</con:property>
          <con:property>PremiumOption</con:property>
          <con:property>ACLAPremiumOption</con:property>
          <con:property>FieldVerification</con:property>
          <con:property>Indexation</con:property>
          <con:property>ACLAIndexation</con:property>
          <con:property>Loading</con:property>
          <con:property>LoadingTerm</con:property>
          <con:property>PerMille</con:property>
          <con:property>SCLALoading</con:property>
          <con:property>ExpectedMessage</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="3c3aba3f-434a-443d-89fa-60f0e98612f6">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/ACLA/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="a345205c-82f3-4f45-bd8f-6cb3a5473486">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>${#TestCase#PAYLOAD}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="6376c128-420e-4db5-bdf9-01ce5a75d544" name="ACLA Checking">
              <con:configuration>
                <scriptText><![CDATA[//Get Expected result from sheet 
def ACLAExpectedMessage = context.expand( '${When i read users\' information#ExpectedMessage}' ) as String
//Define for SCLA
def SCLAExpectedScope = null
def SCLAExpectedErrorMessage = null
def SCLAErrorMessage = null
def SCLAErrorScope = null

//Define for ACLA 
def ACLAErrorMessage = null

//Define load for SCLA and ACLA
def expectedLoading = null
def ACLAActualLoading = null
 
//Define expected indexation for Life Cover and ACLA
def expectedIndexation = null
def ACLAActualIndexation = null
//Define expected reviewTerm for ACLA
def expectedReviewTerm = null
def ACLAActualReviewTerm = null

//define test result
def statusMatch

//Get actual results for SCLA and ACLA and redefine expected results for SCLA
def hasSCLA = context.expand( '${When i read users\' information#SCLA}' ) as String
def hasFieldValidation = context.expand( '${When i read users\' information#FieldVerification}' ) as String
if( hasSCLA == "Yes" && hasFieldValidation == null)
{
	SCLAExpectedErrorMessage = ACLAExpectedMessage
	SCLAExpectedScope = "Category"		
	SCLAErrorMessage = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' ) as String
	SCLAErrorScope = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorScope\']}' ) as String	
	ACLAErrorMessage = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' ) as String
}
else
{
	//Get actual error message for ALCA if no SCLA benefit
	ACLAErrorMessage=context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\'][0][\'ErrorMessage\']}' ) as String
}

if(hasFieldValidation == "Yes")
{
	expectedLoading = context.expand( '${When i read users\' information#SCLALoading}' ) as String
	expectedIndexation = messageExchange.modelItem.testStep.testCase.getPropertyValue("INDEX")
	expectedReviewTerm = "1"	
	SCLAExpectedScope = null	//	no error message when just validating fields	
	ACLAExpectedMessage = "" //no error message when just validating fields
	ACLAActualReviewTerm = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'ReviewTerm\']}' ) as String
	ACLAActualLoading = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'Load\']}' ) as String
	ACLAActualIndexation = context.expand( '${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][2][\'isIndexed\']}' ) as String}

//Compare the result
assert (SCLAExpectedErrorMessage == SCLAErrorMessage) && (SCLAExpectedScope == SCLAErrorScope) && (ACLAExpectedMessage==ACLAErrorMessage) && (expectedLoading==ACLAActualLoading) && (expectedIndexation==ACLAActualIndexation) && (expectedReviewTerm==ACLAActualReviewTerm)]]></scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="fbdfc26e-dd6e-4b8d-b46e-5dfe08c53764">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/ACLA/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="54da9423-e459-4824-add2-202714acb937">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.ACLA.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>ACLA</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>OccClass</con:name>
              <con:value>${When i read users' information#OccClass}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssured</con:name>
              <con:value>${When i read users' information#SumAssured}</con:value>
            </con:property>
            <con:property>
              <con:name>ACLASumAssured</con:name>
              <con:value>${When i read users' information#ACLASumAssured}</con:value>
            </con:property>
            <con:property>
              <con:name>SCLA</con:name>
              <con:value>${When i read users' information#SCLA}</con:value>
            </con:property>
            <con:property>
              <con:name>SCLASumAssured</con:name>
              <con:value>${When i read users' information#SCLASumAssured}</con:value>
            </con:property>
            <con:property>
              <con:name>PremiumOption</con:name>
              <con:value>${When i read users' information#PremiumOption}</con:value>
            </con:property>
            <con:property>
              <con:name>ACLAPremiumOption</con:name>
              <con:value>${When i read users' information#ACLAPremiumOption}</con:value>
            </con:property>
            <con:property>
              <con:name>FieldVerification</con:name>
              <con:value>${When i read users' information#FieldVerification}</con:value>
            </con:property>
            <con:property>
              <con:name>Indexation</con:name>
              <con:value>${When i read users' information#Indexation}</con:value>
            </con:property>
            <con:property>
              <con:name>ACLAIndexation</con:name>
              <con:value>${When i read users' information#ACLAIndexation}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading</con:name>
              <con:value>${When i read users' information#Loading}</con:value>
            </con:property>
            <con:property>
              <con:name>LoadingTerm</con:name>
              <con:value>${When i read users' information#LoadingTerm}</con:value>
            </con:property>
            <con:property>
              <con:name>PerMille</con:name>
              <con:value>${When i read users' information#PerMille}</con:value>
            </con:property>
            <con:property>
              <con:name>SCLALoading</con:name>
              <con:value>${When i read users' information#SCLALoading}</con:value>
            </con:property>
            <con:property>
              <con:name>ExpectedMessage</con:name>
              <con:value>${When i read users' information#ExpectedMessage}</con:value>
            </con:property>
            <con:property>
              <con:name>ActualMessage</con:name>
              <con:value>${#TestCase#ERROR_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>RESULT</con:name>
              <con:value>${#TestCase#STATUS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="a4895623-fcca-40ea-a998-d959aa065886">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMzNzA1MDQ1LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMzcwODY0NSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6IjlhN2Y4MmVkLTg5NTYtNDYyZC1iMGVmLTk0N2JiYTEwZTE4NSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.LQXoPVA05aIawf6cRURD7bxcTwror5fcola6FBbojDWqJ3AYMdBkAhfjR2CkEG6ZtHHV99EGSztBTd0LyKkugh2C4KVew-Abe2rDs9uYLdeNef-PodbzGfzAUtV9Jz8bp3lXdRsb9axFmxTzcoIDrJd2maC4E-K0vlpsYUFK_Bc</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>08/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>500.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>3000000</con:value>
        </con:property>
        <con:property>
          <con:name>STATUS</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>INDEX</con:name>
          <con:value>I</con:value>
        </con:property>
        <con:property>
          <con:name>ACLAPRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>PAYLOAD</con:name>
          <con:value>{
  "Quote" : {
    "QuoteNumber" : "e38e59fe-4e35-4949-b94b-60fdc27848ed",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : false,
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "Id" : "fc0ce194-6893-4137-911f-ce3be9f489be",
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : null,
            "EmploymentStatus" : "Employed",
            "Salary" : null,
            "OccupationClass" : "${When i read users' information#Occupation Class}", 
            "Occupation" : null,
            "Gender" : "F",
            "SmokerStatus" : "S",
            "BirthDate" : null,            
            "LastName" : "ACLA",                            
            "Age" : "${When i read users' information#Age}", 
            "FirstName" : null
          },
          "LifeId" : "fc0ce194-6893-4137-911f-ce3be9f489be"
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "BenefitCategory" : "Life",
                "BenefitCode" : "Life",
                "BenefitDescription" : "Life Cover",
                "BenefitName" : "Life Cover",
                "BenefitId" : "f2b13e76-cd8b-4ff3-9bc7-a394379448d3",
                "isAvailable" : true,
                "isMain" : true,
				"LoadingPerMille" : "${When i read users' information#PerMille}",
                "LoadingTerm" : "${When i read users' information#LoadingTerm}",
				"Load" : "${When i read users' information#Loading}",
                "MaxInstancesOfBenefit" : "4",
                "SortOrder" : 1,
                "SumAssured" : "${When i read users' information#SumAssured}",
                "isIndexed" : "${#TestCase#INDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : 100
              }			,
			{                                       
				"LoadingPerMille" : "${When i read users' information#PerMille}",
                "LoadingTerm" : "${When i read users' information#LoadingTerm}",
                "Load" : "${When i read users' information#SCLALoading}",
				"isIndexed" : "${#TestCase#INDEX}",
                "PremiumOption" : "${#TestCase#ACLAPRE_OPT}", 
                "LivingBuybackDiscount" : "No",               
                "MaxInstancesOfBenefit" : "3",
                "LinkType" : "S",
                "isAvailable" : true,
                "SortOrder" : "5",
                "isMain" : true,
				"AttributeGroups": {
					"AttributeGroup":[{
                        "Name": "SumAssuredValidation",
                        "Description": "SumAssuredValidation",
                        "Values": "Trauma"
                     },
                     {
                        "Name": "OutputDisplay",
                        "Description": "OutputDisplay",
                        "Values": "Trauma"
                     }
                  ]},
                "BenefitDescription" : "Living Assurance",
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitName" : "Living Assurance",
                "SumAssured" : "${When i read users' information#SCLASumAssured}",                
                "CommissionFactor" : "100"
              }, {
                "BenefitCategory" : "Trauma",
                "BenefitCode" : "CompLivAss",
                "BenefitDescription" : "Living Assurance",
                "BenefitName" : "Accelerated Living Assurance",
                "Channel" : "SOVHUB",
                "BenefitId" : "e6f0d0e9-6741-4373-9d75-a658f7154c8c",
                "isAvailable" : true,
                "isMain" : false,
                "LinkType" : "A",
				"LoadingPerMille" : "${When i read users' information#PerMille}",
                "LoadingTerm" : "${When i read users' information#LoadingTerm}",
                "Load" : "${When i read users' information#Loading}",
				"isIndexed" : "${#TestCase#ACLAINDEX}",
                "PremiumOption" : "${#TestCase#ACLAPRE_OPT}",                              
                "MaxInstancesOfBenefit" : "4",
				"AttributeGroups": {
					"AttributeGroup":[{
                        "Name": "SumAssuredValidation",
                        "Description": "SumAssuredValidation",
                        "Values": "Trauma"
                     },
                     {
                        "Name": "OutputDisplay",
                        "Description": "OutputDisplay",
                        "Values": "Trauma"
                     }
                  ]},
				"LivingBuybackDiscount":"Yes",                
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "f2b13e76-cd8b-4ff3-9bc7-a394379448d3",
                    "BenefitCode" : "Life"
                  } ]
                },
                "ProductCode" : "TCMP",
                "ProductName" : "TotalCare Max - Personal",
                "SortOrder" : 5,
                "SumAssured" : "${When i read users' information#ACLASumAssured}",
                "CommissionFactor" : 100
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:value>
        </con:property>
        <con:property>
          <con:name>ACLAINDEX</con:name>
          <con:value>I</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="7da9c5ba-bc57-4555-b634-f0b054c020ef" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="MIP(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="38c4b5c0-b7d5-4e96-971f-d8c6e3173e88">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="07a9bd13-7198-473a-a8b7-58d289f79257">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="45f727ce-73d9-4b94-a4ce-bb0069951d94">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="c9bf022b-b218-438a-b183-8414a59712cd">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="7ea5dbe7-068f-441c-987e-f0456e551f9c">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/MIP_Validation.xlsx</file>
              <worksheet>MIP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>ScenarioName</con:property>
          <con:property>Gender</con:property>
          <con:property>Age</con:property>
          <con:property>Smoker</con:property>
          <con:property>OccClass</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>SumAssured</con:property>
          <con:property>SumAssuredFrequency</con:property>
          <con:property>Indexation</con:property>
          <con:property>PremiumOption</con:property>
          <con:property>MortgageType</con:property>
          <con:property>PaymentPeriod</con:property>
          <con:property>Loading</con:property>
          <con:property>WaitingPeriod</con:property>
          <con:property>MentalHealth</con:property>
          <con:property>MortgageAmount</con:property>
          <con:property>WoPWaitingPeriod</con:property>
          <con:property>WoPLoading</con:property>
          <con:property>ErrorOnBenefit</con:property>
          <con:property>ExpectedMessage</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="11edf8fc-dc42-4410-84c3-6625c46cc60e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/MIP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="e620c10b-90fa-4e90-9b3d-379d093532eb">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "false",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "No",
            "EmploymentStatus" : "Employed",            
            "OccupationClass" : "${When i read users' information#OccClass}",             
            "Gender" : "${When i read users' information#Gender}",
            "SmokerStatus" : "${When i read users' information#Smoker}",             
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "WaitingPeriod" : "${When i read users' information#WaitingPeriod}",
                "SumAssuredFrequency" : "${#TestCase#SUM_ASSURED_FREQUENCY}",
                "SortOrder" : 8,
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "MentalHealthLimitation" : "${When i read users' information#MentalHealth}",
                "MaxInstancesOfBenefit" : "1",
                "Load" : "${#TestCase#LOAD}",
                "isMain" : true,
                "isAvailable" : true,               
                "BenefitName" : "Mortgage and Income Protection",
                "BenefitDescription" : "Mortgage and Income Protection",
                "BenefitCode" : "MortProt",
                "BenefitCategory" : "Income Protection",
                "AttributeGroup1" : "Income Protection",
                "MortgageType" : "${When i read users' information#MortgageType}",
                "MortgageRepaymentAmount" : "${When i read users' information#MortgageAmount}",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "isIndexed" : "${#TestCase#MIPINDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : "100"
              }, {
                "WaitingPeriod" : "${When i read users' information#WoPWaitingPeriod}",
                "SortOrder" : 16,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "b3a65330-c620-4fb3-b1c4-50a2c9d4ab2b",
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitId" : "ad853b55-ea12-4708-856e-bd9ae544fbbe",
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitId" : "916027c1-1d11-4910-92d4-16b292290e4a",
                    "BenefitCode" : "MortProt"
                  }, {
                    "BenefitId" : "c5a4e1e6-651b-4ef0-a53f-b3613a4f88f9",
                    "BenefitCode" : "CompLivAss"
                  }, {
                    "BenefitId" : "8c3a0d5b-324d-484c-bb99-eee765e46921",
                    "BenefitCode" : "ProgCare"
                  }, {
                    "BenefitId" : "cb42a374-560e-471e-8512-3b86fe52ce82",
                    "BenefitCode" : "TPD"
                  }, {
                    "BenefitId" : "c8ff67cf-32c9-44d7-8daf-71a30f07375d",
                    "BenefitCode" : "AccDth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "Load" :"${#TestCase#WOP_LOAD}",
                "isMain" : false,
                "isAvailable" : true,
                "BenefitId" : "89b330da-00bd-4069-bb8d-9d72bc22cc6c",
                "BenefitName" : "Waiver of Premium",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "CommissionFactor" : "100"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="945b9d6c-cfdf-4b3b-ac4e-c3b710d684f6" name="Script Assertion">
              <con:configuration>
                <scriptText>def expectedMessage = context.expand( '${When i read users\' information#ExpectedMessage}' ) as String
def errorOnBenefit = context.expand( '${When i read users\' information#ErrorOnBenefit}' ) as String
def actualMessage
def statusMatch
def message="" as String

if(errorOnBenefit=="MIP")
{
	def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
	if(errorMessages!="")
	{
	def parsedJson = new groovy.json.JsonSlurper().parseText(errorMessages)
	for(int i=0;i&lt;parsedJson.size();i++)
	{
		message+=parsedJson[i].get("ErrorMessage")+" "
	}
	actualMessage=message.trim()
	}
}
if(errorOnBenefit=="WoP")
{
	def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\']}')
	if(errorMessages!="")
	{
	def parsedJson = new groovy.json.JsonSlurper().parseText(errorMessages)
	for(int i=0;i&lt;parsedJson.size();i++)
	{
		message+=parsedJson[i].get("ErrorMessage")+" "
	}
	actualMessage=message.trim()
	}
}

assert expectedMessage==actualMessage</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="271ed9a4-6ced-4123-9a0a-db02529413e0">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/MIP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="25596e7c-2f10-4707-abca-8035f7f20358">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.MIP.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>MIP</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>ScenarioName</con:name>
              <con:value>${When i read users' information#ScenarioName}</con:value>
            </con:property>
            <con:property>
              <con:name>Gender</con:name>
              <con:value>${When i read users' information#Gender}</con:value>
            </con:property>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${#TestCase#SMOKER}</con:value>
            </con:property>
            <con:property>
              <con:name>OccClass</con:name>
              <con:value>${When i read users' information#OccClass}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${When i read users' information#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssured</con:name>
              <con:value>${#TestCase#SUM_ASSURED}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssuredFrequency</con:name>
              <con:value>${When i read users' information#SumAssuredFrequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Indexation</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>PremiumOption</con:name>
              <con:value>${#TestCase#PRE_OPT}</con:value>
            </con:property>
            <con:property>
              <con:name>MortgageType</con:name>
              <con:value>${When i read users' information#MortgageType}</con:value>
            </con:property>
            <con:property>
              <con:name>PaymentPeriod</con:name>
              <con:value>${When i read users' information#PaymentPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WaitingPeriod</con:name>
              <con:value>${When i read users' information#WaitingPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>MentalHealth</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>MortgageAmount</con:name>
              <con:value>${When i read users' information#MortgageAmount}</con:value>
            </con:property>
            <con:property>
              <con:name>WoPWaitingPeriod</con:name>
              <con:value>${When i read users' information#WoPWaitingPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>WoPLoading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>Expected Message</con:name>
              <con:value>${When i read users' information#ExpectedMessage}</con:value>
            </con:property>
            <con:property>
              <con:name>Actual Message</con:name>
              <con:value>${#TestCase#ACTUAL_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>RESULT</con:name>
              <con:value>${#TestCase#STATUS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="4e2ab66b-5b41-4f3d-a68c-e3769a76dc7a">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">"Invalid Occupation Class</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMzg1MTc1NSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzM4NTUzNTUsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJlNWQyZWM3ZC1hYjU4LTQ0YzYtYjAzNy0wMjJiNTQyM2U3YmIiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.FpIZCImSf48RRjrfq9fVQcMi2B6Rlba4Kf9eBAzfnGE1D54k43M14MdoCvzUZ898_2PJfT2sG3fTtKrY-Z4JFNG3ejewattUWf29GuVAyjIjJIxr8_FOMTka65e8o4EezOzQaI40eVnRxhkl1QHR7BcNCTEyvWNSNDvdBHw3pAM</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>10/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>-1.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>2.0</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>1500</con:value>
        </con:property>
        <con:property>
          <con:name>STATUS</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>ACTUAL_MESSAGE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">Invalid loading [0..999]</con:value>
        </con:property>
        <con:property>
          <con:name>MIPINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>M</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="dd96cdc4-2b07-4f1a-b71d-80cafeb00312" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="MIP(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="aa6b1955-87d9-4dc4-b495-287cd4a50fa1">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="c34d6527-50a2-4f76-beb9-fc0634ab79d3">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="c7798621-c7af-4cb7-bfca-84527e556051">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="01d74f10-d4c0-4ea4-8b57-50406846dce2">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="When i read users' information" id="ac2491c6-1d4d-44fa-9d4a-f61e4b423eff">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>./Data/MIP_Validation.xlsx</file>
              <worksheet>MIP</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>ScenarioName</con:property>
          <con:property>Gender</con:property>
          <con:property>Age</con:property>
          <con:property>Smoker</con:property>
          <con:property>OccClass</con:property>
          <con:property>S&amp;T</con:property>
          <con:property>SumAssured</con:property>
          <con:property>SumAssuredFrequency</con:property>
          <con:property>Indexation</con:property>
          <con:property>PremiumOption</con:property>
          <con:property>MortgageType</con:property>
          <con:property>PaymentPeriod</con:property>
          <con:property>Loading</con:property>
          <con:property>WaitingPeriod</con:property>
          <con:property>MentalHealth</con:property>
          <con:property>MortgageAmount</con:property>
          <con:property>WoPWaitingPeriod</con:property>
          <con:property>WoPLoading</con:property>
          <con:property>ErrorOnBenefit</con:property>
          <con:property>ExpectedMessage</con:property>
          <con:startRow/>
          <con:endRow/>
          <con:recordsPerIteration>1</con:recordsPerIteration>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:trimValues>false</con:trimValues>
          <con:entitizeValues>false</con:entitizeValues>
          <con:restartOnRun>true</con:restartOnRun>
          <con:expandProperties>false</con:expandProperties>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i refine the data" id="904f0502-d00a-467b-a619-00f690d40820">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/MIP/And_i_refine_the_data.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i get premium" id="044be4eb-1f6e-433d-b3fa-e5cb60831f51">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i get premium" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : "false",
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {          
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : "No",
            "EmploymentStatus" : "Employed",            
            "OccupationClass" : "${When i read users' information#OccClass}",             
            "Gender" : "${When i read users' information#Gender}",
            "SmokerStatus" : "${When i read users' information#Smoker}",             
            "Age" : "${When i read users' information#Age}" 
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "WaitingPeriod" : "${When i read users' information#WaitingPeriod}",
                "SumAssuredFrequency" : "${#TestCase#SUM_ASSURED_FREQUENCY}",
                "SortOrder" : 8,
                "PaymentPeriod" : "${#TestCase#PAYMENT_PERIOD}",
                "MentalHealthLimitation" : "${When i read users' information#MentalHealth}",
                "MaxInstancesOfBenefit" : "1",
                "Load" : "${#TestCase#LOAD}",
                "isMain" : true,
                "isAvailable" : true,               
                "BenefitName" : "Mortgage and Income Protection",
                "BenefitDescription" : "Mortgage and Income Protection",
                "BenefitCode" : "MortProt",
                "BenefitCategory" : "Income Protection",
                "AttributeGroup1" : "Income Protection",
                "MortgageType" : "${When i read users' information#MortgageType}",
                "MortgageRepaymentAmount" : "${When i read users' information#MortgageAmount}",
                "SumAssured" : "${#TestCase#SUM_ASSURED}",
                "isIndexed" : "${#TestCase#MIPINDEX}",
                "PremiumOption" : "${#TestCase#PRE_OPT}",
                "CommissionFactor" : "100"
              }, {
                "WaitingPeriod" : "${When i read users' information#WoPWaitingPeriod}",
                "SortOrder" : 16,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitId" : "b3a65330-c620-4fb3-b1c4-50a2c9d4ab2b",
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitId" : "ad853b55-ea12-4708-856e-bd9ae544fbbe",
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitId" : "916027c1-1d11-4910-92d4-16b292290e4a",
                    "BenefitCode" : "MortProt"
                  }, {
                    "BenefitId" : "c5a4e1e6-651b-4ef0-a53f-b3613a4f88f9",
                    "BenefitCode" : "CompLivAss"
                  }, {
                    "BenefitId" : "8c3a0d5b-324d-484c-bb99-eee765e46921",
                    "BenefitCode" : "ProgCare"
                  }, {
                    "BenefitId" : "cb42a374-560e-471e-8512-3b86fe52ce82",
                    "BenefitCode" : "TPD"
                  }, {
                    "BenefitId" : "c8ff67cf-32c9-44d7-8daf-71a30f07375d",
                    "BenefitCode" : "AccDth"
                  } ]
                },
                "MaxInstancesOfBenefit" : "1",
                "Load" :"${#TestCase#WOP_LOAD}",
                "isMain" : false,
                "isAvailable" : true,
                "BenefitId" : "89b330da-00bd-4069-bb8d-9d72bc22cc6c",
                "BenefitName" : "Waiver of Premium",
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "CommissionFactor" : "100"
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="945b9d6c-cfdf-4b3b-ac4e-c3b710d684f6" name="Script Assertion">
              <con:configuration>
                <scriptText>def expectedMessage = context.expand( '${When i read users\' information#ExpectedMessage}' ) as String
def errorOnBenefit = context.expand( '${When i read users\' information#ErrorOnBenefit}' ) as String
def actualMessage
def statusMatch
def message="" as String

if(errorOnBenefit=="MIP")
{
	def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][0][\'ErrorMessages\'][\'ErrorMessage\']}')
	if(errorMessages!="")
	{
	def parsedJson = new groovy.json.JsonSlurper().parseText(errorMessages)
	for(int i=0;i&lt;parsedJson.size();i++)
	{
		message+=parsedJson[i].get("ErrorMessage")+" "
	}
	actualMessage=message.trim()
	}
}
if(errorOnBenefit=="WoP")
{
	def errorMessages = context.expand('${And i get premium#Response#$[\'Quote\'][\'PartyRolesInQuote\'][\'PartyRoleInQuote\'][0][\'Products\'][\'Product\'][0][\'ProductBenefits\'][\'ProductBenefit\'][1][\'ErrorMessages\'][\'ErrorMessage\']}')
	if(errorMessages!="")
	{
	def parsedJson = new groovy.json.JsonSlurper().parseText(errorMessages)
	for(int i=0;i&lt;parsedJson.size();i++)
	{
		message+=parsedJson[i].get("ErrorMessage")+" "
	}
	actualMessage=message.trim()
	}
}

assert expectedMessage==actualMessage</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i compare results" id="20002820-4158-40a4-a86f-3cbf6b9e2c4a">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Validation.Rules/MIP/And_i_compare_results.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="Then i save the result to file" id="a8b98302-f249-47dc-b47c-2957aaa90afa">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>./Results/Templates/Validation.MIP.xlsx</file>
              <outfile>./Results/Validation.Rules-${=testRunner.testCase.name}.xlsx</outfile>
              <worksheet>MIP</worksheet>
              <cell>A2</cell>
              <evaluateFormulas>true</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:shared>true</con:shared>
          <con:properties>
            <con:property>
              <con:name>ScenarioName</con:name>
              <con:value>${When i read users' information#ScenarioName}</con:value>
            </con:property>
            <con:property>
              <con:name>Gender</con:name>
              <con:value>${When i read users' information#Gender}</con:value>
            </con:property>
            <con:property>
              <con:name>Age</con:name>
              <con:value>${When i read users' information#Age}</con:value>
            </con:property>
            <con:property>
              <con:name>Smoker</con:name>
              <con:value>${#TestCase#SMOKER}</con:value>
            </con:property>
            <con:property>
              <con:name>OccClass</con:name>
              <con:value>${When i read users' information#OccClass}</con:value>
            </con:property>
            <con:property>
              <con:name>S&amp;T</con:name>
              <con:value>${When i read users' information#S&amp;T}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssured</con:name>
              <con:value>${#TestCase#SUM_ASSURED}</con:value>
            </con:property>
            <con:property>
              <con:name>SumAssuredFrequency</con:name>
              <con:value>${When i read users' information#SumAssuredFrequency}</con:value>
            </con:property>
            <con:property>
              <con:name>Indexation</con:name>
              <con:value>${#TestCase#DIINDEX}</con:value>
            </con:property>
            <con:property>
              <con:name>PremiumOption</con:name>
              <con:value>${#TestCase#PRE_OPT}</con:value>
            </con:property>
            <con:property>
              <con:name>MortgageType</con:name>
              <con:value>${When i read users' information#MortgageType}</con:value>
            </con:property>
            <con:property>
              <con:name>PaymentPeriod</con:name>
              <con:value>${When i read users' information#PaymentPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>Loading</con:name>
              <con:value>${#TestCase#LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>WaitingPeriod</con:name>
              <con:value>${When i read users' information#WaitingPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>MentalHealth</con:name>
              <con:value>${#TestCase#PREMIER_OPTION}</con:value>
            </con:property>
            <con:property>
              <con:name>MortgageAmount</con:name>
              <con:value>${When i read users' information#MortgageAmount}</con:value>
            </con:property>
            <con:property>
              <con:name>WoPWaitingPeriod</con:name>
              <con:value>${When i read users' information#WoPWaitingPeriod}</con:value>
            </con:property>
            <con:property>
              <con:name>WoPLoading</con:name>
              <con:value>${#TestCase#WOP_LOAD}</con:value>
            </con:property>
            <con:property>
              <con:name>Expected Message</con:name>
              <con:value>${When i read users' information#ExpectedMessage}</con:value>
            </con:property>
            <con:property>
              <con:name>Actual Message</con:name>
              <con:value>${#TestCase#ACTUAL_MESSAGE}</con:value>
            </con:property>
            <con:property>
              <con:name>RESULT</con:name>
              <con:value>${#TestCase#STATUS}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="e4fe441d-a95c-4e76-b849-747299171ebe">
        <con:settings/>
        <con:config>
          <dataSourceStep>When i read users' information</dataSourceStep>
          <targetStep>And i refine the data</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ERROR_MESSAGE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">"Invalid Occupation Class</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMzNTk3NzI1LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMzYwMTMyNSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImE0NjMxYjZlLTFhZWYtNGRhNi05NDk0LWRkNDIwMzA5ZDE3OCIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.H_XbVUGz5wC4QP3J09ZNEI7t8-u9DzwXk39IhHR6mwiNo71ltPGWWfC4B4QXzzPMO2ND9mVhYCq82RaZQa-Y5Oy7CpIXEa47MY-sm7HuBydSERIRjpnTx4c_U31qQzejxhZYSwRtfm3l1m-UjxZKXUIz5fM_Eo5mM_20fPvYZcc</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>07/08/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>NS</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SELFEMPLOYED</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYMENTSTATUS</con:name>
          <con:value>Self-employed</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>DIINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>-1.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>R</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>PAYMENT_PERIOD</con:name>
          <con:value>70</con:value>
        </con:property>
        <con:property>
          <con:name>BENEFIT_TYPE</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>MENTAL_HEALTH</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>PREMIER_OPTION</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>WOP_LOAD</con:name>
          <con:value>2.0</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED</con:name>
          <con:value>1500</con:value>
        </con:property>
        <con:property>
          <con:name>STATUS</con:name>
          <con:value>Yes</con:value>
        </con:property>
        <con:property>
          <con:name>ACTUAL_MESSAGE</con:name>
          <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">Invalid loading [0..999]</con:value>
        </con:property>
        <con:property>
          <con:name>MIPINDEX</con:name>
          <con:value>L</con:value>
        </con:property>
        <con:property>
          <con:name>SUM_ASSURED_FREQUENCY</con:name>
          <con:value>M</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>PROJECT_PATH</con:name>
        <con:value>C:\Users\Dev.PrathibaK\api-test-automation-ide/</con:value>
      </con:property>
      <con:property>
        <con:name>SCOPE</con:name>
        <con:value>SOV.Adviser.ValidateEmail</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="27d90367-58b1-4880-a859-9770c4aa3644" name="Benefit Definition">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="497b9de8-9eb7-495f-927a-cc5063c07e3f" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(DEV)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="4c3396b6-d78c-4a3d-b20e-a348068910c1">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="5c1c3ff0-ca72-47c6-970f-adda104b0499">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="bb3c4efd-a0d7-404e-a3f1-dc90c49f1359">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="b443c1bd-5bbb-4722-8fbd-28533795a1b5">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="When i send request" id="04a46d96-7cdb-4fa7-8ee1-d8a6fb1b2425">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/products/benefit" methodName="Benefit Definition" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="When i send request" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": [
        {
          "PartyRoleDetails": {
            "LifeNumber": "1"
          },
          "Products": {
            "Product": [
              {
                "ProductCode": "TCMP",
                "Channel": "SOVHUB",
                "ProductBenefits": {
                  "ProductBenefit": [
                    {
                      "BenefitName": "Life Cover",
                      "BenefitCode": "LC",
                      "BenefitType": "Life",
                      "BenefitDescription": "Life Cover"
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i get the interface definition" id="f830c250-b3b8-449e-91ef-997676ca1567">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Benefit.Definition/Then_i_get_the_interface.definition.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMTQyODY1OSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzE0MzIyNTksIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiJjNTQwYTRiNy0xODQ5LTQ0ZDQtYjIyNS1hNjZkY2YyYzYxZjMiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.dP93W_W2KyGUQLhqYzzZR_DbmDZ8vvyj_6O1VR1nr9xGGz7V-mSBMPcIRpdc74gMpw9gE2hFUEKzZACBl6HBkg9ppJc3KWwfvBOhH7ifZRGHByHoTEG43lCmqHpb2l8DALg854-9NDiy6mgrUigPXoE9I-IFfHQ_h7Ja-6loPAs</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>13/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value>12345</con:value>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value>John</con:value>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value>DOE</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>396.74</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>402.89</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="924fa392-b3ae-4bb3-bbf9-a1aec5ae7b00" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(FST)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="138fe31b-eec0-404b-b591-8c40aee42fa0">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="c581d85d-ecf6-434f-80fd-b5fbfe7d550b">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="476ca51c-c2f0-443e-9bee-74ff85276cc7">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="bea93b5c-69ab-45a5-a9b7-1acc17e4bbbd">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="When i send request" id="2b35af64-909b-49e8-b939-7589f2f41337">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/products/benefit" methodName="Benefit Definition" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="When i send request" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": [
        {
          "PartyRoleDetails": {
            "LifeNumber": "1"
          },
          "Products": {
            "Product": [
              {
                "ProductCode": "TCMP",
                "Channel": "SOVHUB",
                "ProductBenefits": {
                  "ProductBenefit": [
                    {
                      "BenefitName": "Life Cover",
                      "BenefitCode": "LC",
                      "BenefitType": "Life",
                      "BenefitDescription": "Life Cover"
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i get the interface definition" id="0e311cf6-6456-44a9-9a85-7a73d383aa21">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Benefit.Definition/Then_i_get_the_interface.definition.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUyOTM4MDU1NCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MjkzODQxNTQsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI4MGFjOGJhZC1hN2MxLTQ1MmQtYWQzMS1lNDU2ZGNmODExOGEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.QVPGuHADqKJV0MiN5Ga8xfcaYeniJSxSc6qrJMAqxfP4Yq05t6ZkeRl9JHcaO_0t8M3xWn9bB7rLvbkcknQg-ya4uwMRXBFUnJBZtRqRorWQGcNJJIl6YqG7zvBhmCxvTiMm02ls8ViOp6GvlRB2PwFxKofOaEC-cyGO3F3Rt4Y</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>19/06/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value>12345</con:value>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value>John</con:value>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value>DOE</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>396.74</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>402.89</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="c909cfd0-af3a-483e-a141-52105f91a32b" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Life(QA)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="c63b2ece-b98b-4c2a-8508-5b0f9a1db2c5">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="41e4ac9f-9472-4d63-b823-fc2422748609">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="77b2f89b-c69c-4e44-bd3f-7e964dc8f292">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="75bca766-27b8-4041-98c7-a60a98724346">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="When i send request" id="c5e70c38-025d-4f91-a848-4d36372722b3">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/products/benefit" methodName="Benefit Definition" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="When i send request" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": [
        {
          "PartyRoleDetails": {
            "LifeNumber": "1"
          },
          "Products": {
            "Product": [
              {
                "ProductCode": "TCMP",
                "Channel": "SOVHUB",
                "ProductBenefits": {
                  "ProductBenefit": [
                    {
                      "BenefitName": "Life Cover",
                      "BenefitCode": "LC",
                      "BenefitType": "Life",
                      "BenefitDescription": "Life Cover"
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i get the interface definition" id="b06db9ef-aea7-439a-9b36-fb816011836e">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Benefit.Definition/Then_i_get_the_interface.definition.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTI5NTUxMTYxLCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUyOTU1NDc2MSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImVkNzQ3MzI3LTU3YjYtNDc0Ny1iMTNhLTU3ZjdkMmVhMWQ3MiIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.eFHaZO6LgWjmHzyfSvFqmCrW3fAg3KVIgPHxkCz5UmV9Ff7uLKrgrEZuZLsxoT4owJPnXbj0ttfPh-2ColcjwJ_akMIvMMuWrtzgydrAmxSYTcCmz8smqOAKACD2_vKaNa9_KKhsBwcpCjeFPJkizI40-ENrRxOBS2scWRYQRJM</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>21/06/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value>12345</con:value>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value>John</con:value>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value>DOE</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>396.74</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>402.89</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>SCOPE</con:name>
        <con:value>SOV.Adviser.ValidateEmail</con:value>
      </con:property>
      <con:property>
        <con:name>PROJECT_PATH</con:name>
        <con:value>C:\Users\Dev.PrathibaK\api-test-automation-ide/</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="dc53bcb7-6915-4b0a-8d7c-306c4855fd74" name="Products and Benefits">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="72ebf569-179d-4ae2-909e-6b596cf03a18" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="DEV" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="9433dc1a-4f2f-4951-aa1d-6bfcd805a2c3">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="afb3200e-6191-4291-b3a4-2c4d8eef1844">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="e3e8bd23-fd43-4b16-96ed-ee3885e30453">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="5a583059-9889-4b61-9e92-8d429d15e527">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="When i request products and benefits" id="5acfd517-f8ed-4820-a9db-3a4bca65c15e">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/products" methodName="Products Benefits" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="When i request products and benefits" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "Age": "20"
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i get the list" id="de7955fe-a3bd-4d79-89c9-686021c2eb8b">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Products.and.Benefits/Then_i_get_the_list.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMTQyODY3NSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzE0MzIyNzUsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiIwNzRkZDMxNi0wZDBiLTRmYWUtOGJkNy01Yjk0NTQ2MWU1YjAiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.XR-nY_uOkTaGrEJSk6pikDfdNaGVWU_3nT4mFPUluwPuABBE6Rgbtuj5eKM7ZUyX7LYyNzm6s1JCG4pNTPvB8YSZik5ZUhanK6JEYjycBKfGzov1tqm86hVazZeN4Y86H9H1Gm0E4xxgo6Sh7Pns1k_P-GJ4rEovgkIkBmKrWZQ</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>13/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value>12345</con:value>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value>John</con:value>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value>DOE</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>396.74</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>402.89</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="bb2fc054-63e0-472b-bb87-51258c49ef37" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="FST" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="eafd7b60-ea44-4f75-8cbb-e99e13dd9f3a">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="6170bcea-6820-4799-99d7-caefaf3744db">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="a72e636a-b2e1-4cb7-9ee3-7218487b9167">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="1025beed-3f19-4319-8326-9f64497cc8e3">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="When i request products and benefits" id="3bdaf5f0-f42d-4dc6-bac6-3e6e5f64fa41">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/products" methodName="Products Benefits" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="When i request products and benefits" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "Age": "20"
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i get the list" id="551aa454-6e49-4e2c-aeac-e58002c13284">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Products.and.Benefits/Then_i_get_the_list.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUyOTM4MDUxNywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MjkzODQxMTcsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiI1NWQ1M2RiZi1mMTRjLTQxOGItOGZmMC00NzkwNDE5NDFhOTgiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.lNV-5nOu2fpWpuPV9bX3jmcIsIhCVntWIi3McBppCR-q3VtIyR0T7wH4xkrUDTn5ev4ph6QGohLBkvgCf97WgEGhpR1LugLZZNKMFzVRI0g-eN8Gpk5xFvQLZaxxbopJmagFii4MWoQpouorFQChl0JoZ61m3f1rtXk2YLb9uCc</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>19/06/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value>12345</con:value>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value>John</con:value>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value>DOE</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>396.74</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>402.89</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="f93e41a6-eaf6-49c0-b999-ac566d76a3c8" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="QA" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="">
      <con:description>Check list for Clone:

1. Change request endpoints.</con:description>
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">true</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given i can access the api" id="745203f8-00f8-47c9-bf36-8facf4d4aeb5">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="6954084b-4568-429b-a0f6-9983c1dfa7c4">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestSuite#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="And i extract the token" id="24ff3ae3-9b46-4a0e-a985-9738cc3835fc">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And the token is valid" id="3d200731-6426-4c33-b851-8a059376a4d0">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And the token is valid" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=oracle-idm%3A%2Foauth%2Fgrant-type%2Fresource-access-token%2Fjwt&amp;oracle_token_action=validate&amp;scope=${#TestSuite#SCOPE}&amp;assertion=${#TestCase#ACCESS_TOKEN}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="bf7717e8-d725-40e5-9ed7-98fea999cbcf" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Existence Match" id="49949dbe-4baa-4c1e-930a-71ed8aa0c894" name="JsonPath Existence Match">
              <con:configuration>
                <path>$['successful']</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="When i request products and benefits" id="4ea861c6-c8c5-4626-8c00-3a17c6cb0bf5">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/products" methodName="Products Benefits" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="When i request products and benefits" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${And i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote": {
    "QuoteNumber": "",
    "PartyRolesInQuote": {
      "PartyRoleInQuote": {
        "PartyRoleDetails": {
          "LifeNumber": "1",
          "Party": {
            "Age": "20"
          }
        }
      }
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Then i get the list" id="4551a793-efe0-4605-a391-94cc79eb5034">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/Products.and.Benefits/Then_i_get_the_list.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyMzk1NjU1LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjM5OTI1NSwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6Ijk1NzViZWJiLWY1ODUtNGUxNy05YzY2LTFlMGEyYTkwMmVjMSIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.QGG5viwIbXNCXbkX3rTpi0clpk8vcrfZ7NP-Ii7uzdwWEK8xUONlGsOZpYx_QvoMcDNWCLeMhJmusFTQq5n2zykc2XgAzO4EqoHtYTNrhZnKy5DdP1N8-4d9o6nlIMiGN-_0s-lam6na5hXPAKeAqEVhLfGEWZ6DZxDO-n9tcHg</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>24/07/18</con:value>
        </con:property>
        <con:property>
          <con:name>SMOKER</con:name>
          <con:value>No</con:value>
        </con:property>
        <con:property>
          <con:name>SEGT3</con:name>
          <con:value>false</con:value>
        </con:property>
        <con:property>
          <con:name>FREQUENCY</con:name>
          <con:value>Monthly</con:value>
        </con:property>
        <con:property>
          <con:name>QUOTENUMBER</con:name>
          <con:value>12345</con:value>
        </con:property>
        <con:property>
          <con:name>FIRSTNAME</con:name>
          <con:value>John</con:value>
        </con:property>
        <con:property>
          <con:name>LASTNAME</con:name>
          <con:value>DOE</con:value>
        </con:property>
        <con:property>
          <con:name>EMPLOYEDSTATUS</con:name>
          <con:value>Employed</con:value>
        </con:property>
        <con:property>
          <con:name>GENDER</con:name>
          <con:value>Male</con:value>
        </con:property>
        <con:property>
          <con:name>LIFEINDEX</con:name>
          <con:value>Level</con:value>
        </con:property>
        <con:property>
          <con:name>LOAD</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PASS</con:name>
          <con:value>YES</con:value>
        </con:property>
        <con:property>
          <con:name>DIFF</con:name>
          <con:value>0.0</con:value>
        </con:property>
        <con:property>
          <con:name>PRE_OPT</con:name>
          <con:value>Rate for Age</con:value>
        </con:property>
        <con:property>
          <con:name>REVIEW_TERM</con:name>
          <con:value>1</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_COMMISSION</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_LIFE</con:name>
          <con:value>396.74</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_PF</con:name>
          <con:value>6.15</con:value>
        </con:property>
        <con:property>
          <con:name>SHEET_TOTAL</con:name>
          <con:value>402.89</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>abc6942c-1bc8-40d1-906a-88948dafa0dd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d3d1572b-4aac-4e6b-992c-2f0e62c5d4e5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>PROJECT_PATH</con:name>
        <con:value>C:\Users\Dev.PrathibaK\api-test-automation-ide/</con:value>
      </con:property>
      <con:property>
        <con:name>SCOPE</con:name>
        <con:value>SOV.Adviser.ValidateEmail</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="dfc07c77-109e-4060-8521-5a00dd57ddf6" name="Smoke">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="1e946bc8-5690-413e-bccf-5c16d16d9309" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="FST" searchProperties="true" timeout="0">
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given settings are loaded" id="23d1445b-2142-41ae-b8f4-be8bc6c69750">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="4cc7ff5c-5244-4001-b77c-08073f9be6c7">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestCase#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="When i extract the token" id="49f98183-5a3e-4c04-bfd1-050bbfc56325">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Then i request and get response" id="dc919579-3d33-40fd-869f-7cede0755267">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Then i request and get response" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${When i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.fst.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{  
   "Quote":{  
      "PartyRolesInQuote":{  
         "PartyRoleInQuote":[  
            {  
               "Products":{  
                  "Product":[  
                     {  
                        "ProductBenefits":{  
                           "ProductBenefit":[  
                              {  
                                 "CommissionFactor":"70",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"Trauma",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {  
                                          "Values":"Trauma",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"Trauma",
                                 "BenefitCode":"CompLivAss",
                                 "BenefitDescription":"Living Assurance",
                                 "BenefitName":"Accelerated Living Assurance",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"fe5b6b71-c576-4850-bef5-f7951e2195f7",
                                 "isAvailable":true,
                                 "isMain":false,
                                 "LinkType":"A",
                                 "Load":"50.0",
                                 "LoadingPerMille":"4",
                                 "LoadingTerm":"13",
                                 "MaxInstancesOfBenefit":"4",
                                 "ParentBenefits":{  
                                    "ParentBenefit":[  
                                       {  
                                          "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                          "BenefitCode":"Life"
                                       }
                                    ]
                                 },
                                 "PremiumOption":"10",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":5,
                                 "SumAssured":"137515"
                              },
                              {  
                                 "CommissionFactor":"70",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"TPD",
                                          "Name":"SumAssuredValidation",
                                          "Description":"SumAssuredValidation"
                                       },
                                       {  
                                          "Values":"TPD",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"TPD",
                                 "BenefitCode":"TPD",
                                 "BenefitDescription":"Accelerated Total Permanent Disablement",
                                 "BenefitName":"Accelerated Total Permanent Disablement",
                                 "BenefitTerm":"70",
                                 "BenefitType":"AOCC",
                                 "Channel":"SOVHUB",
                                 "BenefitId":"84d60d6b-5c9b-420b-8ed7-30475a8ad023",
                                 "isAvailable":true,
                                 "isMain":false,
                                 "LinkType":"A",
                                 "Load":"0.0",
                                 "LoadingPerMille":"3",
                                 "LoadingTerm":"19",
								 "MaxInstancesOfBenefit":"4",
                                 "ParentBenefits":{  
                                    "ParentBenefit":[  
                                       {  
                                          "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                          "BenefitCode":"Life"
                                       }
                                    ]
                                 },
                                 "PremiumOption":"10",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":13,
                                 "SumAssured":"279478"
                              },
                              {  
                                 "CommissionFactor":"70",
                                 "AttributeGroups":{  
                                    "AttributeGroup":[  
                                       {  
                                          "Values":"Life",
                                          "Name":"OutputDisplay",
                                          "Description":"OutputDisplay"
                                       }
                                    ]
                                 },
                                 "BenefitCategory":"Life",
                                 "BenefitCode":"Life",
                                 "BenefitDescription":"Life Cover",
                                 "BenefitName":"Life Cover",
                                 "Channel":"SOVHUB",
                                 "ExistingCover":"N",
                                 "BenefitId":"7b45d706-a282-4ec7-90bf-20e011131623",
                                 "isAvailable":true,
                                 "isIndexed":"L",
                                 "isMain":true,
                                 "Load":"150.0",
                                 "LoadingPerMille":"2",
								 "LoadingTerm":"14",
                                 "MaxInstancesOfBenefit":"4",
                                 "PremiumOption":"10",
                                 "ProductCode":"TCMP",
                                 "ProductName":"TotalCare Max - Personal",
                                 "SortOrder":1,
                                 "SumAssured":"482890"
                              }
                           ]
                        },
                        "Channel":"SOVHUB",
                        "ProductName":"TotalCare Max - Personal",
                        "ProductCode":"TCMP"
                     }
                  ]
               },
               "PartyRoleDetails":{  
                  "Party":{  
                     "selfEmployedGT3Years":"No",
                     "EmploymentStatus":"Self-employed",                   
                     "OccupationClass":"2",                   
                     "Gender":"M",
                     "SmokerStatus":"NS",                   
                     "Age":"22" 
                  },                 
                  "LifeNumber":1
               }
            }
         ]
      },
      "TCMPPolicyFee":"true",
      "PaymentFrequency":"Monthly",   
      "QuoteNumber":""
   }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>SCOPE</con:name>
          <con:value>SOV.Adviser.ValidateEmail</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d38e418cf90e410ca4448a6d1a650710</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XbDmLnEFDk</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzNDIxNDIyNywib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzQyMTc4MjcsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJkOGZkMWE4YS05YWVkLTRhMTEtYWJkYi0zYTc1MjNmNzRiMGEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.X-Zuqjxj-FlODbrJfn3SzOORbP9X4w8xFMi8gtVfNPT06IYyT0nPhaaw7zquR7dob-7S5Yl4jaNyZRMuILeuJxZMJu0QveNN603u_Lvob3MIewMXxDLUy7khxxKPrIu0G2jXv1QXFXBToS-1xZUIdfMJyL11EKZMoQxUOF2zjio</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>14/08/18</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8f7b010a-41a4-459d-8687-b7252acf8b81</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="936349da-d10d-43ba-9a19-f9866a029a59" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="DEV" searchProperties="true" timeout="0">
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given settings are loaded" id="81588e2c-f337-44a8-ba99-12252b054fe6">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="7121c6f8-5f97-43a8-9b3b-80ca2810e58d">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestCase#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="When i extract the token" id="3f90f2dd-7ed3-4202-a72c-389f79050a6b">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Then i request and get response" id="1cdbf01a-6e7c-4ae9-9647-fcfffaf78fc4">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Then i request and get response" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${When i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.dev.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
  "Quote" : {
    "QuoteNumber" : "fe47625b-63cd-4e39-b838-10d7eb02c085",
    "PaymentFrequency" : "Monthly",
    "TCMPPolicyFee" : false,
    "PartyRolesInQuote" : {
      "PartyRoleInQuote" : [ {
        "PartyRoleDetails" : {
          "LifeNumber" : 1,
          "LifeAssuredPremium" : null,
          "Party" : {
            "selfEmployedGT3Years" : null,
            "EmploymentStatus" : "Employed",
            "OccupationClass" : "1",
            "Gender" : "Male",
            "SmokerStatus" : "No",
            "Age" : "33"
          }
        },
        "Products" : {
          "Product" : [ {
            "ProductCode" : "TCMP",
            "Channel" : "SOVHUB",
            "ProductName" : "TotalCare Max - Personal",
            "ProductBenefits" : {
              "ProductBenefit" : [ {
                "SumAssuredFrequency" : "Annually",
                "Load" : "0",
                "PaymentPeriod" : "1 year",
                "WaitingPeriod" : "4",
                "PremiumOption" : "Rate for Age",
                "BenefitType" : "Agreed Value",
                "MentalHealthLimitation" : "No",
                "isIndexed" : "Level",
                "BenefitTerm" : "To Age 65",
                "SumAssured" : "232323",
                "PremierOption" : "No",
                "ReviewTerm" : "",
                "MaxInstancesOfBenefit" : "2",
                "isAvailable" : true,
                "isMain" : true,
                "BenefitDescription" : "Income Protection",
                "BenefitCategory" : "Income Protection",
                "BenefitCode" : "DI",
                "BenefitName" : "Income Protection",
                "CommissionFactor" : 100
              }, {
                "PaymentPeriod" : "To Age 65",
                "Load" : "0",
                "WaitingPeriod" : "4",
                "isIndexed" : "",
                "PremiumOption" : "Rate for Age",
                "SumAssured" : "",
                "BenefitTerm" : "To Age 65",
                "ReviewTerm" : "",
                "MaxInstancesOfBenefit" : "1",
                "isAvailable" : true,
                "ParentBenefits" : {
                  "ParentBenefit" : [ {
                    "BenefitCode" : "Life"
                  }, {
                    "BenefitCode" : "DI"
                  }, {
                    "BenefitCode" : "MortProt"
                  } ]
                },
                "isMain" : false,
                "BenefitDescription" : "Waiver of Premium",
                "BenefitCode" : "WOP",
                "BenefitName" : "Waiver of Premium",
                "CommissionFactor" : 100
              } ]
            }
          } ]
        }
      } ]
    }
  }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>SCOPE</con:name>
          <con:value>SOV.Adviser.ValidateEmail</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>4101cbfced9049038f8a8f70e08afdbb</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>2C449kwEGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUzMDgyNDEwOSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MzA4Mjc3MDksIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiJhMjlmN2ZjMi0yYTAwLTRmZWEtOGZhYS1iOTkwNDM5NzQ2NWEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.D3-q6i_NNsmwKwMpYVRH9dZ5R9jvNd7kun8imegx5EhHHV0uHCY_NKKzxoFhpjxBPVkeldvhfuYRbpth0BBWy2wYlNfczLjl33yIALmxSm0cBrrVawjWak7uw-THygTaavlSLqFioegkf2cCf1WmrZzMFsRpoXFHZUazCgZGu7I</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>06/07/18</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8f7b010a-41a4-459d-8687-b7252acf8b81</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="82d3c741-e55f-460a-a24a-db9724732b60" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="QA" searchProperties="true" timeout="0">
      <con:settings>
        <con:setting id="IncludeOverview">true</con:setting>
        <con:setting id="IncludeResults">true</con:setting>
        <con:setting id="FlowLayout">false</con:setting>
        <con:setting id="ErrorDetails">true</con:setting>
        <con:setting id="IncludeCoverage">true</con:setting>
      </con:settings>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="groovy" name="Given settings are loaded" id="8f7b010a-41a4-459d-8687-b7252acf8b81">
        <con:settings/>
        <con:config>
          <script>def env = testRunner.testCase.testSuite.project.getPropertyValue("EnvJ") as String
def projectPath = env != "Jenkins" ? new com.eviware.soapui.support.GroovyUtils(context).projectPath + "/" as String : ""
testRunner.testCase.testSuite.setPropertyValue("PROJECT_PATH", projectPath)
String file =  projectPath + "Scripts/TOKEN/Given_i_can_access_the_api.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="And i request an access token" id="13531d16-c522-492a-b8aa-0d452cfb811d">
        <con:settings/>
        <con:config service="REST Service 1" resourcePath="/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens" methodName="RequestToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="And i request an access token" id="95c2c6d8-a4ae-4650-8042-e1235a37a39f" mediaType="application/x-www-form-urlencoded" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://sso.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>grant_type=client_credentials&amp;scope=${#TestCase#SCOPE}</con:request>
            <con:originalUri>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="52e9ab2f-67ce-4043-8ace-7b73b1129dcc" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:username>${#TestCase#TOKEN_USER}</con:username>
              <con:password>${#TestCase#TOKEN_PWD}</con:password>
              <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
              <con:preemptive>true</con:preemptive>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>Preemptive</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>Basic</con:authProfile>
                <con:username>${#TestCase#TOKEN_USER}</con:username>
                <con:password>${#TestCase#TOKEN_PWD}</con:password>
                <con:preemptive>true</con:preemptive>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="When i extract the token" id="3d102505-3174-42df-85df-49ef02579588">
        <con:settings/>
        <con:config>
          <script>String projectPath = testRunner.testCase.testSuite.getPropertyValue("PROJECT_PATH")
String file =  projectPath + "Scripts/TOKEN/And_i_extract_the_token.groovy"
evaluate(new File(file))</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Then i request and get response" id="6bf30f84-0e2d-4e61-a05b-f7cfb1751ca7">
        <con:settings/>
        <con:config service="REST Service API" resourcePath="/quote/v2/calculate/premium" methodName="Calculate Premium" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Then i request and get response" id="f25fc231-4f07-4ce6-8b83-637e6f7b78f8" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="${When i extract the token#result}" xmlns="http://eviware.com/soapui/config"/></con:setting>
            </con:settings>
            <con:endpoint>https://api.qa.sovcloud.sovereign.co.nz</con:endpoint>
            <con:request>{
   "Quote" : {
      "QuoteNumber" : "",
      "PaymentFrequency" : "Monthly",
      "TCMPPolicyFee" : "false",
      "PartyRolesInQuote" : {
         "PartyRoleInQuote" : [
            {
               "PartyRoleDetails" : {
                  "LifeNumber" : 1,
                  "LifeAssuredPremium" : null,
                  "Party" : {
                     "selfEmployedGT3Years" : "No",
                     "EmploymentStatus" : "Employed",
                     "OccupationClass" : "3",
                     "Gender" : "M",
                     "SmokerStatus" : "S",
                     "Age" : "33"
                  }
               },
               "Products" : {
                  "Product" : [
                     {
                        "ProductCode" : "TCMP",
                        "Channel" : "SOVHUB",
                        "ProductName" : "TotalCare Max - Personal",
                        "ProductBenefits" : {
                           "ProductBenefit" : [
                              {
                                 "SumAssuredFrequency" : "M",
                                 "Load" : "0.0",
                                 "PaymentPeriod" : "5Y",
                                 "WaitingPeriod" : "2",
                                 "PremiumOption" : "65",
                                 "BenefitType" : "AV",
                                 "MentalHealthLimitation" : "No",
                                 "isIndexed" : "I",
                                 "BenefitTerm" : "",
                                 "SumAssured" : "0",
                                 "PremierOption" : "No",
                                 "ReviewTerm" : "",
                                 "MaxInstancesOfBenefit" : "2",
                                 "isAvailable" : true,
                                 "isMain" : true,
                                 "BenefitDescription" : "Income Protection",
                                 "BenefitCategory" : "Income Protection",
                                 "BenefitCode" : "DI",
                                 "BenefitName" : "Income Protection",
                                 "CommissionFactor" : "100"
                              },
                              {
                                 "PaymentPeriod" : "",
                                 "Load" : "0.0",
                                 "WaitingPeriod" : "104",
                                 "isIndexed" : "",
                                 "PremiumOption" : "",
                                 "SumAssured" : "",
                                 "BenefitTerm" : "",
                                 "ReviewTerm" : "",
                                 "MaxInstancesOfBenefit" : "1",
                                 "isAvailable" : true,
                                 "ParentBenefits" : {
                                    "ParentBenefit" : [
                                       {
                                          "BenefitCode" : "Life"
                                       },
                                       {
                                          "BenefitCode" : "DI"
                                       },
                                       {
                                          "BenefitCode" : "MortProt"
                                       }
                                    ]
                                 },
                                 "isMain" : false,
                                 "BenefitDescription" : "Waiver of Premium",
                                 "BenefitCode" : "WOP",
                                 "BenefitName" : "Waiver of Premium",
                                 "CommissionFactor" : "100"
                              }
                           ]
                        }
                     }
                  ]
               }
            }
         ]
      }
   }
}</con:request>
            <con:originalUri>https://api.dev.sovcloud.sovereign.co.nz/quote/v1/products</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="0f94a17d-e310-4405-9593-e04c3e164817" name="Valid HTTP Status Codes">
              <con:settings/>
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder>
              <con:entry/>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
              <con:entry environmentId="6b6b63ca-74f3-493f-8211-0e2fbdd99a8f">
                <con:authProfile>No Authorization</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>SCOPE</con:name>
          <con:value>SOV.Adviser.ValidateEmail</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_USER</con:name>
          <con:value>d8e3649f9e3d4ed1b8adb540e9f8c913</con:value>
        </con:property>
        <con:property>
          <con:name>TOKEN_PWD</con:name>
          <con:value>XPJNTyxIwuACGO</con:value>
        </con:property>
        <con:property>
          <con:name>ACCESS_TOKEN</con:name>
          <con:value>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IkJHYkdjRW1maV9WUVJkYk1FSUpFNHNHTWFsbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImlzcyI6InNzby5xYS5zb3ZjbG91ZC5zb3ZlcmVpZ24uY28ubnoiLCJvcmFjbGUub2F1dGguc3ZjX3BfbiI6IkFQSVNlcnZpY2VQcm9maWxlIiwiaWF0IjoxNTMyMzkwOTU2LCJvcmFjbGUub2F1dGgucHJuLmlkX3R5cGUiOiJDbGllbnRJRCIsImV4cCI6MTUzMjM5NDU1Niwib3JhY2xlLm9hdXRoLnRrX2NvbnRleHQiOiJyZXNvdXJjZV9hY2Nlc3NfdGsiLCJwcm4iOiJkOGUzNjQ5ZjllM2Q0ZWQxYjhhZGI1NDBlOWY4YzkxMyIsImp0aSI6ImU5MGUyZjhhLTY2NzEtNDIzNC1hODNhLTdjMTM0MmE0YmE0NyIsIm9yYWNsZS5vYXV0aC5jbGllbnRfb3JpZ2luX2lkIjoiZDhlMzY0OWY5ZTNkNGVkMWI4YWRiNTQwZTlmOGM5MTMiLCJvcmFjbGUub2F1dGguc2NvcGUiOiJTT1YuQWR2aXNlci5WYWxpZGF0ZUVtYWlsIiwidXNlci50ZW5hbnQubmFtZSI6IkFQSSIsIm9yYWNsZS5vYXV0aC5pZF9kX2lkIjoiMTk0NTIxZmUtYWI3Zi00NmVkLThkNzctZjYzOTJjZGZiY2E1In0.T3DsIukv8Jv5sofAa9mEDqjCoFuDVXha2asTENRF_hAk7n4nhBZieT91m0OtMsdYrJ3WadKtmt8ToGpkaa7Sf6qt-fQmQyCR2n81lzOk_cx1zUX_MZkBYkF5eO5szAYeI-139bVzQzsLMVLnmsv-S76ai-t2Gnn7RTKu-ljE02A</con:value>
        </con:property>
        <con:property>
          <con:name>THEDATE</con:name>
          <con:value>24/07/18</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>bd064a5b-5a83-40d7-b821-b7cc24b6cbdd</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>52c70d11-96b3-41dc-8aa2-c820f0997e5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>203c9029-a876-4593-8db8-369b443fb64c</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>368b2ced-c40d-4190-ade3-407a9f9c94be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>146f0245-11a8-41aa-82cb-74e0977cb0ae</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2979d739-e915-4730-ae7f-ca2b4fd2b29a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ddd93388-12a3-4b8f-abfb-160f3814925b</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>c1e2082e-c3cb-4364-87be-74c461ef9ce2</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>47e5d8e4-4f12-4b1a-806d-f8a10b2ce0a0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2b5dcce5-2629-4d8a-8c3e-98873afda9be</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>be1e5ef1-7a7e-436e-b1bd-35313b41344e</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>8f7b010a-41a4-459d-8687-b7252acf8b81</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>PROJECT_PATH</con:name>
        <con:value>C:\Users\Dev.PrathibaK\api-test-automation-ide/</con:value>
      </con:property>
      <con:property>
        <con:name>SCOPE</con:name>
        <con:value>SOV.Adviser.ValidateEmail</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:requirements/>
  <con:properties>
    <con:property>
      <con:name>RUN</con:name>
      <con:value>2</con:value>
    </con:property>
    <con:property>
      <con:name>PASSED</con:name>
      <con:value>2</con:value>
    </con:property>
    <con:property>
      <con:name>FAILED</con:name>
      <con:value>0</con:value>
    </con:property>
    <con:property>
      <con:name>INVALID</con:name>
      <con:value>0</con:value>
    </con:property>
    <con:property>
      <con:name>START</con:name>
      <con:value>15:49:22 14/08/2018</con:value>
    </con:property>
    <con:property>
      <con:name>END</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>EnvJ</con:name>
      <con:value/>
    </con:property>
    <con:property>
      <con:name>TOKEN_START</con:name>
      <con:value>15:49:28 14/08/2018</con:value>
    </con:property>
  </con:properties>
  <con:wssContainer/>
  <con:databaseConnectionContainer/>
  <con:jmsConnectionContainer/>
  <con:oAuth2ProfileContainer>
    <con:oAuth2Profile>
      <con:name>Profile</con:name>
      <con:type>OAuth 2.0</con:type>
      <con:accessToken>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUyNTg0MTE2OSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MjU4NDQ3NjksIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiJjMTIxM2ZjNi1mYzhhLTQ5OGYtYjY5MC0wMDc2MjQzNDYxMjEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.RgIEZfoiQySX_CAwp5jnHvwiMajhs1gvKYKgJbQlEEIpS0fPUY2TTvOPK69Cc9fzrle9m5-qZ-Dl1_GFJEnNsMzp-EHOMxnx8CirxFgLrAmCE9yy0-M_rXKYS6GZY58boWaQz6YcaZY5edywuP8vgdx6VJjdzoAyETYckznxfVA</con:accessToken>
      <con:accessTokenPosition>HEADER</con:accessTokenPosition>
      <con:accessTokenStartingStatus>ENTERED_MANUALLY</con:accessTokenStartingStatus>
      <con:manualAccessTokenExpirationTimeUnit>SECONDS</con:manualAccessTokenExpirationTimeUnit>
      <con:oAuth2Flow>CLIENT_CREDENTIALS_GRANT</con:oAuth2Flow>
      <con:refreshAccessTokenMethod>AUTOMATIC</con:refreshAccessTokenMethod>
      <con:responseType>id_token</con:responseType>
    </con:oAuth2Profile>
    <con:oAuth2Profile>
      <con:name>authProfile</con:name>
      <con:type>OAuth 2.0</con:type>
      <con:accessTokenURI>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:accessTokenURI>
      <con:accessToken>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUyNTk5MDkxNCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MjU5OTQ1MTQsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJiOTllOGJiMi01YTNjLTQ0ZjgtOTg0ZC00YTNmODQ1OWIwZWEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.N8Jvp2Rvad9WWGMNvlbIHEDAT57IfD799V_raspJ6WLxoFyiYk0g-hmthxyx3mjb5swSJJuu1YW_p7yNaUbr_zz9Y3h-x5nFyKYCqU2XW02QYKYEi3FSVHJtW8Wu0fSPKvSnH09RUjjDhiqyQzzMWVob7DFjyNfTHWNxV3vPMD4</con:accessToken>
      <con:accessTokenPosition>HEADER</con:accessTokenPosition>
      <con:accessTokenStartingStatus>ENTERED_MANUALLY</con:accessTokenStartingStatus>
      <con:manualAccessTokenExpirationTime/>
      <con:manualAccessTokenExpirationTimeUnit>SECONDS</con:manualAccessTokenExpirationTimeUnit>
      <con:clientID/>
      <con:clientSecret/>
      <con:oAuth2Flow>CLIENT_CREDENTIALS_GRANT</con:oAuth2Flow>
      <con:refreshAccessTokenMethod>AUTOMATIC</con:refreshAccessTokenMethod>
      <con:scope>SOV.Adviser.ValidateEmail</con:scope>
      <con:useAuthHeader>false</con:useAuthHeader>
      <con:jwtConfiguration/>
      <con:responseType>id_token</con:responseType>
    </con:oAuth2Profile>
  </con:oAuth2ProfileContainer>
  <con:oAuth1ProfileContainer/>
  <con:reporting>
    <con:xmlTemplates/>
    <con:parameters/>
  </con:reporting>
  <con:authRepository>
    <con:oAuth20AuthEntry>
      <con:name>Profile</con:name>
      <con:type>OAuth 2.0</con:type>
      <con:accessToken>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6IjFya2NlVk9zMXp6a1NuWjA1V3dUTnFzcmRKbyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiI0MTAxY2JmY2VkOTA0OTAzOGY4YThmNzBlMDhhZmRiYiIsImlzcyI6InNzby5kZXYuc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUyNTg0MTE2OSwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MjU4NDQ3NjksIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiNDEwMWNiZmNlZDkwNDkwMzhmOGE4ZjcwZTA4YWZkYmIiLCJqdGkiOiJjMTIxM2ZjNi1mYzhhLTQ5OGYtYjY5MC0wMDc2MjQzNDYxMjEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6IjQxMDFjYmZjZWQ5MDQ5MDM4ZjhhOGY3MGUwOGFmZGJiIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6ImNhZmUwNmJjLThkODUtNGIwOC04MmVkLTBiZWE0YmQ0NDM3NSJ9.RgIEZfoiQySX_CAwp5jnHvwiMajhs1gvKYKgJbQlEEIpS0fPUY2TTvOPK69Cc9fzrle9m5-qZ-Dl1_GFJEnNsMzp-EHOMxnx8CirxFgLrAmCE9yy0-M_rXKYS6GZY58boWaQz6YcaZY5edywuP8vgdx6VJjdzoAyETYckznxfVA</con:accessToken>
      <con:accessTokenPosition>HEADER</con:accessTokenPosition>
      <con:accessTokenStartingStatus>ENTERED_MANUALLY</con:accessTokenStartingStatus>
      <con:manualAccessTokenExpirationTimeUnit>SECONDS</con:manualAccessTokenExpirationTimeUnit>
      <con:oAuth2Flow>CLIENT_CREDENTIALS_GRANT</con:oAuth2Flow>
      <con:refreshAccessTokenMethod>AUTOMATIC</con:refreshAccessTokenMethod>
      <con:responseType>id_token</con:responseType>
    </con:oAuth20AuthEntry>
    <con:oAuth20AuthEntry>
      <con:name>authProfile</con:name>
      <con:type>OAuth 2.0</con:type>
      <con:accessTokenURI>https://sso.dev.sovcloud.sovereign.co.nz/ms_oauth/oauth2/endpoints/APIserviceprofile/tokens</con:accessTokenURI>
      <con:accessToken>eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsIng1dCI6ImtGT0dKckxzdE05LURVbWxEUGtta2Y3eVMtdyIsImtpZCI6Im9yYWtleSJ9.eyJzdWIiOiJkMzhlNDE4Y2Y5MGU0MTBjYTQ0NDhhNmQxYTY1MDcxMCIsImlzcyI6InNzby5mc3Quc292Y2xvdWQuc292ZXJlaWduLmNvLm56Iiwib3JhY2xlLm9hdXRoLnN2Y19wX24iOiJBUElTZXJ2aWNlUHJvZmlsZSIsImlhdCI6MTUyNTk5MDkxNCwib3JhY2xlLm9hdXRoLnBybi5pZF90eXBlIjoiQ2xpZW50SUQiLCJleHAiOjE1MjU5OTQ1MTQsIm9yYWNsZS5vYXV0aC50a19jb250ZXh0IjoicmVzb3VyY2VfYWNjZXNzX3RrIiwicHJuIjoiZDM4ZTQxOGNmOTBlNDEwY2E0NDQ4YTZkMWE2NTA3MTAiLCJqdGkiOiJiOTllOGJiMi01YTNjLTQ0ZjgtOTg0ZC00YTNmODQ1OWIwZWEiLCJvcmFjbGUub2F1dGguY2xpZW50X29yaWdpbl9pZCI6ImQzOGU0MThjZjkwZTQxMGNhNDQ0OGE2ZDFhNjUwNzEwIiwib3JhY2xlLm9hdXRoLnNjb3BlIjoiU09WLkFkdmlzZXIuVmFsaWRhdGVFbWFpbCIsInVzZXIudGVuYW50Lm5hbWUiOiJBUEkiLCJvcmFjbGUub2F1dGguaWRfZF9pZCI6IjUzYTIwNTVjLTc3ZjAtNDVjZS05MTQyLWU4ZGQ5ZmM1NjkwYyJ9.N8Jvp2Rvad9WWGMNvlbIHEDAT57IfD799V_raspJ6WLxoFyiYk0g-hmthxyx3mjb5swSJJuu1YW_p7yNaUbr_zz9Y3h-x5nFyKYCqU2XW02QYKYEi3FSVHJtW8Wu0fSPKvSnH09RUjjDhiqyQzzMWVob7DFjyNfTHWNxV3vPMD4</con:accessToken>
      <con:accessTokenPosition>HEADER</con:accessTokenPosition>
      <con:accessTokenStartingStatus>ENTERED_MANUALLY</con:accessTokenStartingStatus>
      <con:manualAccessTokenExpirationTime/>
      <con:manualAccessTokenExpirationTimeUnit>SECONDS</con:manualAccessTokenExpirationTimeUnit>
      <con:clientID/>
      <con:clientSecret/>
      <con:oAuth2Flow>CLIENT_CREDENTIALS_GRANT</con:oAuth2Flow>
      <con:refreshAccessTokenMethod>AUTOMATIC</con:refreshAccessTokenMethod>
      <con:scope>SOV.Adviser.ValidateEmail</con:scope>
      <con:useAuthHeader>false</con:useAuthHeader>
      <con:jwtConfiguration/>
      <con:responseType>id_token</con:responseType>
    </con:oAuth20AuthEntry>
  </con:authRepository>
  <con:environmentSpec>
    <con:entry environmentId="d4a54d65-40f8-45fb-9f19-5e967e5d33f4">
      <con:authProfile>No Authorization</con:authProfile>
    </con:entry>
  </con:environmentSpec>
  <con:tags/>
</con:soapui-project>
